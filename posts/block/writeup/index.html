<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <title>Block | THM Writeup :: CyberJagadeesh - Learn Cyber Security</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Introduction Detailed walkthroughs for Block CTF challenges on TryHackMe .
Description One of your junior system administrators forgot to deactivate two accounts from a pair of recently fired employees. We believe these employees used the credentials they were given in order to access some of the many private files from our server, but we need concrete proof. The junior system administrator only has a small network capture of the incident and a memory dump of the Local Security Authority Subsystem Service process. Fortunately, for your company, that is all you need.
"
/>
<meta
  name="keywords"
  content="cyber security, penetration testing, ethical hacking, vulnerability assessment, network security, application security, web application security, security testing, red teaming, bug bounty, CTFs, cybersecurity challenges, hacking tutorials, security tools, exploit development, reverse engineering, penetration tester, security researcher, security analyst, information security, digital forensics, incident response, threat intelligence, security awareness, social engineering, phishing, malware analysis, cryptography, cloud security, IoT security, mobile security, how to become a penetration tester, penetration testing tools, CTF challenges for beginners, web application penetration testing, network penetration testing, exploit development tutorial, reverse engineering techniques, bug bounty hunting tips, security research projects, cyber security certifications"
/>
<meta name="robots" content="noodp" /><link rel="manifest" href="/manifest.json" /><meta property="og:url" content="https://cyberjagadeesh.github.io/posts/block/writeup/">
  <meta property="og:site_name" content="CyberJagadeesh">
  <meta property="og:title" content="Block | THM Writeup">
  <meta property="og:description" content="Introduction Detailed walkthroughs for Block CTF challenges on TryHackMe .
Description One of your junior system administrators forgot to deactivate two accounts from a pair of recently fired employees. We believe these employees used the credentials they were given in order to access some of the many private files from our server, but we need concrete proof. The junior system administrator only has a small network capture of the incident and a memory dump of the Local Security Authority Subsystem Service process. Fortunately, for your company, that is all you need.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-09T22:44:52+05:30">
    <meta property="article:modified_time" content="2024-10-09T22:44:52+05:30">
    <meta property="article:tag" content="Lssas.DMP">
    <meta property="article:tag" content="Pypykatz">
    <meta property="article:tag" content="John">
    <meta property="article:tag" content="SmbDecryption">
    <meta property="article:tag" content="Wireshark">
    <meta property="article:tag" content="Mimikatz">
      <meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/thm/backtrack/writeup/">
      <meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/pyrat/writeup/">
      <meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/thelondonbridge/writeup/">
      <meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/cheesectf/writeup/">
      <meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/breakme/writeup/">
      <meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/certaindoom/writeup/">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Block | THM Writeup">
  <meta name="twitter:description" content="Introduction Detailed walkthroughs for Block CTF challenges on TryHackMe .
Description One of your junior system administrators forgot to deactivate two accounts from a pair of recently fired employees. We believe these employees used the credentials they were given in order to access some of the many private files from our server, but we need concrete proof. The junior system administrator only has a small network capture of the incident and a memory dump of the Local Security Authority Subsystem Service process. Fortunately, for your company, that is all you need.">


<link rel="canonical" href="https://cyberjagadeesh.github.io/posts/block/writeup/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.min.1f9b3e6594d41770030cc9cea67e9220cd9066bb33910ebfb19ea46cf6b4b50c.css">





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-376DY6PW0W"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-376DY6PW0W');
        }
      </script>




  
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"CyberJagadeesh"},"dateModified":"2024-10-09T22:44:52+05:30","datePublished":"2024-10-09T22:44:52+05:30","description":"Introduction Detailed walkthroughs for Block CTF challenges on TryHackMe .\nDescription One of your junior system administrators forgot to deactivate two accounts from a pair of recently fired employees. We believe these employees used the credentials they were given in order to access some of the many private files from our server, but we need concrete proof. The junior system administrator only has a small network capture of the incident and a memory dump of the Local Security Authority Subsystem Service process. Fortunately, for your company, that is all you need.\n","image":"/posts/block/block.png","name":"Block | THM Writeup","url":"https://cyberjagadeesh.github.io/posts/block/writeup/"}
</script>

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800"><header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="/logo.png" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600"
            href="/posts/" title="Post">Post</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/posts/block/writeup/">
        <figure>
    <img class="w-full object-cover h-36 md:h-48 xl:h-60" src="/posts/block/block.png"
      alt="Block | THM Writeup" title="Block | THM Writeup"
      loading="lazy"
    >
  </figure>
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/posts/block/writeup/">Block | THM Writeup</a>
      </h1>

      
      
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/ctf/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          CTF
        </a>
      </li>
      
      <li>
        <a href="/categories/forensic/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          Forensic
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/lssas.dmp/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Lssas.DMP</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/pypykatz/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Pypykatz</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/john/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">John</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/smbdecryption/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">SmbDecryption</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/wireshark/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Wireshark</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/mimikatz/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Mimikatz</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/endianess/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Endianess</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/pyscript/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Pyscript</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/series/tryhackme/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Tryhackme</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/platforms/windows/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Windows</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/levels/medium/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Medium</span>
        </a>
      </li>
      
    
    
  </ul>



      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2024-10-09T22:44:52&#43;05:30">
      2024-10-09
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      8 minutes to read
    </span>
  </div>
</div>


      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#description">Description</a></li>
        <li><a href="#tools-used">Tools used</a></li>
      </ul>
    </li>
    <li><a href="#evidence">Evidence</a>
      <ul>
        <li><a href="#pcapng">.pcapng</a></li>
        <li><a href="#lsassdmp">lsass.DMP</a></li>
        <li><a href="#pypykatz">pypykatz</a></li>
        <li><a href="#johntheripper">JohnTheRipper</a></li>
      </ul>
    </li>
    <li><a href="#smb-decryption">SMB Decryption</a>
      <ul>
        <li><a href="#generating-random-session-key">Generating random Session key</a></li>
        <li><a href="#endian">Endian</a></li>
      </ul>
    </li>
    <li><a href="#alternatives">Alternatives</a>
      <ul>
        <li><a href="#using-mimikatz">Using mimikatz</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <h2 id="introduction">Introduction</h2>
<p>Detailed walkthroughs for <a href="https://tryhackme.com/r/room/blockroom" target="_blank" rel="noopener">Block</a>
 CTF challenges on <a href="https://tryhackme.com" target="_blank" rel="noopener">TryHackMe</a>
.</p>
<h3 id="description">Description</h3>
<p>One of your junior system administrators forgot to deactivate two accounts from a pair of recently fired employees.
We believe these employees used the credentials they were given in order to access some of the many private files from our server, but we need concrete proof.
The junior system administrator only has a small network capture of the incident and a memory dump of the Local Security Authority Subsystem Service process.
Fortunately, for your company, that is all you need.</p>
<h3 id="tools-used">Tools used</h3>
<p>Wireshark, pypykatz, mimikatz, john and pythonScript</p>
<h2 id="evidence">Evidence</h2>
<p>We got 2 files named <code>lsass.DMP and traffic.pcapng</code> when unzipping <code>evidence-1697996360986.zip</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ file *
</span></span><span class="line"><span class="cl">lsass.DMP:      Mini DuMP crash report, <span class="m">16</span> streams, Sun Oct <span class="m">22</span> 16:54:50 2023, 0x421826 <span class="nb">type</span>
</span></span><span class="line"><span class="cl">traffic.pcapng: pcapng capture file - version 1.0
</span></span></code></pre></div><p>Lets start with <code>.pcapng</code> file.</p>
<h3 id="pcapng">.pcapng</h3>
<p>



<figure>
    <img src="/posts/block/1.png" title="Protocal Hierarchy" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Protocal Hierarchy</strong>
    </figcaption>  
</figure>

We can see that <code>SMB2</code> packets were captured, which is interesting data.</p>
<p>



<figure>
    <img src="/posts/block/2.png" title="Conversations" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Conversations</strong>
    </figcaption>  
</figure>

The interesting IP&rsquo;s involved in conversations: <code>10.0.2.64, 10.0.2.70, 192.168.1.1</code>.</p>
<pre tabindex="0"><code>No  Time        Source      Destination  Protocal  Length  Info
11	0.003323	10.0.2.64	10.0.2.70	 SMB2	   674	   Session Setup Request, NTLMSSP_AUTH, User: WORKGROUP\mrealman
</code></pre><p>While looking into the .pcapng data using wireshark, we found first user connected to the system.</p>
<pre tabindex="0"><code>82	11.716089	10.0.2.64	10.0.2.70	SMB2	680	Session Setup Request, NTLMSSP_AUTH, User: WORKGROUP\eshellstrop
</code></pre><p>Further reviewing the packets we got the second user as well.</p>
<p>



<figure>
    <img src="/posts/block/7.png" title="Wireshark" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Wireshark</strong>
    </figcaption>  
</figure>

On further investigation we can see the that the see that the <code>SMB data</code> were <code>encrypted</code>. We need to decrypt to get useful information.</p>
<h3 id="lsassdmp">lsass.DMP</h3>
<p>Now lets move to analyze the dump file.</p>
<p>Learn about <code>LSASS</code>: <a href="https://b2dfir.blogspot.com/2021/04/lsassdmp-attacker-or-admin.html" target="_blank" rel="noopener">B2dfir</a>
</p>
<h3 id="pypykatz">pypykatz</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pypykatz lsa minidump evidence/lsass.DMP &gt; dump.txt
</span></span></code></pre></div><p>Used the above command to extract the credentials using <code>pypykatz</code> and saved it in the file <code>dump.txt</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pypykatz lsa minidump evidence/lsass.DMP -p msv
</span></span><span class="line"><span class="cl">INFO:pypykatz:Parsing file evidence/lsass.DMP
</span></span><span class="line"><span class="cl">FILE: <span class="o">========</span> evidence/lsass.DMP <span class="o">=======</span>
</span></span><span class="line"><span class="cl"><span class="o">==</span> <span class="nv">LogonSession</span> <span class="o">==</span>
</span></span><span class="line"><span class="cl">authentication_id <span class="m">1883004</span> <span class="o">(</span>1cbb7c<span class="o">)</span>
</span></span><span class="line"><span class="cl">session_id <span class="m">3</span>
</span></span><span class="line"><span class="cl">username mrealman
</span></span><span class="line"><span class="cl">domainname BLOCK
</span></span><span class="line"><span class="cl">logon_server WIN-2258HHCBNQR
</span></span><span class="line"><span class="cl">logon_time 2023-10-22T16:53:54.168637+00:00
</span></span><span class="line"><span class="cl">sid S-1-5-21-3761843758-2185005375-3584081457-1104
</span></span><span class="line"><span class="cl">luid <span class="nv">1883004</span>
</span></span><span class="line"><span class="cl">        <span class="o">==</span> <span class="nv">MSV</span> <span class="o">==</span>
</span></span><span class="line"><span class="cl">                Username: mrealman
</span></span><span class="line"><span class="cl">                Domain: BLOCK
</span></span><span class="line"><span class="cl">                LM: NA
</span></span><span class="line"><span class="cl">                NT: 1f9175a516211660c7a8143b0f36ab44
</span></span><span class="line"><span class="cl">                SHA1: ccd27b4bf489ffda2251897ef86fdb488f248aef
</span></span><span class="line"><span class="cl">                DPAPI: <span class="nv">3d618a1fffd6c879cd0b056910ec0c31</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">==</span> <span class="nv">LogonSession</span> <span class="o">==</span>
</span></span><span class="line"><span class="cl">authentication_id <span class="m">828825</span> <span class="o">(</span>ca599<span class="o">)</span>
</span></span><span class="line"><span class="cl">session_id <span class="m">2</span>
</span></span><span class="line"><span class="cl">username eshellstrop
</span></span><span class="line"><span class="cl">domainname BLOCK
</span></span><span class="line"><span class="cl">logon_server WIN-2258HHCBNQR
</span></span><span class="line"><span class="cl">logon_time 2023-10-22T16:46:09.215626+00:00
</span></span><span class="line"><span class="cl">sid S-1-5-21-3761843758-2185005375-3584081457-1103
</span></span><span class="line"><span class="cl">luid <span class="nv">828825</span>
</span></span><span class="line"><span class="cl">        <span class="o">==</span> <span class="nv">MSV</span> <span class="o">==</span>
</span></span><span class="line"><span class="cl">                Username: eshellstrop
</span></span><span class="line"><span class="cl">                Domain: BLOCK
</span></span><span class="line"><span class="cl">                LM: NA
</span></span><span class="line"><span class="cl">                NT: 3f29138a04aadc19214e9c04028bf381
</span></span><span class="line"><span class="cl">                SHA1: 91374e6e58d7b523376e3b1eb04ae5440e678717
</span></span><span class="line"><span class="cl">                DPAPI: 87c8e56bc4714d4c5659f254771559a8
</span></span></code></pre></div><p>The data above has been extracted using pypykatz, and I’ve included only the information that is relevant for our CTF lab. Here we have an interesting data that is <code>NT Hash</code>. Lets try to bruteforce the password using the hash string which we have.</p>
<h3 id="johntheripper">JohnTheRipper</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> 1f9175a516211660c7a8143b0f36ab44 &gt; hash.txt
</span></span><span class="line"><span class="cl">$ john hash.txt -format<span class="o">=</span>NT --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>NT <span class="o">[</span>MD4 256/256 AVX2 8x3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Warning: no OpenMP support <span class="k">for</span> this <span class="nb">hash</span> type, consider --fork<span class="o">=</span><span class="m">4</span>
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">Blockbuster1     <span class="o">(</span>?<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE <span class="o">(</span>2024-09-12 21:34<span class="o">)</span> 1.587g/s 18025Kp/s 18025Kc/s 18025KC/s Blondehair10..Blizzard56
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=NT&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed. 
</span></span></code></pre></div><p>We cracked the password of user1 using <code>john</code>.</p>
<p>But, not able to crack the passwords of user2 using NT hash [rockyou.txt used].</p>
<h2 id="smb-decryption">SMB Decryption</h2>
<p>



<figure>
    <img src="/posts/block/3.png" title="Decrypting SMB traffic" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Decrypting SMB traffic</strong>
    </figcaption>  
</figure>

Lets look into how can we decrypt the SMB traffic: <code>Edit &gt; Preference &gt; Protocols &gt; SMB2</code></p>
<h3 id="generating-random-session-key">Generating random Session key</h3>
<p>Got an interestion page <a href="https://medium.com/maverislabs/decrypting-smb3-traffic-with-just-a-pcap-absolutely-maybe-712ed23ff6a2" target="_blank" rel="noopener">Decrypting SMB3 Traffic with just a PCAP</a>
, and Wiki&rsquo;s <a href="https://wiki.wireshark.org/SampleCaptures#SMB3_encryption" target="_blank" rel="noopener">Wireshartk</a>
, <a href="https://wiki.samba.org/index.php/Wireshark_Decryption" target="_blank" rel="noopener">Samba</a>
, where we will get idea about the <code>SMB2 Encryption/Decryption</code> process.</p>
<p>We need the following data&rsquo;s to compute the session key for SMB:</p>
<ul>
<li>User’s password or NTLM hash</li>
<li>User’s domain</li>
<li>User’s username</li>
<li>NTProofStr</li>
<li>Key Exchange Key (Also known as the NTLMv2 Session Base Key)</li>
<li>Encrypted Session Key</li>
</ul>
<pre tabindex="0"><code>user= “test” 
domain= “workgroup”
password = “test”
NTProofStr = a0e42a75c54bbb0fab814593569faa22
EncryptedSessionKey = C914ADCEB0F1C32FB7C2548D8D959F01
hash = MD4(password.encode(‘utf16-le’))
# hash is 0cb6948805f797bf2a82807973b89537ResponseKeyNT(HMAC_MD5(hash, (user.toUpper()+domain.toUpper()).encode(‘utf16-le’)))
# ResponseKeyNT is f31eb9f73fc9d5405f9ae516fb068315 KeyExchangeKey=HMAC_MD5(ResponseKeyNT, NTProofStr)
# KeyExchangeKey is fd160d4ed7f2cb38f64262d7617f23b3RandomSessionKey = RC4(KeyExchangeKey,EncryptedSessionKey)
# RandomSessionKey is 4462b99bb21423c29dbb4b4a983fde03
</code></pre><p>We have the pseudocode to compute session key, using this we are going to create a python script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hmac</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">unhexlify</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">ARC4</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_response_key_nt</span><span class="p">(</span><span class="n">nt_hash</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">user_domain</span> <span class="o">=</span> <span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">domain</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-16le&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">nt_hash</span><span class="p">,</span> <span class="n">user_domain</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_key_exchange_key</span><span class="p">(</span><span class="n">response_key_nt</span><span class="p">,</span> <span class="n">nt_proof_str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">response_key_nt</span><span class="p">,</span> <span class="n">nt_proof_str</span><span class="p">,</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt_session_key</span><span class="p">(</span><span class="n">key_exchange_key</span><span class="p">,</span> <span class="n">encrypted_session_key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">rc4</span> <span class="o">=</span> <span class="n">ARC4</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key_exchange_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">rc4</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_session_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Usage for NT hash method: python script.py nt_hash username domain nt_hash_value NTProofStr EncryptedSessionKey&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Usage for password method: python script.py password username domain password_value NTProofStr EncryptedSessionKey&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">method</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">user</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">domain</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;nt_hash&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Usage: python script.py nt_hash username domain nt_hash_value NTProofStr EncryptedSessionKey&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">nt_hash</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">NTProofStr</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">EncryptedSessionKey</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error parsing hex values: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">response_key_nt</span> <span class="o">=</span> <span class="n">get_response_key_nt</span><span class="p">(</span><span class="n">nt_hash</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">domain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ResponseKeyNT: </span><span class="si">{</span><span class="n">response_key_nt</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">key_exchange_key</span> <span class="o">=</span> <span class="n">get_key_exchange_key</span><span class="p">(</span><span class="n">response_key_nt</span><span class="p">,</span> <span class="n">NTProofStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;KeyExchangeKey: </span><span class="si">{</span><span class="n">key_exchange_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">random_session_key</span> <span class="o">=</span> <span class="n">decrypt_session_key</span><span class="p">(</span><span class="n">key_exchange_key</span><span class="p">,</span> <span class="n">EncryptedSessionKey</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;RandomSessionKey: </span><span class="si">{</span><span class="n">random_session_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Usage: python script.py password username domain password_value NTProofStr EncryptedSessionKey&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">password</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">NTProofStr</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">EncryptedSessionKey</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error parsing hex values: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Step 1: MD4 hash of the password</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">md4_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;md4&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-16le&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error hashing password: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;MD4 Hash of Password: </span><span class="si">{</span><span class="n">md4_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Step 2: Calculate ResponseKeyNT using HMAC-MD5</span>
</span></span><span class="line"><span class="cl">        <span class="n">response_key_nt</span> <span class="o">=</span> <span class="n">get_response_key_nt</span><span class="p">(</span><span class="n">md4_hash</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">domain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ResponseKeyNT: </span><span class="si">{</span><span class="n">response_key_nt</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Step 3: Calculate KeyExchangeKey using HMAC-MD5</span>
</span></span><span class="line"><span class="cl">        <span class="n">key_exchange_key</span> <span class="o">=</span> <span class="n">get_key_exchange_key</span><span class="p">(</span><span class="n">response_key_nt</span><span class="p">,</span> <span class="n">NTProofStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;KeyExchangeKey: </span><span class="si">{</span><span class="n">key_exchange_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Step 4: Decrypt EncryptedSessionKey using RC4</span>
</span></span><span class="line"><span class="cl">        <span class="n">random_session_key</span> <span class="o">=</span> <span class="n">decrypt_session_key</span><span class="p">(</span><span class="n">key_exchange_key</span><span class="p">,</span> <span class="n">EncryptedSessionKey</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;RandomSessionKey: </span><span class="si">{</span><span class="n">random_session_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Invalid method. Use &#39;nt_hash&#39; or &#39;password&#39;.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><p>Lets save this as file <code>sessionKey.py</code>.</p>
<p>Lets gather the required data:</p>
<ol>
<li>username = <code>mrealman</code> (from pcap)</li>
<li>domain = <code>WORKGROUP</code> (from pcap)</li>
<li>password = <code>Blockbuster1</code> (Decrypted from NT hash which we got in lsass.dmp)</li>
<li>NTProofStr = <code>16e816dead16d4ca7d5d6dee4a015c14</code> (from pcap)</li>
<li>EncryptedSessionKey = <code>fde53b54cb676b9bbf0fb1fbef384698</code> (from pcap)
We have all required data, lets run the python script.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python sessionKey.py mrealman WORKGROUP Blockbuster1 16e816dead16d4ca7d5d6dee4a015c14 fde53b54cb676b9bbf0fb1fbef384698
</span></span><span class="line"><span class="cl">MD4 Hash of Password: 1f9175a516211660c7a8143b0f36ab44                                                                                                       
</span></span><span class="line"><span class="cl">ResponseKeyNT: 110fd571fec8b2d44728e3d4d6f32f0a                                                                                                              
</span></span><span class="line"><span class="cl">KeyExchangeKey: 17e09b2c9b92045329a4382898f50159                                                                                                             
</span></span><span class="line"><span class="cl">RandomSessionKey: 20a642c086ef74eee26277bf1d0cff8c
</span></span></code></pre></div><p>We got the results.</p>
<p>We also have session id <code>0x0000100000000041</code> (from pcap).</p>
<p>But, SMB2 data is not decrypted when using this session id and key combination, problem with session id.</p>
<h3 id="endian">Endian</h3>




<figure>
    <img src="/posts/block/9.png" title="Endianness" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Endianness</strong>
    </figcaption>  
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get session ID from command line argument (as a hex string)                                                                                                </span>
</span></span><span class="line"><span class="cl"><span class="n">session_id_str</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                               
</span></span><span class="line"><span class="cl"><span class="c1"># Convert hex string to an integer                                                                                                                           </span>
</span></span><span class="line"><span class="cl"><span class="n">session_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">session_id_str</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ensure it&#39;s padded to 8 bytes</span>
</span></span><span class="line"><span class="cl"><span class="n">num_bytes</span> <span class="o">=</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Convert the integer to bytes (big-endian), padding it to 8 bytes</span>
</span></span><span class="line"><span class="cl"><span class="n">original_bytes</span> <span class="o">=</span> <span class="n">session_id</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">num_bytes</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Original Bytes (big-endian): </span><span class="si">{</span><span class="n">original_bytes</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Reverse the bytes</span>
</span></span><span class="line"><span class="cl"><span class="n">reversed_bytes</span> <span class="o">=</span> <span class="n">original_bytes</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Reversed Bytes: </span><span class="si">{</span><span class="n">reversed_bytes</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Convert back to integer from reversed bytes (little-endian)</span>
</span></span><span class="line"><span class="cl"><span class="n">reversed_session_id</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">reversed_bytes</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Print original and reversed hex values, ensuring it&#39;s always 8 bytes (16 hex digits)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Original: 0x</span><span class="si">{</span><span class="n">session_id</span><span class="si">:</span><span class="s2">016x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># Pad original with zeros to ensure 16 hex digits (8 bytes)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Reversed: 0x</span><span class="si">{</span><span class="n">reversed_session_id</span><span class="si">:</span><span class="s2">016x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># Ensure reversed is also 8 bytes in the output</span>
</span></span></code></pre></div><p>Used this script to reverse the <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener">endian</a>
.</p>
<p>The reversed session id of <code>0x0000100000000041</code> is <code>4100000000100000</code>.</p>
<p>By using this reversed session id we are sucessfully able to decrypt the smb traffic.</p>
<p>



<figure>
    <img src="/posts/block/6.png" title="Export:SMB object" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Export:SMB object</strong>
    </figcaption>  
</figure>

After decrypting the SMB traffic we are sucessfully able to see a file <code>clients156.csv</code> in Export:SMB objects.Lets export that file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat clients156.csv
</span></span><span class="line"><span class="cl">first_name,last_name,password
</span></span><span class="line"><span class="cl">Jewell,Caseri,eS8/y*t?8$
</span></span><span class="line"><span class="cl">Abey,Sigward,yB0<span class="o">{</span>g_&gt;KezO
</span></span><span class="line"><span class="cl">Natassia,Freeth,tS2&lt;1Fef9tiF
</span></span><span class="line"><span class="cl">Verina,Wainscoat,kT8/2uEMH
</span></span><span class="line"><span class="cl">Filia,Sommerling,oE9.2c?Sce
</span></span><span class="line"><span class="cl">Farris,Busst,THM<span class="o">{</span>REDACTED<span class="o">}</span>
</span></span><span class="line"><span class="cl">Bat,Oakes,gE0%f@<span class="s1">&#39;qw}s%
</span></span></span><span class="line"><span class="cl"><span class="s1">Verina,Jedrachowicz,wK4~4L\O
</span></span></span><span class="line"><span class="cl"><span class="s1">Caril,Wolfarth,yQ3$Ji0~f7aB&gt;F{
</span></span></span><span class="line"><span class="cl"><span class="s1">Bordie,Baume,iM1}&#34;x)yP&#39;</span><span class="sb">`</span>2<span class="p">|</span>S
</span></span><span class="line"><span class="cl">,,
</span></span></code></pre></div><!-- THM{SmB_DeCrypTing_who_Could_Have_Th0ughT} -->
<p>Got flag 3 here.</p>
<p>Lets try to decrypt the smb traffic of 2nd user.
Lets gather the required data:</p>
<ol>
<li>username = <code>eshellstrop</code> (from pcap)</li>
<li>domain = <code>WORKGROUP</code> (from pcap)</li>
<li>password/NT hash = <code>3f29138a04aadc19214e9c04028bf381</code> (Decrypted from NT hash which we got in lsass.dmp)</li>
<li>NTProofStr = <code>0ca6227a4f00b9654a48908c4801a0ac</code> (from pcap)</li>
<li>EncryptedSessionKey = <code>c24f5102a22d286336aac2dfa4dc2e04</code> (from pcap)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python new.py nt_hash eshellstrop WORKGROUP 3f29138a04aadc19214e9c04028bf381 0ca6227a4f00b9654a48908c4801a0ac c24f5102a22d286336aac2dfa4dc2e04
</span></span><span class="line"><span class="cl">ResponseKeyNT: f48087e449d58b400e283a27914209b9
</span></span><span class="line"><span class="cl">KeyExchangeKey: 9754d7acae384644b196c05cda5315df
</span></span><span class="line"><span class="cl">RandomSessionKey: facfbdf010d00aa2574c7c41201099e8
</span></span></code></pre></div><p>And the reversed session id of <code>0x0000100000000045</code> is <code>4500000000100000</code>.</p>
<p>



<figure>
    <img src="/posts/block/8.png" title="Export:SMB object" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Export:SMB object</strong>
    </figcaption>  
</figure>

After decrypting the SMB traffic we are sucessfully able to see a file <code>clients978.csv</code> in Export:SMB objects.Lets export that file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat clients978.csv 
</span></span><span class="line"><span class="cl">first_name,last_name,password
</span></span><span class="line"><span class="cl">Fran,McCane,vP5<span class="o">{</span><span class="p">|</span>r<span class="nv">$IYDDu</span>
</span></span><span class="line"><span class="cl">Fredrika,Delea,qU2!<span class="p">&amp;</span>Bev
</span></span><span class="line"><span class="cl">Josefa,Keir,hX0<span class="o">)</span>gq54I<span class="s2">&#34;%d
</span></span></span><span class="line"><span class="cl"><span class="s2">Joannes,Greatham,vS1)N,z1X1rc
</span></span></span><span class="line"><span class="cl"><span class="s2">Courtenay,Keble,lV6|0aiSZL@@`bbM
</span></span></span><span class="line"><span class="cl"><span class="s2">Tonye,Risebrow,THM{REDACTED}
</span></span></span><span class="line"><span class="cl"><span class="s2">Joleen,Balog,tK9&#39;ZapdU.&#39;igGs
</span></span></span><span class="line"><span class="cl"><span class="s2">Clementia,Kilsby,uC6!Bx}`Xe
</span></span></span><span class="line"><span class="cl"><span class="s2">Mason,Woolvett,eL0</span><span class="nv">$NO</span><span class="s2">)FRY1IT
</span></span></span><span class="line"><span class="cl"><span class="s2">Rozele,Izachik,wA8&gt;11</span>$<span class="s2">,&#39;0,b+
</span></span></span><span class="line"><span class="cl"><span class="s2">,,
</span></span></span></code></pre></div><p>We got final flag here.</p>
<!-- THM{No_PasSw0Rd?_No_Pr0bl3m} -->
<h2 id="alternatives">Alternatives</h2>
<h3 id="using-mimikatz">Using mimikatz</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  .#####.   mimikatz 2.2.0 <span class="o">(</span>x64<span class="o">)</span> <span class="c1">#19041 Sep 19 2022 17:44:08</span>
</span></span><span class="line"><span class="cl"> .## ^ <span class="c1">##.  &#34;A La Vie, A L&#39;Amour&#34; - (oe.eo)</span>
</span></span><span class="line"><span class="cl"> <span class="c1">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>
</span></span><span class="line"><span class="cl"> <span class="c1">## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;## v ##&#39;</span>       Vincent LE TOUX             <span class="o">(</span> vincent.letoux@gmail.com <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;#####&#39;</span>        &gt; https://pingcastle.com / https://mysmartlogon.com ***/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mimikatz <span class="c1"># sekurlsa::minidump Z:\evidence\lsass.DMP</span>
</span></span><span class="line"><span class="cl">Switch to MINIDUMP : <span class="s1">&#39;Z:\evidence\lsass.DMP&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mimikatz <span class="c1"># sekurlsa::logonPasswords full</span>
</span></span><span class="line"><span class="cl">Opening : <span class="s1">&#39;Z:\evidence\lsass.DMP&#39;</span> file <span class="k">for</span> minidump...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Authentication Id : <span class="m">0</span> <span class="p">;</span> <span class="m">1883004</span> <span class="o">(</span>00000000:001cbb7c<span class="o">)</span>
</span></span><span class="line"><span class="cl">Session           : Interactive from <span class="m">3</span>
</span></span><span class="line"><span class="cl">User Name         : mrealman
</span></span><span class="line"><span class="cl">Domain            : BLOCK
</span></span><span class="line"><span class="cl">Logon Server      : WIN-2258HHCBNQR
</span></span><span class="line"><span class="cl">Logon Time        : 22-10-2023 09:53:54
</span></span><span class="line"><span class="cl">SID               : S-1-5-21-3761843758-2185005375-3584081457-1104
</span></span><span class="line"><span class="cl">        msv :
</span></span><span class="line"><span class="cl">         <span class="o">[</span>00000003<span class="o">]</span> Primary
</span></span><span class="line"><span class="cl">         * Username : mrealman
</span></span><span class="line"><span class="cl">         * Domain   : BLOCK
</span></span><span class="line"><span class="cl">         * NTLM     : 1f9175a516211660c7a8143b0f36ab44
</span></span><span class="line"><span class="cl">         * SHA1     : ccd27b4bf489ffda2251897ef86fdb488f248aef
</span></span><span class="line"><span class="cl">         * DPAPI    : 3d618a1fffd6c879cd0b056910ec0c31
</span></span><span class="line"><span class="cl">        tspkg :
</span></span><span class="line"><span class="cl">        wdigest :
</span></span><span class="line"><span class="cl">         * Username : mrealman
</span></span><span class="line"><span class="cl">         * Domain   : BLOCK
</span></span><span class="line"><span class="cl">         * Password : <span class="o">(</span>null<span class="o">)</span>
</span></span><span class="line"><span class="cl">        kerberos :
</span></span><span class="line"><span class="cl">         * Username : mrealman
</span></span><span class="line"><span class="cl">         * Domain   : BLOCK.THM
</span></span><span class="line"><span class="cl">         * Password : <span class="o">(</span>null<span class="o">)</span>
</span></span><span class="line"><span class="cl">        ssp :
</span></span><span class="line"><span class="cl">        credman :
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Authentication Id : <span class="m">0</span> <span class="p">;</span> <span class="m">828825</span> <span class="o">(</span>00000000:000ca599<span class="o">)</span>
</span></span><span class="line"><span class="cl">Session           : Interactive from <span class="m">2</span>
</span></span><span class="line"><span class="cl">User Name         : eshellstrop
</span></span><span class="line"><span class="cl">Domain            : BLOCK
</span></span><span class="line"><span class="cl">Logon Server      : WIN-2258HHCBNQR
</span></span><span class="line"><span class="cl">Logon Time        : 22-10-2023 09:46:09
</span></span><span class="line"><span class="cl">SID               : S-1-5-21-3761843758-2185005375-3584081457-1103
</span></span><span class="line"><span class="cl">        msv :
</span></span><span class="line"><span class="cl">         <span class="o">[</span>00000003<span class="o">]</span> Primary
</span></span><span class="line"><span class="cl">         * Username : eshellstrop
</span></span><span class="line"><span class="cl">         * Domain   : BLOCK
</span></span><span class="line"><span class="cl">         * NTLM     : 3f29138a04aadc19214e9c04028bf381
</span></span><span class="line"><span class="cl">         * SHA1     : 91374e6e58d7b523376e3b1eb04ae5440e678717
</span></span><span class="line"><span class="cl">         * DPAPI    : 87c8e56bc4714d4c5659f254771559a8
</span></span><span class="line"><span class="cl">        tspkg :
</span></span><span class="line"><span class="cl">        wdigest :
</span></span><span class="line"><span class="cl">         * Username : eshellstrop
</span></span><span class="line"><span class="cl">         * Domain   : BLOCK
</span></span><span class="line"><span class="cl">         * Password : <span class="o">(</span>null<span class="o">)</span>
</span></span><span class="line"><span class="cl">        kerberos :
</span></span><span class="line"><span class="cl">         * Username : eshellstrop
</span></span><span class="line"><span class="cl">         * Domain   : BLOCK.THM
</span></span><span class="line"><span class="cl">         * Password : <span class="o">(</span>null<span class="o">)</span>
</span></span><span class="line"><span class="cl">        ssp :
</span></span><span class="line"><span class="cl">        credman :
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mimikatz <span class="c1">#</span>
</span></span></code></pre></div><p>Here we have used <code>miikatz</code> to extract data from DMP file.</p>
<p>We solved the lab.</p>
<p>Happy Hacking !!! &#x1f60e;</p>

      </article>

      
      


  
<script type="text/javascript">
  (function() {
    const themeToggle = document.querySelector('.darkmode-toggle input');
    const light = 'light';
    const dark = 'dark';
    let isDark = localStorage.theme === dark || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
    let theme = isDark ? dark : light;

    const s = document.createElement('script');
    s.type = 'text/javascript';
    const dataset = {
        repo: 'cyberjagadeesh\/cyberjagadeesh.github.io',
        repoId: 'R_kgDOMfA4MA',
        category: 'General',
        categoryId: 'DIC_kwDOMfA4MM4ChYzn',
        mapping: 'url',
        reactionsEnabled: '1',
        emitMetadata: '0',
        theme: theme,
        lang: 'en',
    };
    s.src = 'https://giscus.app/client.js';
    s.crossorigin = 'anonymous';
    s.async = true;
    Object.entries(dataset).forEach(function(a) {
        return s.dataset[a[0]] = a[1];
    });

    const curScriptElement = document.currentScript;
    curScriptElement.parentNode.insertBefore(s, curScriptElement);

    function sendMessage(message) {
      const iframe = document.querySelector('iframe.giscus-frame');
      
      if (!iframe) return;
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
    }

    themeToggle.addEventListener('change', function () {
      if (this.checked) {
        theme = dark;
      } else {
        theme = light;
      }
      sendMessage({
        setConfig: {
          theme: theme,
        }
      });
    });
  })();
</script>
  


      

    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
  
  
  
  
    <a href="https://www.linkedin.com/in/jagadeeshwaran-m-27598134b" target="_blank" title="LinkedIn" class="flex flex-row mr-2">
      <span class="hidden">LinkedIn</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
    <a href="https://www.linkedin.com/in/jagadeeshwaran-m-562a011b3" target="_blank" title="LinkedIn" class="flex flex-row mr-2">
      <span class="hidden">LinkedIn</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2024 - 2025 CyberJagadeesh
    
  </div>
  
</section>

  </footer>
  <script src="/main.min.c6372b6836971865bd94bfde974748aca8415824a2facab6ccd66a87384bfacb.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.min.e7b2a74adef1ed474c335c8bd5e7832b2316b8842b0f9184d65286c5bd64f51a.js"></script>





</body>
</html>
